"use strict";var cvjq,VAMD=function(){var self={};function url_filter(){for(var filter=["https://www.hsbc.co.uk/credit-cards/balance-transfer-credit-cards/","https://www.hsbc.co.uk/loans/products/","https://www.hsbc.co.uk/credit-cards/credit-builder-credit-cards/","https://www.hsbc.co.uk/credit-cards/purchase-credit-cards/","https://www.hsbc.co.uk/credit-cards/products/classic/","https://www.hsbc.co.uk/credit-cards/compare/","https://www.hsbc.co.uk/credit-cards/","https://www.hsbc.co.uk/loans/products/debt-consolidation/","https://www.hsbc.co.uk/loans/products/home-improvements/","https://www.hsbc.co.uk/credit-cards/how-to-get-a-credit-card/","https://www.hsbc.co.uk/credit-cards/products/","https://www.hsbc.co.uk/loans/products/personal/","https://www.hsbc.co.uk/credit-cards/products/premier/","https://www.hsbc.co.uk/loans/products/premier/","https://www.hsbc.co.uk/credit-cards/products/purchase-card/","https://www.hsbc.co.uk/credit-cards/products/rewards/","https://www.hsbc.co.uk/credit-cards/products/student/","https://www.hsbc.co.uk/loans/products/top-up-loans/","https://german4.creativevirtual.com/hsbcpws_update_stage/testfilter.htm","https://www.security.hsbc.co.uk/gsa?idv_cmd=idv.SaaSSecurityCommand","https://www.hsbc.co.uk/ways-to-bank/online-banking/","https://www.hsbc.co.uk/current-accounts/","https://www.hsbc.co.uk/ways-to-bank/mobile/","https://www.appointmentbooking.hsbc.co.uk/group-appointmentbooking-ui-angular-web/","https://www.hsbc.co.uk/branch-finder/","https://www.hsbc.co.uk/help/","https://www.hsbc.co.uk/international/overseas-account-opening/","https://www.hsbc.co.uk/help/security-centre/secure-key-troubleshooting/#PhysicalSecureKeyhelp","https://www.hsbc.co.uk/mortgages/","https://www.hsbc.co.uk/ways-to-bank/phone-banking/","https://www.hsbc.co.uk/1/2/contact-and-support/security-centre/jumio","https://www.hsbc.co.uk/insurance/products/travel/","https://www.hsbc.co.uk/help/#contactus","https://www.hsbc.co.uk/help/banking-made-easy/making-payments/","https://www.hsbc.co.uk/help/banking-made-easy/help-us-identify-you/","https://www.hsbc.co.uk/","https://www.hsbc.co.uk/guides/managing-money/understanding-your-balance/","https://www.hsbc.co.uk/register/","https://www.hsbc.co.uk/help/banking-made-easy/update-your-details/change-address/","https://www.hsbc.co.uk/ways-to-bank/mobile/cheque-deposit/","https://www.hsbc.co.uk/help/card-support/activating-your-card/","https://www.hsbc.co.uk/help/banking-made-easy/how-to-set-up-standing-order/","https://www.hsbc.co.uk/current-accounts/products/student/","https://www.hsbc.co.uk/help/banking-made-easy/update-your-details/change-name/","https://www.hsbc.co.uk/help/banking-made-easy/closing-an-account/","https://www.hsbc.co.uk/mortgages/existing-customers/","https://www.hsbc.co.uk/help/banking-made-easy/inactive-accounts/","https://www.hsbc.co.uk/credit-cards/","https://www.hsbc.co.uk/help/feedback-and-complaints/","https://www.hsbc.co.uk/help/life-events/bereavement/","https://www.hsbc.co.uk/help/security-centre/secure-key/","https://www.hsbc.co.uk/help/security-centre/","https://www.hsbc.co.uk/help/card-support/dispute-transaction/","https://www.hsbc.co.uk/mortgages/existing-customers/faqs/","https://www.hsbc.co.uk/ways-to-bank/mobile/apple-pay/","https://www.hsbc.co.uk/contact/","https://www.hsbc.co.uk/financial-fitness/everyday-budgeting/understanding-your-balance/#","https://www.hsbc.co.uk/financial-fitness/everyday-budgeting/understanding-your-balance/","https://www.hsbc.co.uk/help/security-centre/verification/","https://www.hsbc.co.uk/ways-to-bank/mobile/samsung-pay/","https://www.hsbc.co.uk/ways-to-bank/mobile/google-pay/","https://www.hsbc.co.uk/help/banking-made-easy/online-statements/","https://www.hsbc.co.uk/help/banking-made-easy/how-to-set-up-a-direct-debit/","https://www.hsbc.co.uk/international/money-transfer/"],foundfilter=!1,i=0;i<filter.length;i++)if((window.location.origin+window.location.pathname).replace(/\/$/,"")==filter[i].replace(/\/$/,"")){foundfilter=!0;break}return foundfilter}self.conf={projectName:"HSBC PWS",template:'<div class="va-trigger-pod"><div class="va-trigger" role="button" aria-label="Need help button" tabindex="0"><p class="va-title-opened">Need help?</p><p class="va-title-closed">Close</p></div></div><div class="va-wrap"><div class="va-header-wrap"><div class="va-header clearfix"><h1>Need help?</h1><div class="va-menu"><div class="va-menu-nav" role="button" tabindex="0" aria-label="Toggle the menu"> <span></span> <span></span> <span></span> <span></span></div><div class="va-menu-content"><ul><li> <a href="" class="va-menu-print" aria-label="Print your conversation" title="Print conversation">Print conversation</a></li><li> Font size <a href="" title="Decrease font size" aria-label="Decrease font size" class="va-menu-icon-up va-menu-icon"><span>-</span></a> <a href="" title="Increase font size" aria-label="Increase font size" class="va-menu-icon-down va-menu-icon"><span>+</span></a></li></ul></div></div> <a href="" role="button" arial-label="Close" title="Close" class="va-close">Close</a></div></div><div class="va-banner-wrap"><div class="va-banner"></div> <a href="" class="va-banner-close" role="button" aria-label="Click here to close the banner">Close the survey</a></div><div class="va-body-wrap"><div class="va-body"><div class="va-content" role="log" aria-atomic="false" tabindex="-1" aria-live="polite"></div><div class="va-loading" style="display: none;"><div class="va-cssload-square"><div class="va-cssload-square-part va-cssload-square-color1"></div><div class="va-cssload-square-part va-cssload-square-color2"></div><div class="va-cssload-square-blend"></div></div></div></div><div class="va-inp"><div class="va-inp-in"><div class="va-txt-pod"> <label for="va-input" class="va-visually-hidden">Type your question here</label> <input type="text" placeholder="Type your question here" class="va-inp-txt" id="va-input" name="va-input" tabindex="0" autocomplete="off" aria-describedby="va-auto-desc" aria-owns="va-autocomplete-results" aria-expanded="false" aria-autocomplete="both" aria-activedescendant=""><div id="va-auto-desc" class="va-visually-hidden">When autocomplete results are available use up and down arrows to review and enter to select. Touch device users, explore by touch.</div></div><div class="va-btn-pod"> <button type="submit" name="send" class="va-inp-btn" tabindex="0">Ask</button></div></div><div class="va-autocomplete"></div></div><div class="va-lc-banner"></div><div class="va-lc-wrap"> <a href="" role="button" class="va-lc-button btn-success" onclick="LivePersonVirtualAssistantModule.startChat(va.messages);return false;" tabindex="0" aria-label="Start a chat">Start a chat</a> <a href="" role="button" class="va-lc-button btn-warning" tabindex="0" aria-label="Agents are Busy - try again">Agents are Busy - try again</a> <a href="" role="button" class="va-lc-button btn-danger" tabindex="0" aria-label="Agents are offline">Agents are offline</a></div><div id="button-container" style="display:none;"><div id="lpButtonDiv-need-help-panel"></div> <a id="lp-va-panel-button-online" href="#" class="btn btn-success lp-va-panel-button hide-lp-button" onclick="LivePersonVirtualAssistantModule.escalateToChat();">Click to chat</a> <a id="lp-va-panel-button-offline" href="#" class="btn btn-warning lp-va-panel-button hide-lp-button">All Agents are OFFLINE/BUSY</a></div><div class="va-related" aria-live="polite"> <button class="va-related-head va-toggle" arial-label="View related questions and categories" tabindex="0">Related Questions</button><div class="va-related-pod"><h3 class="va-subheading">Frequently asked questions</h3><div class="va-related-nav"><div class="va-dropdown"></div><div class="va-breadcrumbs clearfix"></div></div><div class="va-faqs" role="status"></div></div></div></div> <iframe tabindex="-1" id="va-print-page" class="va-visually-hidden" name="va-print-page" src="about:blank"></iframe></div>',resourceURI:"//www.askus.hsbc.co.uk/counter-service/embedp2new",scripts:["jquery-3.3.1.min.js","main.min.css","LivePersonVirtualAssistantModule.min.js","main.min.js"],vaurl:"//www.askus.hsbc.co.uk/counter-service1/bot.htm?api=1&type=json",peUrl:"http://192.168.40.10/PersonalisationEngine",loadJQ:!0,candidateCollectionCompute:!1,component:{autocomplete:!0,livechat:!1,sso:!1},autocompleteURI:"//www.askus.hsbc.co.uk/counter-service1/bot.htm?JSIN=1",debug:!1,production:!0,version:"2.0.0",history:!0,autonav:!1,superplaceholder:{enable:!1,default_sentences:["Enter your quetion here..."],instance_sentences:[],include_FAQ:!0,instance:!1},va:{businessArea:"Root.PWS",Channel:"",startContext:""},mobChannel:{enable:!1,name:"Root.Mobile"},templateType:{type:"slideout",position:"",popup:!1},threshold:699,convScroll:!0,loading:{auto:!0,autoshow:!1},globalConfig:!1,state:{typing:!1,active:!1,loaded:!1,ls:1,mode:1,enabled:!0,auth:!1,ident:"",fontSize:16,idleTimer:"",lcinit:!1,lcactive:!1,banner:!0,topicBanner:!1},clientConfig:"window.cv_config",showLCButton:!1,availChecks:{startAvailChecks:"once",changeButtonVisibility:!1,showAvailableAgents:!0,availChecks_queueId:1,check_interval:2e3,check_exponent:1.2},triggerText:{va:"Need help?",lc:"Livechat"},msg:{},banner:{msg1:'If you&apos;d like to chat with us, please <a href="https://www.hsbc.co.uk/online/dashboard/" target="_self" title="Log on to Online Banking">log on to Online Banking</a>. For general enquiries, we recommend checking our FAQs and <a href="https://www.hsbc.co.uk/help/" target="_self" title="Contact and Support">Help</a> section first.',msg2:'If you&apos;ve got a question about [topic], hit &apos;Start a chat&apos; to talk to a specialist now. If you can&apos;t see the chat button below, it means our specialists aren&apos;t available at the moment - here are some other ways to <a href="https://www.hsbc.co.uk/contact/" target="_self" title="Contact Us">contact us</a>.',msg3:'If you&apos;d like to chat with us, <a href="https://www.hsbc.co.uk/ways-to-bank/mobile/" target="_self" title="Mobile banking">log on to Mobile Banking</a>, or, better yet, start a chat in the app. You can also find support on a range of topics in our <a href="https://www.hsbc.co.uk/help/" target="_self" title="Contact and Support">Help</a> section.',msg4:'If you&apos;ve got a question about [topic], hit &apos;Start a chat&apos; to talk to a specialist now. If you can&apos;t see Live chat button below, it means our specialists aren&apos;t available at the moment - here are some other ways to <a href="https://www.hsbc.co.uk/contact/" target="_self" title="Contact and Support">contact us</a>.',blank:'<a href="https://www.hsbc.co.uk/online/dashboard/" target="_self" title="Log on to Online Banking">Log on</a> to chat with us, or see <a href="https://www.hsbc.co.uk/contact/" target="_self" title="Contact Us">other ways to get in touch</a>.'},context:[{urls:["/current-accounts/products/overdraft-calculator/","/current-accounts/products/overdrafts/","/current-accounts/products/overdrafts/overdrafts-explained/","/current-accounts/products/overdrafts/how-to-get-out-of-your-overdraft/","/current-accounts/products/overdrafts/what-is-overdraft-repeat-use/","/current-accounts/products/overdrafts/overdraft-repeat-use-faqs/","/help/coronavirus/overdraft-support/","/help/coronavirus/overdraft-support/calculator/"],startContext:"Root.Overdrafts"},{urls:["/mortgages/","/mortgages/products/","/mortgages/how-much-could-i-borrow/","/mortgages/first-time-buyers/","/mortgages/move-your-mortgage/","/mortgages/steps-to-buying-your-own-home/","/mortgages/types-of-mortgages/","/mortgages/move-your-mortgage/","/mortgages/existing-customers/","/mortgages/existing-customers/switch/","/mortgages/existing-customers/borrow-more/","/mortgages/existing-customers/move/"],startContext:"Root.Mortgages"},{urls:["/mortgages/how-to-apply/"],startContext:"Root.Mortgages.Applying"},{urls:["/mortgages/buy-to-let/","/mortgages/existing-customers/rent/"],startContext:"Root.Mortgages.Buy To Let"},{urls:["/savings/how-to-save-for-a-housing-deposit/","/mortgages/how-make-offer-house/","/mortgages/existing-customers/faqs/"],startContext:"Root.Mortgages.Other"},{urls:["/mortgages/existing-customers/overpay/"],startContext:"Root.Mortgages.Overpayments"},{urls:["/mortgages/fees/","/mortgages/our-rates/","/mortgages/calculators/"],startContext:"Root.Mortgages.Rates"},{urls:["/mortgages/repayment-calculator/"],startContext:"Root.Mortgages.Repayments"},{urls:["/current-accounts/products/children/","/savings/products/mysavings/"],startContext:"Root.Current Accounts.MyMoney"}],bannerFilter:[{urls:["/help/life-events/bereavement/"],topic:"Bereavement"},{urls:["/investments/","/investments/isas/","/investments/funds/","/investments/products-and-services/invest-direct/","/investments/products-and-services/my-investment/","/investments/advice/","/wealth/planning/financial-action-plan/","/investments/what-makes-HSBC-different/","/wealth/planning/","/wealth/articles/"],topic:"Investments"},{urls:["/insurance/","/insurance/products/","/insurance/products/select-and-cover/","/insurance/products/select-and-cover/existing-customers/","/insurance/products/select-and-cover/claims/","/insurance/products/home/","/insurance/products/life/cover/","/insurance/products/travel/","/insurance/products/life/critical-illness-cover/","/insurance/products/life/income-cover/","/insurance/telephone-protection-advice/","/insurance/products/premier-travel/"],topic:"Insurance"},{urls:["/mortgages/","/mortgages/products/","/mortgages/how-much-could-i-borrow/","/mortgages/first-time-buyers/","/mortgages/move-your-mortgage/","/mortgages/buy-to-let/","/mortgages/steps-to-buying-your-own-home/","/mortgages/types-of-mortgages/","/savings/how-to-save-for-a-housing-deposit/","/mortgages/how-make-offer-house/","/mortgages/move-your-mortgage/","/mortgages/how-to-apply/","/mortgages/fees/","/mortgages/our-rates/","/mortgages/existing-customers/","/mortgages/existing-customers/switch/","/mortgages/existing-customers/borrow-more/","/mortgages/existing-customers/move/","/mortgages/existing-customers/overpay/","/mortgages/existing-customers/rent/","/mortgages/existing-customers/faqs/","/mortgages/calculators/","/mortgages/repayment-calculator/"],topic:"Mortgages"}]},self.init=function(){if(self.conf.debug&&console.log("[VA-INFO] Init has been executed"),1==url_filter())return console.log("Not loading the Virtual-Assistant"),{};self.loadScripts(self.conf.scripts,(function(){for(var key in self.events(cvjq),self.ics.init(cvjq),self.conf.component.autocomplete&&self.autocomplete.init(cvjq),self.conf.component.livechat&&self.lc.init(cvjq),self.conf.component.sso&&self.sso.init(cvjq),self.conf.state.localStorage=VAMD.util.checkStorage(),self.conf.clientConfig&&(self.conf.clientConfig=eval(self.conf.clientConfig)),null==self.conf.clientConfig&&(self.conf.clientConfig={enable_va:!0}),self.conf.clientConfig&&1==self.conf.clientConfig.enable_livechat&&(self.conf.state.mode=2),self.conf.state.lc_button="hide_lc_button",(self.conf.showLCButton||self.conf.clientConfig&&1==self.conf.clientConfig.showLCButton)&&(self.conf.state.lc_button="show_lc_button"),self.conf.bannerFilter)-1!=cvjq.inArray(window.location.pathname,self.conf.bannerFilter[key].urls)&&(self.conf.banner.msg2=self.conf.banner.msg2.replace("[topic]",self.conf.bannerFilter[key].topic),self.conf.banner.msg4=self.conf.banner.msg4.replace("[topic]",self.conf.bannerFilter[key].topic),self.conf.state.topicBanner=!0);for(var key in self.conf.context)-1!=cvjq.inArray(window.location.pathname,self.conf.context[key].urls)&&(self.conf.va.startContext=self.conf.context[key].startContext);loadTemplate(cvjq,(function(){self.renderTemplate(cvjq),self.conf.loading.autoshow&&1==VAMD.util.getStorage("VA_OPEN")&&cvjq(VAMD).trigger("va.open"),self.conf.loading.autoshow&&self.conf.templateType.popup&&cvjq(VAMD).trigger("va.open"),self.renderTemplate(cvjq,{status:"amend_role"})})),"undefined"!=typeof lpTag&&self.lplc.init(cvjq)}))};var loadTemplate=function($,callback){self.conf.production?callback&&callback():$.ajax({type:"GET",url:self.conf.resourceURI+"/js/template.cv.html",contentType:"text/plain",async:!1,jsonpCallback:"cvcallback",cache:!1,xhrFields:{withCredentials:!1},timeout:1e4}).done((function(template){self.conf.template=template,callback&&callback()})).fail((function(jqXHR,exception){VAMD.util.ajaxErrorParse(jqXHR,exception),callback&&callback()}))};self.configMonitor=function(){Object.defineProperty(va_config,"watch",{value:function(prop,handler){var setter=function(val){return handler.call(this,val)};Object.defineProperty(this,prop,{set:setter})}})},self.renderTemplate=function($,params){var $va=$("#virtual-assistant"),t=void 0!==params?params.status:"null";switch($va.addClass("va-fade"),self.conf.state.banner&&(self.conf.state.topicBanner?$(window).width()>self.conf.threshold?$va.find(".va-banner").html(VAMD.conf.banner.msg2):$va.find(".va-banner").html(VAMD.conf.banner.msg4):$(window).width()>self.conf.threshold?$va.find(".va-banner").html(VAMD.conf.banner.msg1):$va.find(".va-banner").html(VAMD.conf.banner.msg3),$va.find(".va-lc-banner").html(VAMD.conf.banner.blank),$va.addClass("va-ban-active")),t){case"open":$va.addClass("va-active"),self.conf.state.localStorage&&VAMD.util.setStorage({VA_OPEN:1}),VAMD.util.globalShadow($,!0),$(".va-trigger").attr("aria-label","Close");break;case"close":$va.removeClass("va-active"),self.conf.state.localStorage&&VAMD.util.setStorage({VA_OPEN:0}),VAMD.util.globalShadow($,!1),$(".va-trigger").attr("aria-label","Need help button");break;case"reload":$(".va-pod-wrap").remove(),$va.removeClass("va-active"),VAMD.util.globalShadow($,!1),self.conf.templateType.popup?$va.addClass("va-tmpl-popup"):"undefined"===self.conf.templateType.type||"slideout"==self.conf.templateType.type?$va.addClass("va-tmpl-sld"):$va.addClass("va-tmpl-mod"),$va.attr("tabindex",0).append(self.conf.template);break;case"show_lc_button":$va.find(".va-wrap, .va-body, .va-inp").addClass("lcbutton"),$va.find(".livechat_button").show();break;case"hide_lc_button":$va.find(".va-wrap, .va-body, .va-inp").removeClass("lcbutton"),$va.find(".livechat_button").hide();break;case"change_trigger_text":$va.find(".va-trigger").html(params.data);break;case"amend_role":$va.attr({role:"dialog","aria-label":"How can we Help"});break;default:self.conf.templateType.popup?$va.addClass("va-tmpl-popup"):"undefined"===self.conf.templateType.type||"slideout"==self.conf.templateType.type?$va.addClass("va-tmpl-sld"):$va.addClass("va-tmpl-mod"),$va.attr("tabindex",0).append(self.conf.template),self.conf.debug&&console.log("[VA-INFO] Template has been rendered")}},self.engineInit=function(params){self.conf.debug&&console.log("[VA-INFO] Initialising engine init"),"object"==typeof params?(self.conf.debug&&console.log("[VA-INFO] Passing custom launch data for to init. Data: "),self.conf.debug&&console.log(params),va.init($.extend(params,{init:1}))):va.init({init:1})};var loadScript=function(file,callback){var filenode;callback=callback||function(){};var jsfile=/(.js)$/i,cssfile=/(.css)$/i,path=1==self.conf.state.ls?"/js/":"/lcmodule/libs/",version="undefined"!=typeof vaVersion?vaVersion:0,useLocalVersion=!1;if("undefined"!=typeof vaFileVersion&&0!==Object.keys(vaFileVersion).length&&vaFileVersion.constructor===Object)var useLocalVersion=!0;self.conf.debug&&console.log("[VA-INFO] Attempting to load %c%s","font-weight:bold",file),jsfile.test(file)?(filenode=document.createElement("script"),useLocalVersion&&(version=vaFileVersion[file]),filenode.src=VAMD.conf.resourceURI+path+file+"?v="+version,filenode.readyState?filenode.onreadystatechange=function(){"loaded"!==filenode.readyState&&"complete"!==filenode.readyState||(filenode.onreadystatechange=null,self.conf.debug&&console.log("[VA-INFO] %c%s has been successfully loaded","color:#0000FF",file),callback())}:filenode.onload=function(){self.conf.debug&&console.log("[VA-INFO] %c%s has been successfully loaded","color:#0000FF",file),callback()},document.getElementById("virtual-assistant").appendChild(filenode)):cssfile.test(file)?((filenode=document.createElement("link")).rel="stylesheet",filenode.type="text/css",useLocalVersion&&(version=vaFileVersion[file]),filenode.href=self.conf.resourceURI+"/css/"+file+"?v="+version,document.getElementById("virtual-assistant").appendChild(filenode),self.conf.debug&&console.log("[VA-INFO] %c%s has been successfully loaded","color:#0000FF",file),callback()):self.conf.debug&&console.error("[VA-ERROR] Unknown file type to be loaded.")},index,cont;return self.requiredScripts=(index=0,cont=!0,function(files,callback){function callBackCounter(){index===files.length?(index=0,callback()):self.requiredScripts(files,callback)}!self.conf.loadJQ&&cont&&void 0!==window.jQuery&&(index=1,cont=!1),self.conf.loadJQ&&1==index?cvjq=jQuery.noConflict(!0):self.conf.loadJQ||1!=index||(cvjq=$,self.conf.debug&&console.log("[VA-INFO] Using parent page jQuery %s",cvjq.fn.jquery)),loadScript(files[(index+=1)-1],callBackCounter)}),self.loadScripts=function(SL,callback){self.conf.debug&&console.group("[VA-INFO] Resource loading"),self.requiredScripts(SL,(function(){self.conf.debug&&console.groupEnd(),self.conf.debug&&console.log("[VA-INFO] %cAll scripts were successfully loaded","color: #01ab4d"),callback&&callback()}))},self.useMobChannel=function($){return self.conf.screenWidth=$(window).innerWidth(),self.conf.screenWidth<=self.conf.threshold},self.events=function($){var $va=$("#virtual-assistant");$(VAMD).on("va.toggle",(function(e,data){if(VAMD.conf.component.sso&&!VAMD.conf.state.auth&&VAMD.sso.checkUser(),1==self.conf.state.mode&&(self.conf.state.active?(self.conf.debug&&console.log("[VA-INFO] %cVA is being closed","color:#bb0101"),self.renderTemplate($,{status:"close"}),self.conf.state.active=!1):(self.conf.debug&&console.log("[VA-INFO] %cVA is being opened","color:#017aaf"),self.conf.superplaceholder.enable&&self.conf.superplaceholder.instance&&(self.conf.debug&&console.log("[VA-INFO] Restarting the superplaceholder on VA Open"),self.conf.superplaceholder.instance.stop(),cvjq("#virtual-assistant #entry").attr("placeholder",""),setTimeout((function(){self.conf.superplaceholder.instance.start()}),150)),"open"==self.conf.availChecks.startAvailChecks&&VAMD.lc_agent_check.start_check(self.conf.availChecks.availChecks_queueId,self.onAvailCheckResult),!self.conf.state.loaded&&self.engineInit(data),self.renderTemplate($,{status:"open"}),self.conf.state.active=!0)),2==self.conf.state.mode){var open_lc_window=function(){self.conf.debug&&console.log("[VA-INFO] %cLC is being opened","color:#017aaf"),self.renderTemplate(cvjq,{status:"hide_lc_button"}),self.renderTemplate($,{status:"open"}),self.conf.state.active=!0,1==self.conf.state.agents_available?VAMD.lc.offerLiveChat():VAMD.lc.showAvailabilityDialog(cvjq)};self.conf.state.active?(self.conf.debug&&console.log("[VA-INFO] %cLC is being closed","color:#bb0101"),self.renderTemplate($,{status:"close"}),self.conf.state.active=!1):"open"==self.conf.availChecks.startAvailChecks||"once"==self.conf.availChecks.startAvailChecks?VAMD.lc_agent_check.start_check(self.conf.availChecks.availChecks_queueId,(function(data){self.onAvailCheckResult(data),self.conf.state.active||open_lc_window()})):open_lc_window()}})),$(VAMD).on("va.close",(function(e,data){self.conf.debug&&console.log("[VA-INFO] %cVA is being closed","color:#bb0101"),self.renderTemplate($,{status:"close"}),self.conf.state.active=!1})),$(VAMD).on("va.open",(function(e,data){self.conf.debug&&console.log("[VA-INFO] %cVA is being opened","color:#017aaf"),self.renderTemplate($,{status:"open"}),self.conf.state.loaded?"object"==typeof data&&va.request(data):self.engineInit(data),self.conf.state.active=!0,VAMD.conf.component.sso&&!VAMD.conf.state.auth&&VAMD.sso.checkUser()})),$(VAMD).on("va.render",(function(){self.renderTemplate($)})),$(VAMD).on("va.re-render",(function(){VAMD.renderTemplate($,{status:"reload"}),self.conf.state.active=!1})),$va.on("click",".va-trigger",(function(){$(VAMD).trigger("va.toggle")})),$va.on("keyup",".va-trigger",(function(e){13===e.keyCode&&$(VAMD).trigger("va.toggle")})),$("body").on("click",".va-launch-button",(function(){var entryText=$(".searchField").val();$(VAMD).trigger("va.open",[{entry:entryText}]),self.conf.state.loaded&&va.request({entry:entryText})})),$("body").on("keypress",".searchField",(function(e){if(13==e.which)return $(".va-launch-button").trigger("click"),!1})),$va.on("click",".va-related-head.va-toggle",(function(){$(this).hasClass("va-active")?($(this).parent().removeClass("va-nav-open"),$(this).removeClass("va-active")):($(this).parent().addClass("va-nav-open"),$(this).addClass("va-active"))})),$va.on("click",".va-close",(function(e){e.preventDefault(),$(VAMD).trigger("va.close")})),$va.on("click",".va-modal-close:not(.va-ics-close), .va-modal-close-normal-button",(function(){self.conf.debug&&console.log("[VA-INFO] %cClosing active modal window","color:#bb0101"),VAMD.util.removeModalWindow($,(function(){1==self.conf.state.mode&&self.engineInit(),2==self.conf.state.mode&&(self.conf.livechat.state.modalCred=!1,$(VAMD).trigger("va.close"))}))})),$(document).on("keyup",(function(e){27===e.keyCode&&(self.conf.templateType.popup?window.close():(0!==$va.has(e.target).length||$(e.target).is($va))&&self.conf.state.active&&$(VAMD).trigger("va.close"))})),$(document).on("mouseup",(function(e){if(self.conf.component.autocomplete){var container=$(".va-autocomplete");container.is(e.target)||0!==container.has(e.target).length||self.autocomplete.destroy($)}})),$va.on("blur","#entry",(function(){self.conf.superplaceholder.enable&&self.conf.superplaceholder.instance&&(cvjq("#virtual-assistant #entry").attr("placeholder")==VAMD.conf.superplaceholder.instance_sentences[VAMD.conf.superplaceholder.instance_sentences.length-1]?(self.conf.debug&&console.log("[VA-INFO] Restaring the Superplaceholder on Blur"),self.conf.superplaceholder.instance.stop(),cvjq("#virtual-assistant #entry").attr("placeholder",""),self.conf.superplaceholder.instance.start()):self.conf.debug&&console.log("[VA-INFO] Not restaring the Superplaceholder on Blur as it has yet to finish"))})),$va.on("click",".va-menu .va-menu-icon",(function(e){e.preventDefault(),$(this).hasClass("va-menu-icon-up")?VAMD.conf.state.fontSize<20&&(VAMD.conf.state.fontSize=VAMD.conf.state.fontSize+2,$("#virtual-assistant .va-body-wrap").css({"font-size":VAMD.conf.state.fontSize+"px"})):VAMD.conf.state.fontSize>12&&(VAMD.conf.state.fontSize=VAMD.conf.state.fontSize-2,$("#virtual-assistant .va-body-wrap").css({"font-size":VAMD.conf.state.fontSize+"px"}))})),$va.on("click",".va-menu-nav",(function(){$(this).toggleClass("va-menu-open"),$(this).parent().toggleClass("va-active")})),$va.on("keyup",".va-menu-nav",(function(e){13===e.keyCode&&$(".va-menu-nav").trigger("click")})),$va.on("click",".va-menu .va-menu-print",(function(e){e.preventDefault();var printStyle=".va-qst{font-weight:600;margin-bottom:10px;}.va-ans{border-bottom:1px solid #cccccc;padding-bottom:10px;margin-bottom:20px;}.va-offer-ics,.va-dtree,.va-ans-print, .va-ans-expand{display:none}",printHTML=$va.find(".va-content").html();printHTML=printHTML.replace(/src="\/media\/image/g,'src="'+window.location.origin+"/media/image"),$("#virtual-assistant #va-print-page").contents().find("head").append($("<style type='text/css'>"+printStyle+"</style>")),$("#virtual-assistant #va-print-page").contents().find("body").html('<div class="va-printable"><div class="va-print-content>"'+printHTML+"</div></div>"),window.frames["va-print-page"].focus(),window.frames["va-print-page"].print()})),$va.on("click",".va-banner-close",(function(e){e.preventDefault(),VAMD.conf.state.banner=!1,$va.removeClass("va-ban-active")})),$(window).resize((function(){VAMD.conf.state.banner&&(VAMD.conf.state.topicBanner?$(window).width()>VAMD.conf.threshold?$va.find(".va-banner").html(VAMD.conf.banner.msg2):$va.find(".va-banner").html(VAMD.conf.banner.msg4):$(window).width()>VAMD.conf.threshold?VAMD.conf.state.lcactive?$va.find(".va-banner").html(VAMD.conf.banner.msg2):$va.find(".va-banner").html(VAMD.conf.banner.msg1):VAMD.conf.state.lcactive?$va.find(".va-banner").html(VAMD.conf.banner.msg4):$va.find(".va-banner").html(VAMD.conf.banner.msg3))}))},self}();function ask_question(question,faqIDin,faqMainCatID,faqMainCatDesc,recognitionID,answerID){return va.request({entry:question})}function bot_nav(url,target,win_attr,noAutoNav){var win;0==target.length?window.open(url,"_self"):window.open(url,"_blank").focus()}VAMD.lplc=function(){var self={init:function($){VAMD.conf.debug&&console.log("[VA-INFO] %cEnabling [LP LC]","color:#FF69B4"),self.events($),VAMD.conf.state.lcinit||(LivePersonVirtualAssistantModule.injectButtonContainer(),VAMD.conf.state.lcinit=!0,VAMD.conf.debug&&console.log("[VA-INFO] %cLC container has been injected","color:#FF69B4")),LivePersonVirtualAssistantModule.init()},events:function($){lpTag.events.bind("LP_VA_PANEL_MODULE","*",(function(eventData,info){VAMD.conf.debug&&console.log("[VA-INFO] %cLive chat event name: %s","color:#FF69B4",info.eventName),"SHOULD_SHOW_BUTTON_CONTENT"==info.eventName&&VAMD.lplc.liveChatButton($,eventData),"SHOULD_HIDE_BUTTON_CONTENT"==info.eventName&&(self.conf.debug&&console.log("[VA-INFO] %cButton status: %s","color:#FF69B4",eventData.status),VAMD.lplc.liveChatButton($,{status:"OFFLINE"})),"SHOULD_SHOW_VA_PANEL"==info.eventName&&$(VAMD).trigger("va.open"),"SHOULD_HIDE_VA_PANEL"==info.eventName&&$(VAMD).trigger("va.close")}))},liveChatButton:function($,data){VAMD.conf.debug&&console.log("[VA-INFO] %cLive chat button status: %s","color:#FF69B4",data.status);var $va=$("#virtual-assistant");$va.removeClass("va-lc-active"),$va.find(".va-lc-wrap a.va-lc-button").hide(),VAMD.conf.state.lcactive=!1,"ONLINE"==data.status&&($va.addClass("va-lc-active"),$va.find("a.va-lc-button.btn-success").css({display:"block"}),VAMD.conf.state.lcactive=!0,$(window).width()>VAMD.conf.threshold?$va.find(".va-banner").html(VAMD.conf.banner.msg2):$va.find(".va-banner").html(VAMD.conf.banner.msg4))}};return self}(),VAMD.ics=function(){var self={init:function($){VAMD.conf.debug&&console.log("[VA-INFO] %cEnabling [ICS]","color:#F84586"),self.events($)},create:function($,type,resp,otherReason,otherReasonText){VAMD.util.createModalWindow($,"va-ics-dialog va-ics",!1,(function(){var $list=$("<ul/>"),$title="whyNotHelpful"==type?$("<h3/>",{class:"va-modal-title"}).append("Why wasn't this answer helpful?"):$("<h3/>",{class:"va-modal-title"}).append("Why didn't it save you a call?"),$button=$("<button />",{class:"va-btn-ics",type:"submit"}).append("Send"),$close=$("<a />",{href:"",class:"va-ics-close va-modal-close",role:"button","aria-label":"Click here to close the survey window"}).append("Close the survey"),i=1;if($.each(resp,(function(i,item){if(""!=item.DefaultClickText&&"Another Reason"!=item.DefaultClickText){var $option=$("<li/>");$option.append($("<input/>",{type:"radio",value:item.DefaultClickText,name:"va-ics-opt",id:"va-ics-val"+i})).append($("<label/>",{for:"va-ics-val"+i}).append(item.DefaultClickText)),$list.append($option),i++}})),void 0!==otherReason){var $option=$("<li/>");$option.append($("<input/>",{type:"radio",value:"custom",name:"va-ics-opt",id:"va-ics-val10"})).append($("<label/>",{for:"va-ics-val10"}).append("Another Reason")).append($("<div />",{class:"va-ics-oth-inp"}).append($("<textarea />",{class:"va-input-other-reason",placeholder:"Enter your feedback here"}))).append($("<div />",{class:"va-other-reason-count"}).append($("<span />",{class:"chars"}).append("400")).append(" characters remaining")),$list.append($option)}$(".va-modal").append($title).append($list).append($button).append($close)}))}},_request=function(entry){if(entry.length<1)return!1;va.request({entry:entry,mainCat:va.mainCat,DTreeRequestType:0,DTREE_OBJECT_ID:va.dTreeObjectId,DTREE_NODE_ID:va.dTreeNodeId})},_destroy=function($){VAMD.util.removeModalWindow($)};return self.events=function($){var $va=$("#virtual-assistant");$va.on("click",".va-ics .va-btn-ics",(function(){var icsEntry="";$('.va-ics input[name="va-ics-opt"]').each((function(){$(this).prop("checked")&&(icsEntry=$(this).val())})),icsEntry.length<1&&va.submitICS("_ics_no_reason_given_"),"custom"==icsEntry&&(icsEntry=$(".va-input-other-reason").val()).length<1&&va.submitICS("_ics_no_reason_given_"),_request(icsEntry),_destroy($)})),$va.on("click",".va-ics-close",(function(e){e.preventDefault(),_request("_ics_user_cancelled_"),_destroy($)})),$va.on("keyup",".va-input-other-reason",(function(){var maxlength=400;$(this).val().length>400?$(this).val($(this).val().substring(0,400)):$(".va-other-reason-count span").text(400-$(this).val().length)}))},self}(),VAMD.autocomplete=function(){var self={},requestParams={AUTO_COMPLETE:1,FAQ:0,ident:VAMD.conf.state.ident,channel:VAMD.conf.va.channel,businessArea:VAMD.conf.va.businessArea};self.destroy=function($){$("#virtual-assistant .va-autocomplete").removeClass("va-show").find("ul").remove(),$("#virtual-assistant .va-inp-txt").attr("aria-activedescendant","")};var typewatch=(timer=0,function(callback,ms){clearTimeout(timer),timer=setTimeout(callback,ms)}),timer,select=function(){$("#virtual-assistant .va-inp-txt").val($(".va-autocomplete-selected a").text())};return self.init=function($){VAMD.conf.debug&&console.log("[VA-INFO] %cEnabling [AUTOCOMPLETE]","color:#F84586"),self.events($)},self.events=function($){var $va=$("#virtual-assistant");$va.on("keyup",".va-inp-txt",(function(e){if(VAMD.conf.state.loaded&&1==VAMD.conf.state.mode){27==e.keyCode&&self.destroy($);var input=$(this).val();VAMD.conf.state.typing=!0,typewatch((function(){input.length>2&&38!=e.keyCode&&40!=e.keyCode&&27!=e.keyCode&&13!=e.keyCode&&(requestParams=$.extend(requestParams,{entry:input,ident:$va.ident}),VAMD.conf.debug&&console.group("[VA-INFO] Autocomplete request"),VAMD.conf.debug&&console.log("[VA-INFO] Sending autocomplete request to the engine. Request data: %o",requestParams),VAMD.conf.debug&&console.groupEnd(),$.ajax({url:VAMD.conf.autocompleteURI,type:"GET",data:requestParams}).done((function(data){var $ul=$("<ul/>",{id:"va-autocomplete-results",role:"listbox"}),t=0;$(data).find("AutoComplete").each((function(i,item){if(!(t<3))return!1;var $listItem=$("<li/>",{role:"option"}).append($("<a/>",{href:"",title:"",id:"va-atv"+t,"data-recognition-id":$(item).find("RecognitionId").text(),"data-dtree":"false","data-answer-id":$(item).find("AnswerLinkId").text(),tabindex:0,role:"button","aria-selected":!1}).append($(item).find("QuestionText").text()));$ul.append($listItem),t++})),self.destroy($),t>0&VAMD.conf.state.typing&&$("#virtual-assistant .va-autocomplete").append($ul).addClass("va-show")})).fail((function(jqXHR,exception){VAMD.util.ajaxErrorParse(jqXHR,exception)}))),input.length<=1&&self.destroy($)}),500)}})),$va.on("mouseover",".va-autocomplete a",(function(){$("#virtual-assistant .va-inp-txt").attr("aria-activedescendant",$(this).attr("id"))})),$va.on("keydown",".va-inp-txt",(function(e){var $autoc=$("#virtual-assistant .va-autocomplete");if(13==e.keyCode&&$autoc.find("li").each((function(){$(this).hasClass("va-autocomplete-selected")&&($(".va-inp-txt").val($(this).children("a").text()),self.destroy($))})),40==e.keyCode)if($autoc.find("li").hasClass("va-autocomplete-selected"))if($autoc.find("li").last().hasClass("va-autocomplete-selected"))$autoc.find("li").last().removeClass("va-autocomplete-selected"),$autoc.find("li").first().addClass("va-autocomplete-selected"),$(this).attr("aria-activedescendant",$autoc.find("li").first().find("a").attr("id"));else{var $node=$autoc.find("li.va-autocomplete-selected");$(this).attr("aria-activedescendant",$node.next().find("a").attr("id")),$node.removeClass("va-autocomplete-selected").next().addClass("va-autocomplete-selected")}else $autoc.find("li").first().addClass("va-autocomplete-selected"),$(this).attr("aria-activedescendant",$autoc.find("li").first().find("a").attr("id"));if(38==e.keyCode)if($autoc.find("li").hasClass("va-autocomplete-selected"))if($autoc.find("li").first().hasClass("va-autocomplete-selected"))$autoc.find("li").first().removeClass("va-autocomplete-selected"),$autoc.find("li").last().addClass("va-autocomplete-selected"),$(this).attr("aria-activedescendant",$autoc.find("li").last().find("a").attr("id"));else{var $node=$autoc.find("li.va-autocomplete-selected");$(this).attr("aria-activedescendant",$node.prev().find("a").attr("id")),$node.removeClass("va-autocomplete-selected").prev().addClass("va-autocomplete-selected")}else $autoc.find("li").last().addClass("va-autocomplete-selected"),$(this).attr("aria-activedescendant",$autoc.find("li").last().find("a").attr("id"))})),$(document).on("click",".va-autocomplete li",(function(){self.destroy($)}))},self}(),VAMD.util=function(){var self={getParameterByName:function(name,url){url||(url=window.location.href),name=name.replace(/[\[\]]/g,"\\$&");var regex,results=new RegExp("[#&]"+name+"(=([^&#]*)|&|#|$)").exec(url);return results?results[2]?decodeURIComponent(results[2].replace(/\+/g," ")):"":null},ajaxErrorParse:function(jqXHR,exception){var msg="";msg=0===jqXHR.status?"[VA-ERROR] Not connected. Verify Network.":404==jqXHR.status?"[VA-ERROR] Requested page not found [404].":500==jqXHR.status?"[VA-ERROR] Internal Server Error [500].":"parsererror"===exception?"[VA-ERROR] Requested JSON parse failed.":"timeout"===exception?"[VA-ERROR] Request has timed out.":"abort"===exception?"[VA-ERROR] Ajax request aborted.":"[VA-ERROR] Uncaught Error: "+jqXHR.responseText,VAMD.conf.debug&&console.error(msg)},getAppLocation:function(){var path="//www.askus.hsbc.co.uk";if("undefined"!=typeof utag_data&&void 0!==utag_data.site_domain)switch(utag_data.site_domain){case"www.business.hsbc.uk":path="//askus.business.hsbc.uk";break;case"apply.business.hsbc.com":case"cmb-uk-ca01.bwe.pws.internal.hsbc":case"apply-test2.business.hsbc.com":path="//askus.business.hsbc.com"}return path+"/commercial-banking"},sessionStartDate:function(arg){var now=new Date,date="";if(arguments.length>0)1==(hour=""+now.getHours()).length&&(hour="0"+hour),1==(minute=""+now.getMinutes()).length&&(minute="0"+minute),date=hour+":"+minute;else{var year=""+now.getFullYear(),month=""+(now.getMonth()+1);1==month.length&&(month="0"+month);var day=""+now.getDate();1==day.length&&(day="0"+day);var hour=""+now.getHours();1==hour.length&&(hour="0"+hour);var minute=""+now.getMinutes();1==minute.length&&(minute="0"+minute),date=day+"/"+month+"/"+year+" at "+hour+":"+minute}return date},globalShadow:function($,on){on?$("body").append($("<div/>",{class:"va-global-shadow"})):$(".va-global-shadow").remove()},checkStorage:function(){if("undefined"==typeof localStorage)return!1;try{return localStorage.setItem("va_test","yes"),"yes"===localStorage.getItem("va_test")&&(localStorage.removeItem("va_test"),!0)}catch(e){return!1}},clearStorage:function(key){if(!self.checkStorage())return VAMD.conf.debug&&console.warn("[VA-WARN] Session storage is not available"),!1;VAMD.conf.debug&&console.log("[VA-INFO] %cRemoving local storage node with key: %s","color:#999999",key),localStorage.removeItem(key)},setStorage:function(data){if(!self.checkStorage())return VAMD.conf.debug&&console.warn("[VA-WARN] Session storage is not available"),!1;for(var key in data)data.hasOwnProperty(key)&&localStorage.setItem(key,data[key])},getStorage:function(key){if(self.checkStorage())var data=null!==localStorage.getItem(key)&&localStorage.getItem(key);return data},getTimeoutOffset:function(){var offset;return Math.floor((Date.now()-self.getStorage("VA_SESSIONTIME"))/6e4)},createModalWindow:function($,className,autoSize,callback){var asc,$modal=$("<div/>",{class:"va-modal-wrap "+(autoSize?"va-modal-autosize":"")});$modal.append($("<div/>",{class:"va-modal "+className}).append($("<a/>",{href:"javascript:void(0)",title:"",class:"va-modal-close"}))),$(".va-wrap").append($("<div/>",{class:"va-modal-shadow"})).append($modal),callback&&callback()},removeModalWindow:function($,callback){$(".va-modal-wrap, .va-modal-shadow").remove(),callback&&callback()},createSurveyForm:function($){VAMD.util.createModalWindow($,"va-lc-survey-dialog",!1,(function(){var $stars=$("<div/>",{class:"va-lc-survey-stars"});$stars.append($("<a/>",{href:"javascript:void(0)",title:"",class:"va-lc-star va-lc-star1"})).append($("<a/>",{href:"javascript:void(0)",title:"",class:"va-lc-star va-lc-star2"})).append($("<a/>",{href:"javascript:void(0)",title:"",class:"va-lc-star va-lc-star3"})).append($("<a/>",{href:"javascript:void(0)",title:"",class:"va-lc-star va-lc-star4"})).append($("<a/>",{href:"javascript:void(0)",title:"",class:"va-lc-star va-lc-star5"}));var $comments=$("<textarea/>",{class:"va-lc-survey-comment"}),$buttonSubmit=$("<a/>",{href:"javascript:void(0)",class:"va-lc-survey-submit",title:""}).append("Submit"),$buttonCancel=$("<a/>",{href:"javascript:void(0)",title:"",class:"va-lc-prompt-cancel"}).append("Cancel");$(".va-modal").append($("<h3/>",{class:"va-lc-user-dialog-title"}).append("How helpful was the agent today?")).append($("<div/>").append($("<p/>",{class:"va-lc-eocs-title"}).append("How helpful were we today?")).append($stars).append($("<p/>").append("Any comments?")).append($comments).append($("<div/>",{class:"va-lc-info-options clearfix"}).append($buttonSubmit).append($buttonCancel)))}))}};return self}(),VAMD.conf.loading.auto?"complete"==document.readyState?(VAMD.conf.debug&&console.log("[VA-INFO] Page has finished loading, we asume it is safe to continue"),VAMD.init()):window.addEventListener("load",(function(){VAMD.init()})):VAMD.conf.debug&&console.log("[VA-INFO] %cVA is set to initialise manually","color:#F32822");