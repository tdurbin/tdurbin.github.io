//tealium universal tag - utag.1836 ut4.0.202207272023, Copyright 2022 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;u.ev={"view":1};u.scriptrequested=u.scriptrequested||false;u.map={};u.extend=[];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){utag.DB("send:1836");utag.DB(b);var c,d,e,f;u.data={};utag.DB("send:1836:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
utag.DB("send:1836:MAPPINGS");utag.DB(u.data);if(!u.scriptrequested){/*@preserve
					 ***Version 1.1.2***
					 */
/*@license
					 *                       Copyright 2002 - 2018 Qualtrics, LLC.
					 *                        CONFIDENTIAL.  All rights reserved.
					 *
					 * Notice: All code, text, concepts, and other information herein (collectively, the
					 * "Materials") are the sole property of Qualtrics, LLC, except to the extent
					 * otherwise indicated. The Materials are proprietary to Qualtrics and are protected
					 * under all applicable laws, including copyright, patent (as applicable), trade
					 * secret, and contract law. Disclosure or reproduction of any Materials is strictly
					 * prohibited without the express prior written consent of an authorized signatory
					 * of Qualtrics. For disclosure requests, please contact notice@qualtrics.com.
					 */
typeof window.QSI!=="undefined"?window.QSI:{};window.QSIMethod={"runCore":function(e){try{(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?module.exports=factory():typeof define==='function'&&define.amd?define(factory):(global.DOMPurify=factory());}
(this,(function(){'use strict';var freeze$1=Object.freeze||function(x){return x;};var html=freeze$1(['a','abbr','acronym','address','area','article','aside','audio','b','bdi','bdo','big','blink','blockquote','body','br','button','canvas','caption','center','cite','code','col','colgroup','content','data','datalist','dd','decorator','del','details','dfn','dir','div','dl','dt','element','em','fieldset','figcaption','figure','font','footer','form','h1','h2','h3','h4','h5','h6','head','header','hgroup','hr','html','i','img','input','ins','kbd','label','legend','li','main','map','mark','marquee','menu','menuitem','meter','nav','nobr','ol','optgroup','option','output','p','pre','progress','q','rp','rt','ruby','s','samp','section','select','shadow','small','source','spacer','span','strike','strong','style','sub','summary','sup','table','tbody','td','template','textarea','tfoot','th','thead','time','tr','track','tt','u','ul','var','video','wbr']);var svg=freeze$1(['svg','a','altglyph','altglyphdef','altglyphitem','animatecolor','animatemotion','animatetransform','audio','canvas','circle','clippath','defs','desc','ellipse','filter','font','g','glyph','glyphref','hkern','image','line','lineargradient','marker','mask','metadata','mpath','path','pattern','polygon','polyline','radialgradient','rect','stop','style','switch','symbol','text','textpath','title','tref','tspan','video','view','vkern']);var svgFilters=freeze$1(['feBlend','feColorMatrix','feComponentTransfer','feComposite','feConvolveMatrix','feDiffuseLighting','feDisplacementMap','feDistantLight','feFlood','feFuncA','feFuncB','feFuncG','feFuncR','feGaussianBlur','feMerge','feMergeNode','feMorphology','feOffset','fePointLight','feSpecularLighting','feSpotLight','feTile','feTurbulence']);var mathMl=freeze$1(['math','menclose','merror','mfenced','mfrac','mglyph','mi','mlabeledtr','mmultiscripts','mn','mo','mover','mpadded','mphantom','mroot','mrow','ms','mspace','msqrt','mstyle','msub','msup','msubsup','mtable','mtd','mtext','mtr','munder','munderover']);var text=freeze$1(['#text']);var freeze$2=Object.freeze||function(x){return x;};var html$1=freeze$2(['accept','action','align','alt','autocomplete','background','bgcolor','border','cellpadding','cellspacing','checked','cite','class','clear','color','cols','colspan','coords','crossorigin','datetime','default','dir','disabled','download','enctype','face','for','headers','height','hidden','high','href','hreflang','id','integrity','ismap','label','lang','list','loop','low','max','maxlength','media','method','min','multiple','name','noshade','novalidate','nowrap','open','optimum','pattern','placeholder','poster','preload','pubdate','radiogroup','readonly','rel','required','rev','reversed','role','rows','rowspan','spellcheck','scope','selected','shape','size','sizes','span','srclang','start','src','srcset','step','style','summary','tabindex','title','type','usemap','valign','value','width','xmlns']);var svg$1=freeze$2(['accent-height','accumulate','additive','alignment-baseline','ascent','attributename','attributetype','azimuth','basefrequency','baseline-shift','begin','bias','by','class','clip','clip-path','clip-rule','color','color-interpolation','color-interpolation-filters','color-profile','color-rendering','cx','cy','d','dx','dy','diffuseconstant','direction','display','divisor','dur','edgemode','elevation','end','fill','fill-opacity','fill-rule','filter','flood-color','flood-opacity','font-family','font-size','font-size-adjust','font-stretch','font-style','font-variant','font-weight','fx','fy','g1','g2','glyph-name','glyphref','gradientunits','gradienttransform','height','href','id','image-rendering','in','in2','k','k1','k2','k3','k4','kerning','keypoints','keysplines','keytimes','lang','lengthadjust','letter-spacing','kernelmatrix','kernelunitlength','lighting-color','local','marker-end','marker-mid','marker-start','markerheight','markerunits','markerwidth','maskcontentunits','maskunits','max','mask','media','method','mode','min','name','numoctaves','offset','operator','opacity','order','orient','orientation','origin','overflow','paint-order','path','pathlength','patterncontentunits','patterntransform','patternunits','points','preservealpha','preserveaspectratio','r','rx','ry','radius','refx','refy','repeatcount','repeatdur','restart','result','rotate','scale','seed','shape-rendering','specularconstant','specularexponent','spreadmethod','stddeviation','stitchtiles','stop-color','stop-opacity','stroke-dasharray','stroke-dashoffset','stroke-linecap','stroke-linejoin','stroke-miterlimit','stroke-opacity','stroke','stroke-width','style','surfacescale','tabindex','targetx','targety','transform','text-anchor','text-decoration','text-rendering','textlength','type','u1','u2','unicode','values','viewbox','visibility','vert-adv-y','vert-origin-x','vert-origin-y','width','word-spacing','wrap','writing-mode','xchannelselector','ychannelselector','x','x1','x2','xmlns','y','y1','y2','z','zoomandpan']);var mathMl$1=freeze$2(['accent','accentunder','align','bevelled','close','columnsalign','columnlines','columnspan','denomalign','depth','dir','display','displaystyle','fence','frame','height','href','id','largeop','length','linethickness','lspace','lquote','mathbackground','mathcolor','mathsize','mathvariant','maxsize','minsize','movablelimits','notation','numalign','open','rowalign','rowlines','rowspacing','rowspan','rspace','rquote','scriptlevel','scriptminsize','scriptsizemultiplier','selection','separator','separators','stretchy','subscriptshift','supscriptshift','symmetric','voffset','width','xmlns']);var xml=freeze$2(['xlink:href','xml:id','xlink:title','xml:space','xmlns:xlink']);var hasOwnProperty=Object.hasOwnProperty;var setPrototypeOf=Object.setPrototypeOf;var _ref$1=typeof Reflect!=='undefined'&&Reflect;var apply$1=_ref$1.apply;if(!apply$1){apply$1=function apply(fun,thisValue,args){return fun.apply(thisValue,args);};}
function addToSet(set,array){if(setPrototypeOf){setPrototypeOf(set,null);}
var l=array.length;while(l--){var element=array[l];if(typeof element==='string'){var lcElement=element.toLowerCase();if(lcElement!==element){array[l]=lcElement;element=lcElement;}}
set[element]=true;}
return set;}
function clone(object){var newObject={};var property=void 0;for(property in object){if(apply$1(hasOwnProperty,object,[property])){newObject[property]=object[property];}}
return newObject;}
var seal=Object.seal||function(x){return x;};var MUSTACHE_EXPR=seal(/\{\{[\s\S]*|[\s\S]*\}\}/gm);var pattern='< %[\\s\\S]*|[\\s\\S]*% >';pattern=pattern.replace(/\s/g,"");var ERB_EXPR=new RegExp(pattern,'gm');var DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]/);var ARIA_ATTR=seal(/^aria-[\-\w]+$/);var IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i);var IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i);var ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g);var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}
return arr2;}else{return Array.from(arr);}}
var _ref=typeof Reflect!=='undefined'&&Reflect;var apply=_ref.apply;var arraySlice=Array.prototype.slice;var freeze=Object.freeze;var getGlobal=function getGlobal(){return typeof window==='undefined'?null:window;};if(!apply){apply=function apply(fun,thisValue,args){return fun.apply(thisValue,args);};}
var _createTrustedTypesPolicy=function _createTrustedTypesPolicy(trustedTypes,document){if((typeof trustedTypes==='undefined'?'undefined':_typeof(trustedTypes))!=='object'||typeof trustedTypes.createPolicy!=='function'){return null;}
var suffix=null;var ATTR_NAME='data-tt-policy-suffix';if(document.currentScript&&document.currentScript.hasAttribute(ATTR_NAME)){suffix=document.currentScript.getAttribute(ATTR_NAME);}
var policyName='dompurify'+(suffix?'#'+suffix:'');try{return trustedTypes.createPolicy(policyName,{createHTML:function createHTML(html$$1){return html$$1;}});}catch(e){console.warn('TrustedTypes policy '+policyName+' could not be created.');return null;}};function createDOMPurify(){var window=arguments.length>0&&arguments[0]!==undefined?arguments[0]:getGlobal();var DOMPurify=function DOMPurify(root){return createDOMPurify(root);};DOMPurify.version='1.0.8';DOMPurify.removed=[];if(!window||!window.document||window.document.nodeType!==9){DOMPurify.isSupported=false;return DOMPurify;}
var originalDocument=window.document;var useDOMParser=false;var removeTitle=false;var document=window.document;var DocumentFragment=window.DocumentFragment,HTMLTemplateElement=window.HTMLTemplateElement,Node=window.Node,NodeFilter=window.NodeFilter,_window$NamedNodeMap=window.NamedNodeMap,NamedNodeMap=_window$NamedNodeMap===undefined?window.NamedNodeMap||window.MozNamedAttrMap:_window$NamedNodeMap,Text=window.Text,Comment=window.Comment,DOMParser=window.DOMParser,TrustedTypes=window.TrustedTypes;if(typeof HTMLTemplateElement==='function'){var template=document.createElement('template');if(template.content&&template.content.ownerDocument){document=template.content.ownerDocument;}}
var trustedTypesPolicy=_createTrustedTypesPolicy(TrustedTypes,originalDocument);var emptyHTML=trustedTypesPolicy?trustedTypesPolicy.createHTML(''):'';var _document=document,implementation=_document.implementation,createNodeIterator=_document.createNodeIterator,getElementsByTagName=_document.getElementsByTagName,createDocumentFragment=_document.createDocumentFragment;var importNode=originalDocument.importNode;var hooks={};DOMPurify.isSupported=implementation&&typeof implementation.createHTMLDocument!=='undefined'&&document.documentMode!==9;var MUSTACHE_EXPR$$1=MUSTACHE_EXPR,ERB_EXPR$$1=ERB_EXPR,DATA_ATTR$$1=DATA_ATTR,ARIA_ATTR$$1=ARIA_ATTR,IS_SCRIPT_OR_DATA$$1=IS_SCRIPT_OR_DATA,ATTR_WHITESPACE$$1=ATTR_WHITESPACE;var IS_ALLOWED_URI$$1=IS_ALLOWED_URI;var ALLOWED_TAGS=null;var DEFAULT_ALLOWED_TAGS=addToSet({},[].concat(_toConsumableArray(html),_toConsumableArray(svg),_toConsumableArray(svgFilters),_toConsumableArray(mathMl),_toConsumableArray(text)));var ALLOWED_ATTR=null;var DEFAULT_ALLOWED_ATTR=addToSet({},[].concat(_toConsumableArray(html$1),_toConsumableArray(svg$1),_toConsumableArray(mathMl$1),_toConsumableArray(xml)));var FORBID_TAGS=null;var FORBID_ATTR=null;var ALLOW_ARIA_ATTR=true;var ALLOW_DATA_ATTR=true;var ALLOW_UNKNOWN_PROTOCOLS=false;var SAFE_FOR_JQUERY=false;var SAFE_FOR_TEMPLATES=false;var WHOLE_DOCUMENT=false;var SET_CONFIG=false;var FORCE_BODY=false;var RETURN_DOM=false;var RETURN_DOM_FRAGMENT=false;var RETURN_DOM_IMPORT=false;var SANITIZE_DOM=true;var KEEP_CONTENT=true;var IN_PLACE=false;var USE_PROFILES={};var FORBID_CONTENTS=addToSet({},['audio','head','math','script','style','template','svg','video']);var DATA_URI_TAGS=addToSet({},['audio','video','img','source','image']);var URI_SAFE_ATTRIBUTES=addToSet({},['alt','class','for','id','label','name','pattern','placeholder','summary','title','value','style','xmlns']);var CONFIG=null;var formElement=document.createElement('form');var _parseConfig=function _parseConfig(cfg){if(CONFIG&&CONFIG===cfg){return;}
if(!cfg||(typeof cfg==='undefined'?'undefined':_typeof(cfg))!=='object'){cfg={};}
ALLOWED_TAGS='ALLOWED_TAGS'in cfg?addToSet({},cfg.ALLOWED_TAGS):DEFAULT_ALLOWED_TAGS;ALLOWED_ATTR='ALLOWED_ATTR'in cfg?addToSet({},cfg.ALLOWED_ATTR):DEFAULT_ALLOWED_ATTR;FORBID_TAGS='FORBID_TAGS'in cfg?addToSet({},cfg.FORBID_TAGS):{};FORBID_ATTR='FORBID_ATTR'in cfg?addToSet({},cfg.FORBID_ATTR):{};USE_PROFILES='USE_PROFILES'in cfg?cfg.USE_PROFILES:false;ALLOW_ARIA_ATTR=cfg.ALLOW_ARIA_ATTR!==false;ALLOW_DATA_ATTR=cfg.ALLOW_DATA_ATTR!==false;ALLOW_UNKNOWN_PROTOCOLS=cfg.ALLOW_UNKNOWN_PROTOCOLS||false;SAFE_FOR_JQUERY=cfg.SAFE_FOR_JQUERY||false;SAFE_FOR_TEMPLATES=cfg.SAFE_FOR_TEMPLATES||false;WHOLE_DOCUMENT=cfg.WHOLE_DOCUMENT||false;RETURN_DOM=cfg.RETURN_DOM||false;RETURN_DOM_FRAGMENT=cfg.RETURN_DOM_FRAGMENT||false;RETURN_DOM_IMPORT=cfg.RETURN_DOM_IMPORT||false;FORCE_BODY=cfg.FORCE_BODY||false;SANITIZE_DOM=cfg.SANITIZE_DOM!==false;KEEP_CONTENT=cfg.KEEP_CONTENT!==false;IN_PLACE=cfg.IN_PLACE||false;IS_ALLOWED_URI$$1=cfg.ALLOWED_URI_REGEXP||IS_ALLOWED_URI$$1;if(SAFE_FOR_TEMPLATES){ALLOW_DATA_ATTR=false;}
if(RETURN_DOM_FRAGMENT){RETURN_DOM=true;}
if(USE_PROFILES){ALLOWED_TAGS=addToSet({},[].concat(_toConsumableArray(text)));ALLOWED_ATTR=[];if(USE_PROFILES.html===true){addToSet(ALLOWED_TAGS,html);addToSet(ALLOWED_ATTR,html$1);}
if(USE_PROFILES.svg===true){addToSet(ALLOWED_TAGS,svg);addToSet(ALLOWED_ATTR,svg$1);addToSet(ALLOWED_ATTR,xml);}
if(USE_PROFILES.svgFilters===true){addToSet(ALLOWED_TAGS,svgFilters);addToSet(ALLOWED_ATTR,svg$1);addToSet(ALLOWED_ATTR,xml);}
if(USE_PROFILES.mathMl===true){addToSet(ALLOWED_TAGS,mathMl);addToSet(ALLOWED_ATTR,mathMl$1);addToSet(ALLOWED_ATTR,xml);}}
if(cfg.ADD_TAGS){if(ALLOWED_TAGS===DEFAULT_ALLOWED_TAGS){ALLOWED_TAGS=clone(ALLOWED_TAGS);}
addToSet(ALLOWED_TAGS,cfg.ADD_TAGS);}
if(cfg.ADD_ATTR){if(ALLOWED_ATTR===DEFAULT_ALLOWED_ATTR){ALLOWED_ATTR=clone(ALLOWED_ATTR);}
addToSet(ALLOWED_ATTR,cfg.ADD_ATTR);}
if(cfg.ADD_URI_SAFE_ATTR){addToSet(URI_SAFE_ATTRIBUTES,cfg.ADD_URI_SAFE_ATTR);}
if(KEEP_CONTENT){ALLOWED_TAGS['#text']=true;}
if(WHOLE_DOCUMENT){addToSet(ALLOWED_TAGS,['html','head','body']);}
if(ALLOWED_TAGS.table){addToSet(ALLOWED_TAGS,['tbody']);}
if(freeze){freeze(cfg);}
CONFIG=cfg;};var _forceRemove=function _forceRemove(node){DOMPurify.removed.push({element:node});try{node.parentNode.removeChild(node);}catch(err){node.outerHTML=emptyHTML;}};var _removeAttribute=function _removeAttribute(name,node){try{DOMPurify.removed.push({attribute:node.getAttributeNode(name),from:node});}catch(err){DOMPurify.removed.push({attribute:null,from:node});}
node.removeAttribute(name);};var _initDocument=function _initDocument(dirty){var doc=void 0;var leadingWhitespace=void 0;if(FORCE_BODY){dirty='<remove></remove>'+dirty;}else{var matches=dirty.match(/^[\s]+/);leadingWhitespace=matches&&matches[0];if(leadingWhitespace){dirty=dirty.slice(leadingWhitespace.length);}}
if(useDOMParser){try{doc=new DOMParser().parseFromString(dirty,'text/html');}catch(err){}}
if(removeTitle){addToSet(FORBID_TAGS,['title']);}
if(!doc||!doc.documentElement){doc=implementation.createHTMLDocument('');var _doc=doc,body=_doc.body;body.parentNode.removeChild(body.parentNode.firstElementChild);body.outerHTML=trustedTypesPolicy?trustedTypesPolicy.createHTML(dirty):dirty;}
if(leadingWhitespace){doc.body.insertBefore(document.createTextNode(leadingWhitespace),doc.body.childNodes[0]||null);}
return getElementsByTagName.call(doc,WHOLE_DOCUMENT?'html':'body')[0];};if(DOMPurify.isSupported){(function(){try{var doc=_initDocument('<svg><p><style><img src="</style><img src=x onerror=alert(1)//">');if(doc.querySelector('svg img')){useDOMParser=true;}}catch(err){}})();(function(){try{var doc=_initDocument('<x/><title>&lt;/title&gt;&lt;img&gt;');if(doc.querySelector('title').innerHTML.match(/<\/title/)){removeTitle=true;}}catch(err){}})();}
var _createIterator=function _createIterator(root){return createNodeIterator.call(root.ownerDocument||root,root,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT,function(){return NodeFilter.FILTER_ACCEPT;},false);};var _isClobbered=function _isClobbered(elm){if(elm instanceof Text||elm instanceof Comment){return false;}
if(typeof elm.nodeName!=='string'||typeof elm.textContent!=='string'||typeof elm.removeChild!=='function'||!(elm.attributes instanceof NamedNodeMap)||typeof elm.removeAttribute!=='function'||typeof elm.setAttribute!=='function'){return true;}
return false;};var _isNode=function _isNode(obj){return(typeof Node==='undefined'?'undefined':_typeof(Node))==='object'?obj instanceof Node:obj&&(typeof obj==='undefined'?'undefined':_typeof(obj))==='object'&&typeof obj.nodeType==='number'&&typeof obj.nodeName==='string';};var _executeHook=function _executeHook(entryPoint,currentNode,data){if(!hooks[entryPoint]){return;}
hooks[entryPoint].forEach(function(hook){hook.call(DOMPurify,currentNode,data,CONFIG);});};var _sanitizeElements=function _sanitizeElements(currentNode){var content=void 0;_executeHook('beforeSanitizeElements',currentNode,null);if(_isClobbered(currentNode)){_forceRemove(currentNode);return true;}
var tagName=currentNode.nodeName.toLowerCase();_executeHook('uponSanitizeElement',currentNode,{tagName:tagName,allowedTags:ALLOWED_TAGS});if(!ALLOWED_TAGS[tagName]||FORBID_TAGS[tagName]){if(KEEP_CONTENT&&!FORBID_CONTENTS[tagName]&&typeof currentNode.insertAdjacentHTML==='function'){try{var htmlToInsert=currentNode.innerHTML;currentNode.insertAdjacentHTML('AfterEnd',trustedTypesPolicy?trustedTypesPolicy.createHTML(htmlToInsert):htmlToInsert);}catch(err){}}
_forceRemove(currentNode);return true;}
if(SAFE_FOR_JQUERY&&!currentNode.firstElementChild&&(!currentNode.content||!currentNode.content.firstElementChild)&&/</g.test(currentNode.textContent)){DOMPurify.removed.push({element:currentNode.cloneNode()});if(currentNode.innerHTML){currentNode.innerHTML=currentNode.innerHTML.replace(/</g,'&lt;');}else{currentNode.innerHTML=currentNode.textContent.replace(/</g,'&lt;');}}
if(SAFE_FOR_TEMPLATES&&currentNode.nodeType===3){content=currentNode.textContent;content=content.replace(MUSTACHE_EXPR$$1,' ');content=content.replace(ERB_EXPR$$1,' ');if(currentNode.textContent!==content){DOMPurify.removed.push({element:currentNode.cloneNode()});currentNode.textContent=content;}}
_executeHook('afterSanitizeElements',currentNode,null);return false;};var _isValidAttribute=function _isValidAttribute(lcTag,lcName,value){if(SANITIZE_DOM&&(lcName==='id'||lcName==='name')&&(value in document||value in formElement)){return false;}
if(SAFE_FOR_TEMPLATES){value=value.replace(MUSTACHE_EXPR$$1,' ');value=value.replace(ERB_EXPR$$1,' ');}
if(ALLOW_DATA_ATTR&&DATA_ATTR$$1.test(lcName)){}else if(ALLOW_ARIA_ATTR&&ARIA_ATTR$$1.test(lcName)){}else if(!ALLOWED_ATTR[lcName]||FORBID_ATTR[lcName]){return false;}else if(URI_SAFE_ATTRIBUTES[lcName]){}else if(IS_ALLOWED_URI$$1.test(value.replace(ATTR_WHITESPACE$$1,''))){}else if((lcName==='src'||lcName==='xlink:href')&&lcTag!=='script'&&value.indexOf('data:')===0&&DATA_URI_TAGS[lcTag]){}else if(ALLOW_UNKNOWN_PROTOCOLS&&!IS_SCRIPT_OR_DATA$$1.test(value.replace(ATTR_WHITESPACE$$1,''))){}else if(!value){}else{return false;}
return true;};var _sanitizeAttributes=function _sanitizeAttributes(currentNode){var attr=void 0;var value=void 0;var lcName=void 0;var idAttr=void 0;var l=void 0;_executeHook('beforeSanitizeAttributes',currentNode,null);var attributes=currentNode.attributes;if(!attributes){return;}
var hookEvent={attrName:'',attrValue:'',keepAttr:true,allowedAttributes:ALLOWED_ATTR};l=attributes.length;while(l--){attr=attributes[l];var _attr=attr,name=_attr.name,namespaceURI=_attr.namespaceURI;value=attr.value.trim();lcName=name.toLowerCase();hookEvent.attrName=lcName;hookEvent.attrValue=value;hookEvent.keepAttr=true;_executeHook('uponSanitizeAttribute',currentNode,hookEvent);value=hookEvent.attrValue;if(lcName==='name'&&currentNode.nodeName==='IMG'&&attributes.id){idAttr=attributes.id;attributes=apply(arraySlice,attributes,[]);_removeAttribute('id',currentNode);_removeAttribute(name,currentNode);if(attributes.indexOf(idAttr)>l){currentNode.setAttribute('id',idAttr.value);}}else if(currentNode.nodeName==='INPUT'&&lcName==='type'&&value==='file'&&(ALLOWED_ATTR[lcName]||!FORBID_ATTR[lcName])){continue;}else{if(name==='id'){currentNode.setAttribute(name,'');}
_removeAttribute(name,currentNode);}
if(!hookEvent.keepAttr){continue;}
var lcTag=currentNode.nodeName.toLowerCase();if(!_isValidAttribute(lcTag,lcName,value)){continue;}
try{if(namespaceURI){currentNode.setAttributeNS(namespaceURI,name,value);}else{currentNode.setAttribute(name,value);}
DOMPurify.removed.pop();}catch(err){}}
_executeHook('afterSanitizeAttributes',currentNode,null);};var _sanitizeShadowDOM=function _sanitizeShadowDOM(fragment){var shadowNode=void 0;var shadowIterator=_createIterator(fragment);_executeHook('beforeSanitizeShadowDOM',fragment,null);while(shadowNode=shadowIterator.nextNode()){_executeHook('uponSanitizeShadowNode',shadowNode,null);if(_sanitizeElements(shadowNode)){continue;}
if(shadowNode.content instanceof DocumentFragment){_sanitizeShadowDOM(shadowNode.content);}
_sanitizeAttributes(shadowNode);}
_executeHook('afterSanitizeShadowDOM',fragment,null);};DOMPurify.sanitize=function(dirty,cfg){var body=void 0;var importedNode=void 0;var currentNode=void 0;var oldNode=void 0;var returnNode=void 0;if(!dirty){dirty='<!-->';}
if(typeof dirty!=='string'&&!_isNode(dirty)){if(typeof dirty.toString!=='function'){throw new TypeError('toString is not a function');}else{dirty=dirty.toString();if(typeof dirty!=='string'){throw new TypeError('dirty is not a string, aborting');}}}
if(!DOMPurify.isSupported){if(_typeof(window.toStaticHTML)==='object'||typeof window.toStaticHTML==='function'){if(typeof dirty==='string'){return window.toStaticHTML(dirty);}
if(_isNode(dirty)){return window.toStaticHTML(dirty.outerHTML);}}
return dirty;}
if(!SET_CONFIG){_parseConfig(cfg);}
DOMPurify.removed=[];if(IN_PLACE){}else if(dirty instanceof Node){body=_initDocument('<!-->');importedNode=body.ownerDocument.importNode(dirty,true);if(importedNode.nodeType===1&&importedNode.nodeName==='BODY'){body=importedNode;}else{body.appendChild(importedNode);}}else{if(!RETURN_DOM&&!WHOLE_DOCUMENT&&dirty.indexOf('<')===-1){return trustedTypesPolicy?trustedTypesPolicy.createHTML(dirty):dirty;}
body=_initDocument(dirty);if(!body){return RETURN_DOM?null:emptyHTML;}}
if(body&&FORCE_BODY){_forceRemove(body.firstChild);}
var nodeIterator=_createIterator(IN_PLACE?dirty:body);while(currentNode=nodeIterator.nextNode()){if(currentNode.nodeType===3&&currentNode===oldNode){continue;}
if(_sanitizeElements(currentNode)){continue;}
if(currentNode.content instanceof DocumentFragment){_sanitizeShadowDOM(currentNode.content);}
_sanitizeAttributes(currentNode);oldNode=currentNode;}
oldNode=null;if(IN_PLACE){return dirty;}
if(RETURN_DOM){if(RETURN_DOM_FRAGMENT){returnNode=createDocumentFragment.call(body.ownerDocument);while(body.firstChild){returnNode.appendChild(body.firstChild);}}else{returnNode=body;}
if(RETURN_DOM_IMPORT){returnNode=importNode.call(originalDocument,returnNode,true);}
return returnNode;}
var serializedHTML=WHOLE_DOCUMENT?body.outerHTML:body.innerHTML;return trustedTypesPolicy?trustedTypesPolicy.createHTML(serializedHTML):serializedHTML;};DOMPurify.setConfig=function(cfg){_parseConfig(cfg);SET_CONFIG=true;};DOMPurify.clearConfig=function(){CONFIG=null;SET_CONFIG=false;};DOMPurify.isValidAttribute=function(tag,attr,value){if(!CONFIG){_parseConfig({});}
var lcTag=tag.toLowerCase();var lcName=attr.toLowerCase();return _isValidAttribute(lcTag,lcName,value);};DOMPurify.addHook=function(entryPoint,hookFunction){if(typeof hookFunction!=='function'){return;}
hooks[entryPoint]=hooks[entryPoint]||[];hooks[entryPoint].push(hookFunction);};DOMPurify.removeHook=function(entryPoint){if(hooks[entryPoint]){hooks[entryPoint].pop();}};DOMPurify.removeHooks=function(entryPoint){if(hooks[entryPoint]){hooks[entryPoint]=[];}};DOMPurify.removeAllHooks=function(){hooks={};};return DOMPurify;}
var purify=createDOMPurify();return purify;})));try{if(typeof QSI.DOMPurify==='undefined'){if(typeof window.DOMPurify==='undefined'){QSI.dbg.e("window.DOMPurify is undefined");}else{QSI.DOMPurify=window.DOMPurify;}}}catch(e){}
QSI.windowHandler={optInIDsAndTargetOrigins:'QSI_OptInIDsAndTargetOrigins',optInIDsAndWindowNames:'QSI_OptInIDsAndWindowNames',getWin:function(name,open){if(typeof name!=='string'){return null;}
var windows=QSI.windows;if(windows){var windowHandle=windows[name];if(windowHandle){if(windowHandle.closed){QSI.windowHandler.removeWindowHandle(name);return null;}else{return windowHandle;}}}
if(open){return window.open('',name);}
return null;},getWindowOrigin:function(windowHandler){var windowOrigin;try{if(typeof windowHandler!=='undefined'&&windowHandler!==null){windowOrigin=windowHandler.origin;if(!windowOrigin&&windowHandler.location){if(windowHandler.location.origin){windowOrigin=windowHandler.location.origin;}else{var location=windowHandler.location;windowOrigin=location.protocol+"//"+location.hostname+(location.port?':'+location.port:'');}}}}catch(e){QSI.dbg.e(e);}
return windowOrigin;},addOptInIDAndWindowName:function(id,name,targetOrigin){var optInIDsAndNames=this.getOptInIDsAndWindowNames()||{};var optInIDsAndOrigins=this.getOptInIDsAndTargetOrigins()||{};optInIDsAndNames[id]=name;optInIDsAndNames=JSON.stringify(optInIDsAndNames);optInIDsAndOrigins[id]=targetOrigin;optInIDsAndOrigins=JSON.stringify(optInIDsAndOrigins);window.sessionStorage.setItem(this.optInIDsAndWindowNames,optInIDsAndNames);window.sessionStorage.setItem(this.optInIDsAndTargetOrigins,optInIDsAndOrigins);},getOptInIDsAndWindowNames:function(){var optInIDsAndNames=window.sessionStorage.getItem(this.optInIDsAndWindowNames)||{};try{if(typeof optInIDsAndNames==='string'){optInIDsAndNames=JSON.parse(optInIDsAndNames);}}catch(e){QSI.dbg.e(e);optInIDsAndNames={};}
return optInIDsAndNames;},getOptInIDsAndTargetOrigins:function(){var optInIDsAndOrigins=window.sessionStorage.getItem(this.optInIDsAndTargetOrigins)||{};try{if(typeof optInIDsAndOrigins==='string'){optInIDsAndOrigins=JSON.parse(optInIDsAndOrigins);}}catch(e){QSI.dbg.e(e);optInIDsAndOrigins={};}
return optInIDsAndOrigins;},removeOptInIDAndWindowName:function(name){var optInIDsAndNames=this.getOptInIDsAndWindowNames()||{};var optInIDsAndOrigins=this.getOptInIDsAndTargetOrigins()||{};for(var id in optInIDsAndNames){if(optInIDsAndNames[id]===name){delete optInIDsAndNames[id];delete optInIDsAndOrigins[id];}}
window.sessionStorage.setItem(this.optInIDsAndWindowNames,JSON.stringify(optInIDsAndNames));window.sessionStorage.setItem(this.optInIDsAndTargetOrigins,JSON.stringify(optInIDsAndOrigins));},setupWindowHandles:function(){var optInIDsAndNames=this.getOptInIDsAndWindowNames()||{};for(var id in optInIDsAndNames){if(Object.prototype.hasOwnProperty.call(optInIDsAndNames,id)){var winName=optInIDsAndNames[id];var win=QSI.windowHandler.getWin(winName,true);if(win){QSI.windowHandler.addWindowHandle(winName,win);}else{QSI.windowHandler.removeOptInIDAndWindowName(winName);}}}},addWindowHandle:function(name,win){var windows=QSI.windows||{};windows[name]=win;QSI.windows=windows;},removeWindowHandle:function(name){var windows=QSI.windows;if(windows){delete windows[name];}},removeClosedWindowHandles:function(){var windows=QSI.windows;if(windows){for(var name in windows){if(windows[name].closed){delete windows[name];QSI.windowHandler.removeOptInIDAndWindowName(name);}}}}};if(window.QSI.LatencyLog===undefined||window.QTest){QSI.LatencyLog={send:function(metricName,latency,componentLatencies,additionalData){try{if(latency===undefined||metricName===undefined){QSI.dbg.e("Incomplete Latency Data Provided");return;}
var latencyEndpointUrl=QSI.baseURL+'Ajax.php?action=LatencyLog';if(typeof QSI.Orchestrator!=='undefined'&&typeof QSI.Orchestrator.getClientVersionQueryString!=='undefined'){latencyEndpointUrl=latencyEndpointUrl+'&'+QSI.Orchestrator.getClientVersionQueryString();}
var loggingData={MetricName:metricName,Latency:latency,ComponentLatencies:componentLatencies};var requestIDs=[];for(var requestID in QSI.reqID){if(Object.prototype.hasOwnProperty.call(QSI.reqID,requestID)){requestIDs.push(requestID);}}
loggingData.AdditionalData={RequestIDs:requestIDs,ClientURL:QSI.currentURL,UserAgent:navigator.userAgent,BrandID:QSI.global.brandID,BrandDC:QSI.global.brandDC};if(typeof additionalData==='object'){for(var key in additionalData){if(Object.prototype.hasOwnProperty.call(additionalData,key)){loggingData.AdditionalData[key]=additionalData[key];}}}
QSI.util.sendHttpRequest({type:'POST',url:latencyEndpointUrl,header:{'Content-type':'application/x-www-form-urlencoded'},includeCookies:false,data:QSI.util.buildQueryString({LoggingData:JSON.stringify(loggingData)})});}catch(e){QSI.dbg.e(e);}},sampledSend:function(samplingPercentage,metricName,latency,componentLatencies,additionalData){try{if((Math.random()<=samplingPercentage/100)===true){this.send(metricName,latency,componentLatencies,additionalData);}}catch(e){QSI.dbg.e(e);}}};}
QSI.util={creativeTypes:{EMPTY:'Empty',FEEDBACK_LINK:'FeedbackLink',HTTP_REDIRECT:'HTTPRedirect',IFRAME:'IFrame',INFO_BAR:'InfoBar',LINK:'Link',NO_CREATIVE:'NoCreative',POP_OVER:'PopOver',POP_UNDER:'PopUnder',POP_UP:'PopUp',RELAY:'Relay',SLIDER:'Slider',SOCIAL_MEDIA:'SocialMedia',USER_DEFINED_HTML:'UserDefinedHTML'},originalDocumentOverflow:'auto',$:function(n){if(typeof n==='string'){n=document.getElementById(n);}
return n;},setStyle:function(el,s){QSI.util.forOwn(s,function(value,sid){try{el.style[sid]=s[sid];}catch(e){QSI.dbg.e(e);}});},getStyle:function(el,propName){var computed=this.getStyles(el);var ret;try{ret=computed?computed[propName]||computed.getPropertyValue(propName):undefined;}catch(e){ret=undefined;}
return ret===undefined?ret:ret+"";},getStyles:function(el){if(window.getComputedStyle){if(el.ownerDocument.defaultView.opener){return el.ownerDocument.defaultView.getComputedStyle(el,null);}
return window.getComputedStyle(el,null);}else if(document.documentElement.currentStyle){return el.currentStyle;}},prependElement:function(elementToPrepend,targetElement){if(targetElement.firstChild){targetElement.insertBefore(elementToPrepend,targetElement.firstChild);}else{targetElement.appendChild(elementToPrepend);}},getTempID:function(){return'QSI_'+Math.floor((Math.random()*100000)+1);},isValidID:function(id,type){if(id){if(type==='zone'){return(id.substring(0,2)==='ZN');}else if(type==='intercept'){return(id.substring(0,2)==='SI');}}
return false;},getDateNow:function(){if(!Date.now){return new Date().valueOf();}
return Date.now();},getElementHTML:function(el){var wrap=document.createElement('div');wrap.appendChild(el.cloneNode(true));return wrap.innerHTML;},getOriginInterceptOfMessage:function(sourceWindow){if(!QSI.reg){return null;}
for(var interceptID in QSI.reg){if(Object.prototype.hasOwnProperty.call(QSI.reg,interceptID)){var intercept=QSI.reg[interceptID];if(intercept.embeddedTargets){for(var i=0;i<intercept.embeddedTargets.length;i++){if(intercept.embeddedTargets[i].contentWindow===sourceWindow){return QSI.reg[interceptID];}}}
if(intercept.embeddedWindows){for(var j=0;j<intercept.embeddedWindows.length;j++){if(intercept.embeddedWindows[j].targetIframe.contentWindow===sourceWindow){return QSI.reg[interceptID];}}}}}
return null;},tryGetTarget:function(){var reg=QSI.reg;var id=QSI.id;if(!reg||!id){return undefined;}
return reg[id].getTarget();},addToStyleElements:function(element){QSI.styleElements=QSI.styleElements||[];QSI.styleElements.push(element);},buildQueryString:function(obj){var str=[];QSI.util.forOwn(obj,function(value,p){str.push(encodeURIComponent(p)+"="+encodeURIComponent(obj[p]));});return str.join("&");},waitForFocus:function(){var deferred=QSI.util.Deferred();if(document.hasFocus()){deferred.resolve();}else{QSI.util.observe(window,'focus',function(){try{deferred.resolve();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});}
return deferred.promise();},waitForExitIntent:function(){var deferred=QSI.util.Deferred();QSI.util.observe(window,'mouseout',function(e){try{if(!document.hasFocus()||(e.clientY>0)){return;}
deferred.resolve();}catch(ex){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(ex);}}});return deferred.promise();},truncateString:function(str,len){var ellipsis='...';if(str===null||str===undefined){return null;}
if(str.length<=len){return str;}
return str.slice(0,len)+ellipsis;},ScriptLoader:function(baseURL){var that=this;var firstScript=document.getElementsByTagName('script')[0];this.getScriptURL=function(name){return baseURL+name;};this.load=function(scriptName,params){var deferred=loadHelper(scriptName,params,false);if(deferred){return deferred.promise();}else{return null;}};this.loadAndManualResolve=function(scriptName,params){return loadHelper(scriptName,params,true);};var loadHelper=function(scriptName,params,manualResolve){if(scriptName===undefined||scriptName===null){return null;}
var paramString='';if(params){paramString=buildParams(params);}
var deferred=QSI.util.Deferred();var script,src;src=that.getScriptURL(scriptName)+paramString;script=QSI.util.build('script',{src:src,'data-qsimodule':'script'});if(manualResolve!==true){QSI.util.observe(script,'load',function(){try{deferred.resolve();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});QSI.util.observe(script,'readystatechange',function(){try{if(script.readyState==='loaded'||script.readyState==='complete'){deferred.resolve();}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});}
firstScript.parentNode.insertBefore(script,firstScript);return deferred;};var buildParams=function(params){var output=[];QSI.util.forOwn(params,function(value,key){output.push(key+'='+params[key]);});return'?'+output.join('&');};},build:function(type,att,inner){var el=document.createElement(type);if(att){var that=this;QSI.util.forOwn(att,function(value,id){switch(id){case'style':that.setStyle(el,att[id]);break;case'className':el.className=att[id];break;case'id':el.id=att[id];break;default:el.setAttribute(id,att[id]);}});}
if(inner){if(QSI.util.isString(inner)){if(type==='style'&&el.styleSheet){el.styleSheet.cssText=inner;}else{el.appendChild(document.createTextNode(String(inner)));}}else if(QSI.util.isArray(inner)){for(var i=0,ilen=inner.length;i<ilen;i++){var ch=inner[i];if(typeof ch==='string'||typeof ch==='number'){el.appendChild(document.createTextNode(String(ch)));}else if(ch){if(ch.nodeType){el.appendChild(ch);}}}}}
return el;},showTrialIcon:function(){if(this.trialIcon){return;}
var trialLogo=this.build('div',{},[this.build('img',{src:QSI.global.imagePath+"/siteintercept/logo.png"})]);this.trialIcon=trialLogo;QSI.util.setStyle(trialLogo,{opacity:0.5,padding:'20px',bottom:"0",right:"0",position:"fixed"});document.body.appendChild(trialLogo);},createArrayFromArguments:function(iterable){if(!iterable){return[];}
return Array.prototype.slice.call(iterable);},createArrayFromIterable:function(iterable){var length=iterable.length||0,results=new Array(length);while(length--){results[length]=iterable[length];}
return results;},sendHttpRequest:function(requestConfig){var http=new XMLHttpRequest();http.open(requestConfig.type,requestConfig.url,true);if(requestConfig.timeout){http.timeout=requestConfig.timeout;if(requestConfig.timeoutCallback){http.ontimeout=function(){try{requestConfig.timeoutCallback.apply(this,arguments);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};}}
for(var key in requestConfig.header){if(Object.prototype.hasOwnProperty.call(requestConfig.header,key)){http.setRequestHeader(key,requestConfig.header[key]);}}
if(requestConfig.includeCookies){http.withCredentials=true;http.setRequestHeader('Access-Control-Allow-Credentials','true');}
http.onreadystatechange=function(){try{if(4===http.readyState){if(200===http.status){if(requestConfig.successCallback){requestConfig.successCallback(http);}else{return;}}else if(requestConfig.errorCallback){requestConfig.errorCallback(http);return;}}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};http.send(requestConfig.data);},Class:function(){function klass(){try{if(this.initialize){this.initialize.apply(this,arguments);}}catch(e){QSI.dbg.e(e);}}
function addMethods(source){QSI.util.forOwn(source,function(value,propertyName){klass.prototype[propertyName]=source[propertyName];});}
var argumentArray=QSI.util.createArrayFromArguments(arguments);for(var i=0,ilen=argumentArray.length;i<ilen;i++){addMethods(argumentArray[i]);}
return klass;},Creative:function(){var creative=this.Class.apply(this,arguments);creative.prototype.globalInitialize=function(options){this.displayed=QSI.util.Deferred();this.willShow=QSI.util.Deferred();this.cookiesEnabled=QSI.util.Deferred();this.preventRepeatedDisplay=QSI.util.Deferred();this.localStorageEnabled=QSI.util.Deferred();this.options=options||{};this.id=this.options.id;this.type=this.options.type;this.displayOptions=this.options.displayOptions||{};this.displayOptions.displayed=this.displayed.promise();this.interceptDisplayOptions=this.options.interceptDisplayOptions||{};this.actionOptions=this.options.actionOptions||{};var js;if(this.actionOptions.actionSetJavaScriptBeforeDisplay&&this.shouldShow()){js=this.actionOptions.actionSetJavaScriptBeforeDisplay;this.evalJS(js);}
if(this.actionOptions.actionSetJavaScript){var that=this;js=this.actionOptions.actionSetJavaScript;this.displayed.done(function(){that.evalJS(js);});}
if(this.actionOptions.actionSetEvents){QSI.util.processElementEvents(this.actionOptions.actionSetEvents,null,this);}
if(this.getType()!==QSI.util.creativeTypes.POP_UNDER){this.killPopUnder();}};creative.prototype.evalJS=function(js){QSI.dbg.e("Error: JavaScript Evaluation has been disabled. Attempted to execute: '"+js+"'");};creative.prototype.getType=function(){return this.type;};creative.prototype.getTarget=function(ed){var url=this.options.targetURL;var embeddedDataQueryString=QSI.EmbeddedData.getEmbeddedDataAsQueryStringParam(this.id,ed);if(embeddedDataQueryString){embeddedDataQueryString=encodeURIComponent(embeddedDataQueryString);if(QSI.Browser.name==='Internet Explorer'&&QSI.Browser.version<9){embeddedDataQueryString=embeddedDataQueryString.substring(0,2050-url.length);}
url+=("&Q_ED="+embeddedDataQueryString);}
return url;};creative.prototype.getTargetHelper=function(ed){var that=this;return function(){return that.getTarget(ed);};};creative.prototype.resetStyles=function(){if(this.options.resetStyle){var style=QSI.util.build('style',{type:'text/css'});if(style.styleSheet){var head=document.getElementsByTagName('head')[0];head.appendChild(style);style.styleSheet.cssText=this.options.resetStyle;}else{document.body.appendChild(style);var resetText=document.createTextNode(this.options.resetStyle);style.appendChild(resetText);}
QSI.util.addToStyleElements(style);}};creative.prototype.killPopUnder=function(){try{var name='QSIPopUnder_'+this.id;if(QSI.cookie.get(name)){var win=QSI.util.openWin('',name);if(win&&win.w){win.w.popunderDead=true;}
win.close();QSI.cookie.erase(name);}}catch(e){}};creative.prototype.shouldShow=function(){var show=true;if(this.interceptDisplayOptions.hideOnCookiesDisabled){if(QSI.cookie.areCookiesEnabled()){this.cookiesEnabled.resolve();}else{this.cookiesEnabled.reject();show=false;}}
if(this.interceptDisplayOptions.hideOnLocalStorageDisabled){if(QSI.localStorage.isLocalStorageEnabled()){this.localStorageEnabled.resolve();}else{this.localStorageEnabled.reject();show=false;}}
if(this.shouldPreventRepeatedDisplay()){this.preventRepeatedDisplay.resolve();show=false;}else{this.preventRepeatedDisplay.reject();}
if(show){this.willShow.resolve();return true;}else{this.willShow.reject();return false;}};creative.prototype.shouldPreventRepeatedDisplay=function(){var shouldPrevent=false;if(this.interceptDisplayOptions.noshow!=0){try{if(QSI.cookie.get(this.id+'_intercept')!==null){shouldPrevent=true;QSI.cookie.erase(this.id+'_intercept');}else if(QSI.cookie.get('QSI_'+this.id+'_intercept')!==null){shouldPrevent=true;}}catch(e){QSI.dbg.e(e);}}else{QSI.cookie.erase('QSI_'+this.id+'_intercept');}
return shouldPrevent;};creative.prototype.setPreventRepeatedDisplayCookie=function(){if(this.interceptDisplayOptions&&this.interceptDisplayOptions.noshow&&this.interceptDisplayOptions.noshow!=0&&QSI.cookie.get('QSI_'+this.id+'_intercept')===null){try{QSI.cookie.set('QSI_'+this.id+'_intercept',true,this.interceptDisplayOptions.noshow,this.interceptDisplayOptions.cookieDomain,{force:true});}catch(e){QSI.dbg.e(e);}}};creative.prototype.impress=function(){this.impressElement=QSI.util.impress(this.options.impressionURL);try{var time=new Date().getTime()/1000;var intercepts=JSON.parse(QSI.localStorage.get("Q_INTER"));if(intercepts===null){intercepts={};}
intercepts[this.id]=time;QSI.localStorage.set("Q_INTER",JSON.stringify(intercepts));}catch(e){QSI.dbg.e(e);}
this.setPreventRepeatedDisplayCookie();};creative.prototype.cleanupImpressElement=function(){QSI.util.remove(this.impressElement);};if(!creative.prototype.close){creative.prototype.close=function(){this.cleanupImpressElement();};}
if(!creative.prototype.remove){creative.prototype.remove=creative.prototype.close;}
return creative;},isString:function(s){return(typeof(s)==='string');},isArray:function(a){return typeof(a)==='object'&&(a instanceof Array);},isFunction:function(a){return typeof a==='function'||false;},isIE8:function(){return this.isIE(8);},isIE:function(v){if(QSI.Browser.name!=='Internet Explorer'){return false;}
if(!v){return true;}
return v===QSI.Browser.version;},isChrome:function(){return QSI.Browser.name==='Chrome';},isOpera:function(){return QSI.Browser.name==='Opera';},isFF:function(){return QSI.Browser.name==='Firefox';},isAndroid:function(){return QSI.OS.name==='Android';},removePx:function(str){str=str||'';var index=str.indexOf('px');if(index>0){str=str.substr(0,index);}
return str;},getDimensions:function(el){var inDom=true;if(!el.parentNode||!el.parentNode.tagName){document.body.appendChild(el);inDom=false;}
var display=el.style.display||this.getComputedStyle(el).display;if(display!=='none'&&display!==null)
{var dims={width:el.offsetWidth,height:el.offsetHeight};if(!inDom){el.parentNode.removeChild(el);}
return dims;}
var els=el.style;var originalVisibility=els.visibility;var originalPosition=els.position;var originalDisplay=els.display;els.visibility='hidden';els.position='absolute';els.display='block';var originalWidth=el.clientWidth;var originalHeight=el.clientHeight;els.display=originalDisplay;els.position=originalPosition;els.visibility=originalVisibility;if(!inDom){el.parentNode.removeChild(el);}
return{width:originalWidth,height:originalHeight};},convertPercentToPixel:function(size,relativeValue){return Math.round((size/100)*relativeValue);},convertPixelToPercent:function(size,relativeValue){return Math.round((size/relativeValue)*100);},cumulativeOffset:function(elem){var docElem,box={top:0,left:0},doc=elem&&elem.ownerDocument;if(!doc){return;}
docElem=doc.documentElement;if(typeof elem.getBoundingClientRect!=='undefined'){box=elem.getBoundingClientRect();}
return{top:box.top+(window.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(window.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)};},getTimeout:function(time){var deferred=QSI.util.Deferred();time=parseFloat(time)*1000;window.setTimeout(function(){try{deferred.resolve();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},time);return deferred.promise();},getComputedStyle:function(el){return el.currentStyle||window.getComputedStyle(el,null);},getWindowSize:function(win){var w=win||window;var s=this.getPageSize(win);return{width:w.outerWidth||s.width,height:w.outerHeight||s.height};},getPageSize:function(win){win=win||window;var doc=win.document.documentElement||{};return{width:doc.clientWidth||win.innerWidth,height:doc.clientHeight||win.innerHeight};},getBrowserViewHeight:function(customizeWindow){var win=customizeWindow||window;var doc=win.document.documentElement;if(QSI.Browser.name==='Chrome'&&QSI.Browser.isMobile&&QSI.OS.name==="Android"){return win.outerHeight;}
if(QSI.Browser.isMobile&&doc.clientWidth/win.innerWidth>1){return doc.clientHeight;}
return win.innerHeight;},getScrollOffsets:function(){var win=window,docEl=win.document.documentElement,pageY='pageYOffset',pageX='pageXOffset',left=(pageX in win)?win[pageX]:docEl.scrollLeft,top=(pageY in win)?win[pageY]:docEl.scrollTop;return{left:left,top:top};},startScrolling:function(){if(QSI.Browser.name==='Internet Explorer'&&QSI.Browser.version<8){var htmlEl=document.getElementsByTagName('html')[0];QSI.util.setStyle(htmlEl,{overflow:this.originalDocumentOverflow});}else{QSI.util.setStyle(document.body,{overflow:this.originalDocumentOverflow});}
document.ontouchmove=QSI.touchScrollEvent;QSI.touchScrollEvent=null;},stopScrolling:function(){if(QSI.Browser.name==='Internet Explorer'&&QSI.Browser.version<8){var htmlEl=document.getElementsByTagName('html')[0];this.originalDocumentOverflow=this.originalDocumentOverflow||this.getStyle(htmlEl,'overflow');QSI.util.setStyle(htmlEl,{overflow:'hidden'});}else{this.originalDocumentOverflow=this.originalDocumentOverflow||this.getStyle(document.body,'overflow');QSI.util.setStyle(document.body,{overflow:'hidden'});}
if(document.ontouchmove){QSI.touchScrollEvent=document.ontouchmove;}
document.ontouchmove=function(event){event.preventDefault();};},hasVerticalScrollbar:function(){var doc=document.documentElement;if(QSI.Browser.name==='Internet Explorer'&&QSI.Browser.version<8){return true;}else if(QSI.Browser.name==='Internet Explorer'&&QSI.Browser.version<9){var dif=doc.offsetWidth-doc.scrollWidth;return dif>6;}else{return doc.clientWidth<window.innerWidth;}},hasHorizontalScrollbar:function(){var doc=document.documentElement;if(QSI.Browser.name==='Internet Explorer'&&QSI.Browser.version<8){return true;}else if(QSI.Browser.name==='Internet Explorer'&&QSI.Browser.version<9){var dif=doc.offsetHeight-doc.scrollHeight;return dif>6;}else{return doc.clientHeight<window.innerHeight;}},pageMode:function(){return(document.compatMode==='CSS1Compat')?'Standards':'Quirks';},isFixed:function(){return!(QSI.Browser.name==='Internet Explorer'&&this.pageMode()!=='Standards');},openWin:function(url,name,options){var features=[];options=options||{};QSI.util.forOwn(options,function(value,option){features.push(option+'='+options[option]);});features=features.join(',');return window.open(url,name,features);},impress:function(url){var i;if(url){i=QSI.util.build('img',{src:url+'&r='+(new Date()).getTime(),style:{display:'none'},alt:''});document.body.appendChild(i);}
return i;},getQueryParam:function(url,key){key=key.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&]"+key+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(url);if(results===null){return"";}else{return results[1];}},capFirst:function(str){return str.charAt(0).toUpperCase()+str.slice(1);},observe:function(el,e,f,preventRemove){this.obs=this.obs||[];if(el){this.obs.push({el:el,e:e,f:f,preventRemove:preventRemove||false});if(el.addEventListener){el.addEventListener(e,f,false);}else if(el.attachEvent){el.attachEvent("on"+e,f);}else if(el['on'+this.capFirst(e)]){el['on'+this.capFirst(e)]=f;}}},stopObserving:function(el,e,f){if(el.removeEventListener){el.removeEventListener(e,f,false);}else if(el.detachEvent){el.detachEvent("on"+e,f);}else if(el['on'+this.capFirst(e)]){el['on'+this.capFirst(e)]=null;}},removeObservers:function(){var that=this;this.each(this.obs||[],function(ob){if(!ob.preventRemove){that.stopObserving(ob.el,ob.e,ob.f);}});},hasReachedScrollPosition:function(percentage){var scrollHeight=this.getScrollOffsets().top;var pageHeight=this.getPageSize().height;var bodyHeight=document.body.scrollHeight;var eventHeight=bodyHeight*(percentage/100);if(scrollHeight+pageHeight>=eventHeight){return true;}
return false;},remove:function(el){if(el&&el.parentNode){el.parentNode.removeChild(el);}},removeAllByQuery:function(containingElement,query){var elements=containingElement.querySelectorAll(query);Array.prototype.forEach.call(elements,function(node){QSI.util.remove(node);});},buildWidget:function(type,options){var builder='build'+type+'Widget';if(this[builder]){return this[builder](options);}
return'';},buildCCDWidget:function(options){options=options||{};if(options.close&&parseInt(options.close,10)>0){var time=options.close;var timerID=this.getTempID();var timer=this.build('span',{id:timerID},time+"");var widget=this.build('span',{},[timer]);var that=this;var startTimer=function(){var tick=function(){try{if(time<=0){return;}
var timer=that.$(timerID);if(timer){timer.textContent=--time+"";}
setTimeout(tick,1000);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};if(options.delay&&options.delay>0){setTimeout(function(){try{setTimeout(tick,1000);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},options.delay*1000);}else{setTimeout(tick,1000);}};if(options.displayed){options.displayed.done(function(){startTimer();});}else{startTimer();}
return this.getElementHTML(widget);}
return'';},positionFixed:function(el,posFromTop,posFromBottom){el.style.position="absolute";var lastPosition=0;var pageHeight=this.getPageSize().height;var bodyHeight=document.body.scrollHeight;var scrollTop=QSI.util.getScrollOffsets().top;var timer;if(scrollTop>0){if(posFromBottom==='auto'){el.style.top=(scrollTop+parseInt(posFromTop,10))+"px";el.style.bottom=posFromBottom;}else if(posFromTop==='auto'){el.style.bottom=((scrollTop+pageHeight)-parseInt(posFromTop,10))+'px';el.style.top=posFromTop;}}
if(typeof(posFromTop)==='string'&&posFromTop.indexOf('px')>-1){posFromTop=parseInt(posFromTop,10);}
if(typeof(posFromBottom)==='string'&&posFromBottom.indexOf('px')>-1){posFromBottom=parseInt(posFromBottom,10);}
var scrollToPosition=function(){try{clearTimeout(timer);timer=setTimeout(function(){try{var scrollTop=QSI.util.getScrollOffsets().top;if(scrollTop<0||(scrollTop+pageHeight)>bodyHeight){return;}
var targetPos=scrollTop+posFromTop;var diff=targetPos-lastPosition;var direction=(diff>=0)?20:-20;if(Math.abs(diff)<10){direction=diff;}
var interval;lastPosition=targetPos;if(posFromBottom==='auto'){interval=setInterval(function(){try{var newTop=parseInt(el.style.top,10)+direction;el.style.top=newTop+"px";el.style.bottom=posFromBottom;if(direction>0){if(newTop>=targetPos){clearInterval(interval);QSI.util.observe(window,'scroll',scrollToPosition);}}else{if(newTop<=targetPos){clearInterval(interval);QSI.util.observe(window,'scroll',scrollToPosition);}}
QSI.util.observe(window,'scroll',scrollToPosition);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},15);}else if(posFromTop==='auto'){interval=setInterval(function(){try{var newBottom=parseInt(el.style.bottom,10)+direction;el.style.bottom=((scrollTop+pageHeight)-posFromBottom)+'px';el.style.top=posFromTop;el.style.bottom=newBottom+"px";if(direction>0){if(newBottom>=targetPos){clearInterval(interval);QSI.util.observe(window,'scroll',scrollToPosition);}}else{if(newBottom<=targetPos){clearInterval(interval);QSI.util.observe(window,'scroll',scrollToPosition);}}
QSI.util.observe(window,'scroll',scrollToPosition);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},15);}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},60);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};QSI.util.observe(window,'scroll',scrollToPosition);},each:function(array,callback){var length=array.length;if(length){for(var i=0;i<length;i++){callback(array[i],i);}}},forOwn:function(obj,callback){if(obj&&obj instanceof Object&&this.isFunction(callback)){for(var index in obj){if(Object.prototype.hasOwnProperty.call(obj,index)){callback(obj[index],index,obj);}}}},isObjectEmpty:function(obj){for(var prop in obj){if(Object.prototype.hasOwnProperty.call(obj,prop)){return false;}}
return true;},filter:function(array,callback){try{if(array.filter&&this.isFunction(array.filter)){return array.filter(callback);}}catch(e){}
var length=array.length,output=[];if(length){for(var i=0;i<length;i++){if(callback(array[i])){output.push(array[i]);}}}
return output;},Deferred:function(){var deferred={},state='pending',resolvedArgs=[],rejectedArgs=[],resolveCallbacks=[],rejectCallbacks=[];var promise={state:function(){return state;},then:function(doneCallback,failCallback){this.done(doneCallback).fail(failCallback);return this;},done:function(callback){if(state==='pending'){resolveCallbacks.push(callback);}else if(state==='resolved'){try{callback.apply(this,resolvedArgs);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}}
return this;},fail:function(callback){if(state==='pending'){rejectCallbacks.push(callback);}else if(state==='rejected'){try{callback.apply(this,rejectedArgs);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}}
return this;},promise:function(){return promise;}};QSI.util.forOwn(promise,function(value,funcName){deferred[funcName]=promise[funcName];});deferred.resolve=function(){if(state==='pending'){state='resolved';var args=QSI.util.createArrayFromArguments(arguments);resolvedArgs=args;var that=this;QSI.util.each(resolveCallbacks,function(callback){try{callback.apply(that,args);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});}};deferred.reject=function(){if(state==='pending'){state='rejected';var args=QSI.util.createArrayFromArguments(arguments);rejectedArgs=args;var that=this;QSI.util.each(rejectCallbacks,function(callback){try{callback.apply(that,args);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});}};return deferred;},when:function(childDeferred){var deferreds=QSI.util.createArrayFromArguments(arguments),length=deferreds.length,remaining=length,deferred=remaining===1?childDeferred:QSI.util.Deferred(),update=function(i,values){return function(value){values[i]=arguments.length>1?value:QSI.util.createArrayFromArguments(arguments);if(!(--remaining)){deferred.resolve(values);}};};if(length>1){for(var i=0;i<length;i++){if(deferreds[i]&&deferreds[i].promise){deferreds[i].promise()
.done(update(i,deferreds))
.fail(deferred.reject);}else{remaining--;}}}
if(remaining<1){deferred.resolve(deferreds);}
return deferred.promise();},moveToBackground:function(){if(QSI.Browser.name==='Firefox'||(QSI.Browser.name==='Internet Explorer')&&QSI.Browser.version>=11){window.open("javascript:window.focus();","_self","");}},handleMailTo:function(url,siid,asid,cid){this.addClickImg(siid,asid,cid,function(){try{window.location.href=url;}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});},addClickImg:function(siid,asid,cid,callBack){var d=new Date();var src=QSI.baseURL+'?Q_Click=1&Q_CID='+cid+'&Q_SIID='+siid+'&Q_ASID='+asid+'&T='+d.getTime()+'&Q_LOC='+encodeURIComponent(window.location.href);this.addImage(src,callBack);},addImage:function(src,callBack){var clickImg=QSI.util.build('img',{src:src,alt:''});if(QSI.util.isIE()){QSI.util.setStyle(clickImg,{'display':'none'});}
if(callBack){QSI.util.observe(clickImg,'load',callBack);}
document.body.appendChild(clickImg);},processLocators:function(elements,options){for(var i=0,ilen=elements.length;i<ilen;i++){var element=elements[i];if(element.locators){QSI.PipedText.setLocators(element.locators);element.content=QSI.PipedText.evaluateLocators(element.content,options);}}},getDocDimension:function(name){var doc=document;var docEl=doc.documentElement;return Math.max(doc.body["scroll"+name],docEl["scroll"+name],doc.body["offset"+name],docEl["offset"+name],docEl["client"+name]);},getDocWidth:function(){return this.getDocDimension('Width');},getDocHeight:function(){return this.getDocDimension('Height');},getScroll:function(){var offsets=this.getScrollOffsets();return{width:this.getDocWidth(),height:this.getDocHeight(),left:offsets.left,top:offsets.top};},fireGoogleEventBeacon:function(accountNumber,eventCategory,eventAction){if(accountNumber.search(/^UA-\d+-\d{1,2}$/)<0){QSI.dbg.c('Google Anylytics Account number is incorrect '+accountNumber);return;}
if(window.GoogleAnalyticsObject){this.googleEventAnyalytics(window.GoogleAnalyticsObject,accountNumber,eventCategory,eventAction);}else{this.googleEventGA(accountNumber,eventCategory,eventAction);}},googleEventGA:function(accountNumber,category,action){var tempTracker='SITracker'+this.getTempID();var _gaq=window._gaq||[];_gaq.push([tempTracker+'._setAccount',accountNumber]);_gaq.push([tempTracker+'._trackEvent',category,action]);},googleEventAnyalytics:function(GAObj,accountNumber,category,action){var tempTracker='SITracker'+this.getTempID();window[GAObj]('create',accountNumber,{'name':tempTracker});window[GAObj](tempTracker+'.send','event',category,action);},evalJS:function(stringToEval){return function(){QSI.dbg.e("Error: JavaScript Evaluation has been disabled. Attempted to execute: '"+stringToEval+"'");};},processElementEvents:function(events,el,creative){if(!events||events.length<=0||events[0].length<=0){return;}
var actions=new QSI.ActionModule(creative);var objsToProcess=events[0];for(var i=0,ilen=objsToProcess.length;i<ilen;i++){actions.add(objsToProcess[i]);}
actions.addToElement(el);},clickOnKeyDown:function(e){try{if(e.which===32||e.which===13){e.target.click();}}catch(ex){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(ex);}}},stableSort:function(array,cmp){cmp=Boolean(cmp)?cmp:function(a,b){if(a<b){return-1;}
if(a>b){return 1;}
return 0;};var stabilizedThis=array.map(function(el,index){return[el,index];});var stableCmp=function(a,b){var order=cmp(a[0],b[0]);if(order!==0){return order;}
return a[1]-b[1];};stabilizedThis.sort(stableCmp);for(var i=0;i<array.length;i++){array[i]=stabilizedThis[i][0];}
return array;},isLegacyCreative:function(creativeType){if(creativeType){var legacy_creatives=['PopOver','Slider','InfoBar','UserDefinedHTML','PopUnder','FeedbackLink','Link','HTTPRedirect','PopUp','Relay','SocialMedia'];if(legacy_creatives.indexOf(creativeType)!==-1){return true;}}
return false;}};QSI.Target=QSI.util.Class({initialize:function(el,getURL,actionOptions,parent){this.el=el;this.options=actionOptions;this.urlCallback=getURL;this.deferred=QSI.util.Deferred();this.parent=parent;this.init();},init:function(){var that=this;QSI.util.observe(this.el,'click',function(){try{if(that.urlCallback){that.openTarget();that.deferred.resolve();}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});},openTarget:function(){var url=this.urlCallback();var options=this.options;if(!url||url.indexOf('&')===0){return;}
if(options.targetReplaceContents&&this.parent.getType()!==QSI.util.creativeTypes.USER_DEFINED_HTML){options.targetNewWindow=true;options.targetReplaceContents=false;}
if(options.targetEmbedded&&!QSI.util.isLegacyCreative(this.parent.options.type)){options.targetEmbedded=false;options.targetNewTab=true;}
if(options.targetNewWindow){try{var size=QSI.util.getPageSize();var width=options.targetFullScreen?screen.availWidth||screen.width||size.width:options.targetWidth;var height=options.targetFullScreen?screen.availHeight||screen.height||size.height:options.targetHeight;var onloadtime=new Date();var stringDate=onloadtime.valueOf().toString();var targetWindowName='targetwindow_'+stringDate;var win=QSI.util.openWin(url,targetWindowName,{status:'yes',scrollbars:'yes',resizable:'yes',width:width,height:height});if(typeof this.parent!=='undefined'&&this.parent!==null){var targetURLOrigin;if(typeof this.parent.options!=='undefined'&&this.parent.options!==null){targetURLOrigin=this.parent.options.targetURLOrigin;}
QSI.windowHandler.addOptInIDAndWindowName(this.parent.id,targetWindowName,targetURLOrigin||'*');QSI.windowHandler.addWindowHandle(targetWindowName,win);}
var f=function(){if(!window.opener||!window.opener.sessionStorage){return;}
var openerSS=window.opener.sessionStorage;var optInIDsAndNames=openerSS.getItem('QSI_OptInIDsAndWindowNames');if(!optInIDsAndNames){return;}
try{optInIDsAndNames=JSON.parse(optInIDsAndNames);}catch(error){QSI.dbg.e(error);return;}
for(var id in optInIDsAndNames){if(optInIDsAndNames[id]===window.name){delete optInIDsAndNames[id];}}
openerSS.setItem('QSI_OptInIDsAndWindowNames',JSON.stringify(optInIDsAndNames));};if(win){win.onunload=f;win.onbeforeunload=f;}}catch(e){QSI.dbg.e(e);}}else if(options.targetEmbedded){new QSI.EmbeddedTarget(url,options,this.parent);}else if(options.targetPopUnder){new QSI.PopUnderTarget(url,options,this.parent);}else if(options.targetReplaceContents){this.handleReplaceCreative();}else if(options.targetNewTab){QSI.util.openWin(url,"_blank");}else{window.location=url;}},handleReplaceCreative:function(){var width,height;var oldContents=this.parent.node;if(this.options.sameSizeAsCreative){width=this.parent.options.size.width;height=this.parent.options.size.height;}else{width=this.options.targetWidth;height=this.options.targetHeight;}
var iframeStyle={width:width+'px',height:height+'px',display:'block',border:'none',outline:'none',zIndex:2000000000};var initialIframeAttributes={src:this.urlCallback()};if(!QSI.util.isIE(9)){initialIframeAttributes.sandbox='allow-scripts allow-same-origin allow-popups';}
var iframe=QSI.util.build('iframe',initialIframeAttributes);QSI.util.setStyle(iframe,iframeStyle);this.parent.node=iframe;this.parent.options.size={width:width,height:height};oldContents.parentNode.replaceChild(iframe,oldContents);if(this.parent.displayOptions.customPosition){this.parent.position();}},complete:function(){return this.deferred.promise();}});QSI.ActionModule=QSI.util.Class({initialize:function(creative){this.creative=creative;this.actions={click:[],mouseout:[],mouseover:[],displayed:[]};},add:function(action){if(this.actions[action.triggeringEvent]){this.actions[action.triggeringEvent].push(this.buildAction(action));}},buildAction:function(action){var that=this;return{run:function(){if(that['run'+action.actionType+'Action']){that['run'+action.actionType+'Action'](action);}}};},runAddCookieAction:function(action){QSI.cookie.set(action.cookieName,action.cookieValue,this.creative.interceptDisplayOptions.cookieDomain);},runRemoveCookieAction:function(action){QSI.cookie.erase(action.cookieName,this.creative.interceptDisplayOptions.cookieDomain);},runGoogleEventAction:function(action){QSI.util.fireGoogleEventBeacon(action.accountNumber,action.actionCategory,action.actionName);},runJavaScriptAction:function(action){QSI.util.evalJS(action.javaScriptString)();},addToElement:function(el){var that=this;var runActions=function(actions){var ran=false;return function(){try{if(!ran){ran=true;that.runAction(actions);}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};};QSI.util.forOwn(this.actions,function(value,type){if(that.actions[type].length){if(type==='displayed'){that.creative.displayed.done(runActions(that.actions[type]));}else{QSI.util.observe(el,type,runActions(that.actions[type]));}}});},runAction:function(actions){for(var i=0;i<actions.length;i++){actions[i].run();}}});var SIMessage=function(type,payload){this.type=type;this.payload=payload;};var setEDinPlaceholderWindow=function(ed,winName){if(typeof ed!=='string'||typeof winName!=='string'){return;}
var popunderWin=QSI.windowHandler.getWin(winName);if(!popunderWin){return;}
var sim=new SIMessage('setEDinPlaceholderWindow',ed);var stringMessage=JSON.stringify(sim);var placeholderOrigin=QSI.windowHandler.getWindowOrigin(window);popunderWin.postMessage(stringMessage,placeholderOrigin);};var setEmbeddedData=function(key,value,winName,targetOrigin){if(typeof key==='undefined'||typeof value==='undefined'||typeof winName!=='string'||typeof targetOrigin!=='string'){return;}
var popunderWin=QSI.windowHandler.getWin(winName);if(!popunderWin){return;}
var message={'key':key,'value':value};var sim=new SIMessage('setEmbeddedData',message);var stringMessage=JSON.stringify(sim);if(/targetwindow/.test(winName)){popunderWin.postMessage(stringMessage,targetOrigin);}else{try{var surveyIFrame=popunderWin.document.getElementById('PopUnderTargetFrame');if(surveyIFrame&&surveyIFrame.contentWindow){var iFrameWindow=surveyIFrame.contentWindow;iFrameWindow.postMessage(stringMessage,targetOrigin);}}catch(e){}}};var QSI_updatePopunderEDCallback=function(){try{QSI.windowHandler.removeClosedWindowHandles();var optInIDsAndNames=QSI.windowHandler.getOptInIDsAndWindowNames()||{};var optInIDsAndOrigins=QSI.windowHandler.getOptInIDsAndTargetOrigins()||{};for(var id in optInIDsAndNames){if(Object.prototype.hasOwnProperty.call(optInIDsAndNames,id)){var winName=optInIDsAndNames[id];var targetOrigin=optInIDsAndOrigins[id]||'*';var ed=QSI.EmbeddedData.getEmbeddedData(id);var edAsQueryParam=QSI.util.buildQueryString(ed);if(edAsQueryParam.length>0){edAsQueryParam='&'+edAsQueryParam;}
if(!ed||QSI.util.isObjectEmpty(ed)){continue;}
if(/placeholderWindow/.test(winName)){setEDinPlaceholderWindow(edAsQueryParam,winName,targetOrigin);return;}
for(var key in ed){if(Object.prototype.hasOwnProperty.call(ed,key)){setEmbeddedData(key,ed[key],winName,targetOrigin);}}}}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};if(!QSI.util.isIE()){QSI.util.observe(window,'unload',QSI_updatePopunderEDCallback,true);try{QSI.windowHandler.setupWindowHandles();}catch(e){QSI.dbg.e(e);}}
if(!QSI.EmbeddedData||window.QTest){QSI.EmbeddedData={getHTMLFromDOM:function(id){var el=QSI.util.$(id);var val='';if(el){switch(el.tagName){case'TEXTAREA':case'INPUT':val=el.value;break;default:val=el.innerHTML;break;}}
return val;},getCookieVal:function(name){var val='';var cookie=QSI.cookie.get(name);if(cookie){val=cookie;}
return val;},getURLParameter:function(name){return QSI.util.getQueryParam(window.location.href,name);},getURLRegexMatch:function(regex){var regexmatch=/^\/(.*)\/([gim]*)/;var matchArray=regex.match(regexmatch);if(matchArray&&matchArray[1]){matchArray=window.location.href.match(new RegExp(matchArray[1],matchArray[2]));}else{matchArray=window.location.href.match(new RegExp(regex));}
if(matchArray&&matchArray[1]){return matchArray[1];}else{return'';}},getJavaScriptValue:function(varName){var qsi_val='';QSI.dbg.e("Error: JavaScript Evaluation has been disabled. Attempted to execute: '"+varName+"'");return qsi_val;},getHistory:function(){return QSI.history.get();},getTimeOnSite:function(){return QSI.history.getTimeOnSite();},getCurrentPage:function(){return window.location;},getReferer:function(){return QSI.history.getPageReferrer();},getSiteReferer:function(){return QSI.history.getSiteReferrer();},getSearchTerm:function(){return QSI.history.getSearch();},getPageCount:function(){var count=QSI.history.getPageCount();return count.unique;},getTotalPageCount:function(){var count=QSI.history.getPageCount();return count.total;},getPercentagePageViewed:function(){var count=QSI.history.getPageCount();return count.unique;},getSiteInterceptID:function(){return this.siid;},getCreativeID:function(){if(QSI.global.intercepts[this.siid]&&QSI.global.intercepts[this.siid].CreativeID){return QSI.global.intercepts[this.siid].CreativeID;}},getEventTrackingData:function(name){return QSI.EventTracker.get(name);},getSiteCatalystValue:function(varName){var parts=varName.split('.');var lowercaseFirstLetter=function(str){return str.charAt(0).toLowerCase()+str.slice(1);};var splitAdobeVar=QSI.adobeVar.split('.');var obj=window;for(var index=0;index<splitAdobeVar.length;index++){obj=obj[splitAdobeVar[index]];}
for(var i=0,ilen=parts.length;i<ilen;i++){if(obj){var lowercaseProp=lowercaseFirstLetter(parts[i]);obj=obj[lowercaseProp]||obj[parts[i]];}}
if(obj){return obj;}
return null;},getEmbeddedData:function(siid,ed){ed=ed||[];if(QSI.ed[siid]){ed=ed.concat(QSI.ed[siid]);}
this.siid=siid;return this.generateDynamicEmbeddedData(ed);},getEmbeddedDataAsQueryStringParam:function(siid,ed){var embeddedData=this.getEmbeddedData(siid,ed);if(Object.keys(embeddedData).length===0){return'';}else{return'&'+QSI.util.buildQueryString(embeddedData);}},generateDynamicEmbeddedData:function(ed){QSI.dbg.log('SI-4479 generateDynamicEmbeddedData start of function.  QSI.ed: '+JSON.stringify(QSI.ed)+'  ed: '+JSON.stringify(ed));var embeddedData={};if(typeof ed==="string"){ed=ed.split("");}
for(var i=0,ilen=ed.length;i<ilen;i++){try{var set=ed[i];if(set.type&&set.name){var resolvedVal='';switch(set.type){case'StaticVal':resolvedVal=set.value;break;case'HTML':resolvedVal=this.getHTMLFromDOM(set.value);break;case'Cookie':resolvedVal=this.getCookieVal(set.value);break;case'QueryParam':resolvedVal=this.getURLParameter(set.value);break;case'URLRegex':resolvedVal=this.getURLRegexMatch(set.value);break;case'JavaScriptVal':resolvedVal=this.getJavaScriptValue(set.value);break;case'SiteCatalyst':resolvedVal=this.getSiteCatalystValue(set.value);break;case'EventTracking':resolvedVal=this.getEventTrackingData(set.value);break;default:if(this['get'+set.type]){resolvedVal=this['get'+set.type](set.value);}else if(set.value.indexOf('JSON.stringify')===0&&set.value.indexOf('marketingCloudVisitorID')!==-1){QSI.dbg.log('SI-4479 generateDynamicEmbeddedData Attempting default case getJavaScriptValue fix. QSI.ed: '+JSON.stringify(QSI.ed)+'  set: '+JSON.stringify(set));resolvedVal=this.getJavaScriptValue(set.value);}else{QSI.dbg.log('SI-4479 generateDynamicEmbeddedData Final else case in default QSI.ed: '+JSON.stringify(QSI.ed)+'  set: '+JSON.stringify(set));resolvedVal=set.value;}
break;}
resolvedVal=String(resolvedVal);embeddedData[set.name]=resolvedVal;}}catch(e){QSI.dbg.e(e);}}
return embeddedData;}};}
if(!QSI.history||window.QTest){QSI.historyStorage={historySessionName:'QSI_HistorySession',get useCookie(){return(QSI.historyStorageType!=='sessionStorage')?true:false;},get limit(){return this.useCookie?2000:10000;},getHistorySessionData:function(){if(this.useCookie){return QSI.cookie.get(this.historySessionName);}
return sessionStorage.getItem(this.historySessionName);},eraseHistorySessionData:function(){if(this.useCookie){QSI.cookie.erase(this.historySessionName);return;}
sessionStorage.removeItem(this.historySessionName);},setHistorySessionData:function(data){if(this.useCookie){QSI.cookie.set(this.historySessionName,data,0);return;}
sessionStorage.setItem(this.historySessionName,data);},};QSI.history={historyStorage:QSI.historyStorage,logVisit:function(){this.logCurrentURL();this.logSearch();this.startFocusTracking();this.logReferrer();},startFocusTracking:function(){if(this.started){return;}
try{this.started=true;this.focusTime=this.getFocusTimeFromBrowserStorage();this.blurTime=this.getBlurTimeFromBrowserStorage();var interval=1;var that=this;setInterval(function(){try{if(that.focused){that.focusTime+=interval;}else{that.blurTime+=interval;}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},interval*1000);var focus=function(){try{that.focused=true;}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};var blur=function(){try{that.focused=false;}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};focus();QSI.util.observe(window,'focus',focus);QSI.util.observe(window,'blur',blur);var unloadEventName;if(QSI.Browser.isMobile){unloadEventName='pagehide';}else{unloadEventName='unload';}
QSI.util.observe(window,unloadEventName,function(){try{QSI.profile.set('History','BlurTime',that.blurTime);QSI.profile.set('History','FocusTime',that.focusTime);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});}catch(e){QSI.dbg.e(e);}},logSite:function(url,openTime){var hist=this.historyStorage.getHistorySessionData();var lastURL;if(hist){hist=decodeURIComponent(hist);var histArray=hist.split('|');var last=histArray[histArray.length-1];lastURL=last.split('~')[0];hist+='|';}else{hist='';lastURL='';}
if(url!==lastURL){var newEntry=url+'~'+openTime;hist+=newEntry;this.writeHistory(hist);}},writeHistory:function(val,sizeLimit){if((sizeLimit!==null&&sizeLimit!==undefined)&&sizeLimit<=0){this.historyStorage.eraseHistorySessionData();return;}
sizeLimit=sizeLimit||QSI.historyStorageSize||QSI.global.maxCookieSize||this.historyStorage.limit;var encodedVal=encodeURIComponent(val);var shortenedEncodedVal=this.limitSize(encodedVal,sizeLimit);try{this.historyStorage.setHistorySessionData(shortenedEncodedVal);}catch(e){val=decodeURIComponent(shortenedEncodedVal);this.writeHistory(val,(sizeLimit-500));}
},limitSize:function(val,limit){if(!val.length){return val;}
limit=limit||this.historyStorage.limit;while(val.length>limit){var decoded=decodeURIComponent(val);var histArray=decoded.split('|');histArray.splice(0,1);val=histArray.join('|');val=encodeURIComponent(val);}
return val;},get:function(){var history=this.historyStorage.getHistorySessionData();var hist=history;if(!hist){hist=[];}
hist=this.limitSize(hist);return decodeURIComponent(hist);},logCurrentURL:function(){var url=window.location.href;var currentTime=new Date()*1;this.logSite(url,currentTime);},getReferrer:function(){return document.referrer;},logSearch:function(){var searchRegex,result;var referrer=this.getReferrer();if(referrer.search(/(google.com)|(bing.com)|(yahoo.com)/)>=0){var search='';if(referrer.search(/(google.com)|(bing.com)/)>=0){searchRegex=/q=(.*?)\&/;result=referrer.match(searchRegex);if(result&&result.length&&result[1]){search=result[1];}}else if(referrer.search(/yahoo.com/)>=0){searchRegex=/p=(.*?)\&/;result=referrer.match(searchRegex);if(result&&result.length&&result[1]){search=result[1];}}
search=unescape(search);QSI.profile.set('History','SearchTerm',search);}},logReferrer:function(){var referrer=this.getReferrer();if(referrer){var a=QSI.util.build('a',{href:referrer});if(a.hostname!==document.location.host){QSI.profile.set("History","SiteReferrer",referrer);}
QSI.profile.set("History","PageReferrer",referrer);}},logIntercept:function(siid,asid){if(asid){this.logActionSet(asid);}},logActionSet:function(asid){if(asid.search('AS_')>=0){var key=asid;var currentTime=new Date()*1;QSI.profile.set('ActionSetHistory',key,currentTime);QSI.profile.set('ActionSetHistory',key,currentTime,1);}},logSurvey:function(sid,ssid){QSI.profile.set('QualtricsSurveyHistory',sid,ssid,1);},getSiteReferrer:function(){return QSI.profile.get("History",'SiteReferrer');},getPageReferrer:function(){return QSI.profile.get('History','PageReferrer');},getSearch:function(){var search=QSI.profile.get('History','SearchTerm');if(!search){search='';}
return search;},getTimeOnSite:function(){var f=this.focusTime;var b=this.blurTime;return f+b+'|'+f;},getFocusTimeFromBrowserStorage:function(){var time=QSI.profile.get('History','FocusTime');if(!time){time=0;}
return time;},getBlurTimeFromBrowserStorage:function(){var time=QSI.profile.get('History','BlurTime');if(!time){time=0;}
return time;},getActionSetHistory:function(asid,permanent){var ts=QSI.profile.get('ActionSetHistory',asid,permanent);if(!ts){ts=0;}
return ts;},getPageCount:function(){var hist=this.historyStorage.getHistorySessionData();var pageCount=0;var pages=[];var i,ilen;if(hist){hist=decodeURIComponent(hist);var histArray=hist.split("|");ilen=histArray.length;for(i=0;i<ilen;i++){pages.push(histArray[i].split("~")[0]);}
var uniquePages={};ilen=pages.length;for(i=0;i<ilen;i++){if(!uniquePages[pages[i]]){pageCount++;uniquePages[pages[i]]=true;}}}
return{unique:pageCount,total:pages.length};}};}
if(!QSI.profile){QSI.profile={namespace:"QSI_",set:function(category,name,value,permanent){if(category===undefined||name===undefined||value===undefined){throw new Error('To few arguments');}
try{var storage=this.getStorage(permanent),key=this.namespace+category,data=storage.getItem(key);data=(data)?JSON.parse(data):{};data[name]=value;data=JSON.stringify(data);storage.setItem(key,data);}catch(e){QSI.dbg.e('error setting profile item');QSI.dbg.e(e);}},get:function(category,name,permanent){var storage=this.getStorage(permanent),key=this.namespace+category,data=storage.getItem(key);if(data){data=JSON.parse(data);if(name){return(data[name])?data[name]:null;}
return data;}
return null;},erase:function(category,name,permanent){var storage=this.getStorage(permanent),key=this.namespace+category;if(!name){storage.removeItem(key);}else{var data=JSON.parse(storage.getItem(key));delete data[name];data=JSON.stringify(data);storage.setItem(key,data);}},getStorage:function(perm){if(this.hasSessionStorage()){if(perm){return localStorage;}else{return sessionStorage;}}else if(QSI.UserDataStorage){var userdata=QSI.UserDataStorage;if(perm){userdata.isPermanent(true);}else{userdata.isPermanent(false);}
return userdata;}else{return QSI.CookieStorage;}},hasSessionStorage:function(){var testKey='qualtricssessionstoragetestkey',storage=window.sessionStorage;try{storage.setItem(testKey,testKey);storage.removeItem(testKey);return true;}catch(e){return false;}}};}
if(!QSI.EventTracker||window.QTest){QSI.EventTracker={counts:{},cookieName:'QSI_CT',clicked:false,loaded:false,trackElements:function(){if(this.loaded===false){this.loadCounts();this.loaded=true;}
var trackers=QSI.global.eventTrackers;var that=this;QSI.util.forOwn(trackers,function(value,name){var id=trackers[name];that.trackElement(id,name);});QSI.util.observe(window,'beforeunload',function(){try{that.storeCounts();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});},trackElement:function(id,name){var el=QSI.util.$(id);if(el){var that=this;QSI.util.observe(el,'click',function(){try{that.track(name);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});}},track:function(name){this.clicked=true;if(this.counts[name]){this.counts[name]++;}else{this.counts[name]=1;}},storeCounts:function(){if(this.clicked===true){var output=JSON.stringify(this.counts);QSI.cookie.set(this.cookieName,output);}},loadCounts:function(){var input=QSI.cookie.get(this.cookieName);if(input){this.counts=JSON.parse(input);}},get:function(name){if(this.counts[name]){return this.counts[name];}
return 0;},incrementEventList:function(){if('_qsie'in window){if(QSI.util.isArray(window._qsie)){for(var i=0,ilen=window._qsie.length;i<ilen;i++){var name=window._qsie[i];if(QSI.util.isString(name)){this.track(name);}}}}}};}
QSI.localStorage={isLocalStorageEnabled:function(){try{var localStorageKey='qsi_test_local_storage';localStorage.setItem(localStorageKey,'local_storage_test_value');localStorage.removeItem(localStorageKey);return true;}catch(e){return false;}},set:function(name,value){localStorage.setItem(name,value);},get:function(name){return localStorage.getItem(name);}};QSI.cookie={set:function(name,value,daysToExpire,domain,options){options=options||{};var currentSize=this.getCookieSize();var curVal=this.get(name);var maxSize=QSI.global.maxCookieSize;if(curVal){currentSize-=(name+'='+curVal).length;}
var expiresString="";if(daysToExpire){var f=new Date();f.setTime(f.getTime()+(daysToExpire*86400000));expiresString="; expires="+f.toGMTString();}
var dmn='';if(domain){dmn="domain="+domain;}else if(QSI.CookieDomain){dmn="domain="+QSI.CookieDomain;}
var cookieVal=name+"="+value;var newSize=(currentSize+cookieVal.length);if(options.force||(maxSize!==null&&newSize<=maxSize)||maxSize===null)
{if(!options.erase){this.cookieSize=newSize;}else{this.cookieSize=currentSize;}
var cookieStr=cookieVal+expiresString+"; path=/; "+dmn;if(location.protocol==='https:'){cookieStr+="; secure";}
document.cookie=cookieStr;}else{throw new Error('Cannot exceed the specified maximum cookie size');}},get:function(name){var e=name+"=";var ca=document.cookie.split(';');for(var i=0,ilen=ca.length;i<ilen;i++){var c=ca[i];while(c.charAt(0)===' '){c=c.substring(1,c.length);}
if(c.indexOf(e)===0){return c.substring(e.length,c.length);}}
return null;},erase:function(name,domain){this.set(name,"",-1,domain,{force:true,erase:true});},getCookieSize:function(){if(!this.cookieSize){this.cookieSize=0;var ca=document.cookie.split(';');for(var i=0,ilen=ca.length;i<ilen;i++){var c=ca[i];while(c.charAt(0)===' '){c=c.substring(1,c.length);}
if(c.indexOf('QSI')>=0){this.cookieSize+=c.length;}}}
return this.cookieSize;},areCookiesEnabled:function(){try{document.cookie='cookietest=1';var ret=document.cookie.indexOf('cookietest=')!==-1;document.cookie='cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT';return ret;}catch(e){return false;}}};QSI.CookieStorage=(function(){var storageCache={};var cookieName='QSI_DATA';function refreshFromCookie(){try{var cookieVal=QSI.cookie.get(cookieName);if(cookieVal){storageCache=JSON.parse(cookieVal);}}catch(e){storageCache={};}}
function setToCookie(){try{QSI.cookie.set(cookieName,JSON.stringify(storageCache));}catch(e){}}
refreshFromCookie();return{setItem:function(name,value){storageCache[name]=value;setToCookie();},getItem:function(name){return storageCache[name]||null;},removeItem:function(name){delete storageCache[name];setToCookie();},reload:refreshFromCookie,clear:function(){storageCache={};setToCookie();}};})();if(window.QSI.LoadingAnimationElement===undefined||window.QTest){QSI.LoadingAnimationElement=QSI.util.Class({initialize:function(){this.count=0;this.intervalID=0;this.animationDiv=null;this.animationBuilt=false;this.animationStarted=false;},buildAnimation:function(edge,top,left){var translationConstant=(edge/5)*2;this.animationDiv=QSI.util.build('div',{style:{width:edge+'px',height:edge+'px',zindex:QSI.global.currentZIndex++,position:'absolute',top:top+'px',left:left+'px'}},[]);for(var i=0;i<8;i++){var transformStr='rotate('+(i*45)+'deg) translate(0, -'+translationConstant+'px)';var loadBar=QSI.util.build('div',{style:{position:'absolute',top:((edge/2)-(edge/6))+'px',left:((edge/2)-(edge/20))+'px',width:(edge/10)+'px',height:(edge/3)+'px',background:'#000',transform:transformStr,'-ms-transform':transformStr,'-moz-transform':transformStr,'-webkit-transform':transformStr,opacity:(0.12*(i+1))}},[]);this.animationDiv.appendChild(loadBar);}
this.animationBuilt=true;return this.animationDiv;},startAnimation:function(intervalTime){var that=this;if(this.animationBuilt){this.intervalID=window.setInterval(function(){try{var animTransformStr='rotate('+that.count+'deg)';QSI.util.setStyle(that.animationDiv,{transform:animTransformStr,'-ms-transform':animTransformStr,'-moz-transform':animTransformStr,'-webkit-transform':animTransformStr});if(that.count===360){that.count=0;}
that.count+=45;}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},intervalTime);this.animationStarted=true;}},stopAnimation:function(){if(this.animationStarted){window.clearInterval(this.intervalID);QSI.util.remove(this.animationDiv);}}});}
QSI.PipedText={locators:[],setLocators:function(locators){this.locators=[];for(var i=0,ilen=locators.length;i<ilen;i++){var locatorData=locators[i];var locator={locator:locatorData[0],prefix:locatorData[1],type:locatorData[2],expression:locatorData[3]};this.locators.push(locator);}},evaluateLocators:function(content,options){if(this.locators.length===0){return'';}
for(var i=0,ilen=this.locators.length;i<ilen;i++){var locator=this.locators[i];var type=locator.type;var regex=new RegExp("\\"+this.escapeRegex(locator.locator));if(locator.prefix==='SI'){switch(type){case'J':content=content.replace(regex,QSI.EmbeddedData.getJavaScriptValue(locator.expression));break;case'H':content=content.replace(regex,QSI.EmbeddedData.getHTMLFromDOM(locator.expression));break;case'U':content=content.replace(regex,QSI.EmbeddedData.getURLParameter(locator.expression));break;case'C':content=content.replace(regex,QSI.EmbeddedData.getCookieVal(locator.expression));break;case'W':if(options){content=content.replace(regex,QSI.util.buildWidget(locator.expression,options));}
break;default:}}else{content=content.replace(regex,'');}}
return content;},escapeRegex:function(expresssion){var specials=new RegExp("[.*+?|()\\[\\]{}\\\\]","g");return expresssion.replace(specials,"\\$&");}};QSI.BuildElementModule={buildElement:function(element){if(!element.unitsOfMeasurement){element.unitsOfMeasurement={};element.unitsOfMeasurement.width='px';element.unitsOfMeasurement.height='px';}
var el;if(element.type&&this['build'+element.type+'Element']){el=this['build'+element.type+'Element'](element);el.tabIndex='0';QSI.util.observe(el,'keydown',QSI.util.clickOnKeyDown);}else{return null;}
if(element&&element.events){QSI.util.processElementEvents(element.events,el,this);}
var images=QSI.util.createArrayFromIterable(el.getElementsByTagName('img'));if(this.shouldPreloadImages===false){for(var i=0,ilen=images.length;i<ilen;i++){var img=images[i];img.setAttribute('data-src',img.src);img.src='';}}
var iframes=QSI.util.createArrayFromIterable(el.getElementsByTagName('iframe'));var elementsToLoad=images.concat(iframes);el.loadingDeferred=this.combineElementLoadEvents(elementsToLoad);return el;},combineElementLoadEvents:function(elementsToLoad){var deferred=QSI.util.Deferred();var numUnloaded=elementsToLoad.length;var elementLoaded=function(){if(--numUnloaded<=0){deferred.resolve();}};function markElementAsLoaded(evt){try{var element=evt.target||evt.srcElement;if(element.getAttribute('src')||!element.getAttribute('data-src')){elementLoaded();}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}}
for(var i=0,ilen=elementsToLoad.length;i<ilen;i++){var elementToLoad=elementsToLoad[i];if(!elementToLoad.complete||elementToLoad.notComplete)
{QSI.util.observe(elementToLoad,'load',markElementAsLoaded);}else{numUnloaded--;}}
if(numUnloaded===0){deferred.resolve();}
return deferred.promise();},buildGenericElement:function(opts){var el=this.buildBaseElement(opts);return el;},buildPopOverElement:function(opts){var el=this.buildBaseElement(opts);return el;},buildTextElement:function(opts){var el=this.buildBaseElement(opts);return el;},buildImageElement:function(opts){var el=this.buildBaseElement(opts);return el;},buildTargetElement:function(opts){var el=this.buildBaseElement(opts);this.addTargetElementFunctionality(el,opts);return el;},addTargetElementFunctionality:function(element,opts){element.style.cursor='pointer';element.setAttribute('data-type','target');var that=this;this.addEmbeddedDataToGlobalInstance(opts);var target=new QSI.Target(element,this.getTargetHelper((opts&&opts.embeddedData||[])),this.actionOptions,this);target.complete().done(function(){if(that.closeOnTargetClick){that.closeOnTargetClick();}else{that.close();}});},addEmbeddedDataToGlobalInstance:function(opts){if(QSI&&QSI.ed&&opts&&opts.embeddedData){for(var i=0;i<opts.embeddedData.length;i++){QSI.ed[this.id].push(opts.embeddedData[i]);}}},buildSpanElement:function(opts){this.position=opts.positionAnchors.positionY;var el=this.buildBaseElement(opts);el.style.width='100%';return el;},buildTargetSpanElement:function(opts){this.position=opts.positionAnchors.positionY;var el=this.buildBaseElement(opts);el.style.width='100%';el.style.cursor='pointer';this.addEmbeddedDataToGlobalInstance(opts);var that=this;var target=new QSI.Target(el,this.getTargetHelper((opts.embeddedData||[])),this.actionOptions);target.complete().done(function(){if(that.closeOnTargetClick){that.closeOnTargetClick();}else{that.close();}});return el;},buildEmbeddedTargetElement:function(opts){this.hasIframe=true;var url=this.getTarget((opts.embeddedData||[]));var contentWidth=opts.style.width;var contentHeight=opts.style.height;if(opts.unitsOfMeasurement.width==='%'){contentWidth=100;}
if(opts.unitsOfMeasurement.height==='%'){contentHeight=100;}
var iframeAttributes={'data-src':url,width:'100%',height:'100%',style:{},frameBorder:0};if(QSI.global.isHostedJS()&&!QSI.util.isIE(9)){iframeAttributes.sandbox='allow-scripts allow-same-origin allow-popups';}
var iframe=QSI.util.build('iframe',iframeAttributes);this.getEmbeddedTargets().push(iframe);var container=QSI.util.build('div',{className:'scrollable',style:{width:contentWidth+opts.unitsOfMeasurement.width,height:contentHeight+opts.unitsOfMeasurement.height,overflow:'none'}},[iframe]);if(QSI.Browser.isMobile){QSI.util.setStyle(container,{overflow:'auto'});}
this.displayed.then(function(){QSI.util.setStyle(container,{webkitTransform:'translateZ(0)'});});opts.content=container;var el=this.buildBaseElement(opts);return el;},buildCloseButtonElement:function(opts){var el=this.buildBaseElement(opts);this.fixTransparentWithOpacity(el);this.addCloseButtonElementFunctionality(el);return el;},addCloseButtonElementFunctionality:function(element){element.style.cursor='pointer';var that=this;element.onclick=function(){that.onCloseClick();};},fixTransparentWithOpacity:function(el){var imgs,i,ilen,image;if(QSI.util.isIE(7)||QSI.util.isIE(8)){imgs=el.getElementsByTagName('img');ilen=imgs.length;for(i=0;i<ilen;i++){image=imgs[i];image.style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr=#00FFFFFF, endColorstr=#00FFFFFF);";}}},buildBaseElement:function(opts){var style=opts.style,uom=opts.unitsOfMeasurement,position=opts.position,atts={style:this.getElementStyle(style,position,uom)},top=this.getYPosition(position),left=this.getXPosition(position),el,dims;this.setPositionStyles(atts,opts);if(opts.style.backgroundImage){atts.style.backgroundImage='url('+opts.style.backgroundImage+')';}
if(opts.style.opacity!==100){atts.style.opacity=opts.style.opacity/100;atts.style.filter='alpha(opacity = '+opts.style.opacity+')';}
el=QSI.util.build('div',atts,[this.getElementContents(opts)]);if(opts.dropShadow){this.appendDropShadow(opts,el);}
dims=QSI.util.getDimensions(el);el.bc={x:left+dims.width,y:top+dims.height};return el;},getElementContents:function(opts){var style=opts.style;var uom=opts.unitsOfMeasurement;var contentDims=this.getContentDims(style.width,style.height,uom);var contents=QSI.util.build('div',{style:{position:'absolute',top:0,left:0,width:contentDims.width,height:contentDims.height,overflow:'hidden',display:style.display}});if(opts.content){if(typeof opts.content==='string'){var contentHTML=opts.content;if(QSI.global.enableJSSanitization&&typeof QSI.DOMPurify!=='undefined'){contentHTML=QSI.DOMPurify.sanitize(contentHTML);}
contents.innerHTML=contentHTML;}else if(typeof opts.content==='object'){contents.appendChild(opts.content);}}
return contents;},getContentDims:function(width,height,uom){var contentWidth=width;var contentHeight=height;if(uom.width==='%'){contentWidth=100;}
if(uom.height==='%'){contentHeight=100;}
return{width:contentWidth+uom.width,height:contentHeight+uom.height};},appendDropShadow:function(opts,el){var style=opts.style;var b=style.borderWidth;var uom=opts.unitsOfMeasurement;if(isNaN(b)){b=0;}
var dropShadowStyle=this.convertPercentStylesToPixels(style,uom);var w=Math.floor(dropShadowStyle.width*1+(2*b));var h=Math.floor(dropShadowStyle.height*1+(2*b));el.insertBefore(this.buildDropShadow(w,h,b),el.childNodes[0]);},buildDropShadow:function(w,h,b){var t=Math.ceil(-(h*0.1))-b,l=Math.ceil(-(w*0.1))-b,dsw,dsh,style,img;dsw=Math.floor(w*1.2);dsh=Math.floor(h*1.2);style={width:dsw+'px',maxWidth:dsw+'px',height:dsh+'px',top:t+'px',left:l+'px',position:'absolute'};img=QSI.util.build('img',{src:QSI.global.imagePath+'/siteintercept/popup_shadow_transparent.png',style:style,alt:''});return img;},onCloseClick:function(){this.close();},buildIFrame:function(width,height){var iframeAttributes={style:{border:'none',position:'absolute',top:0,left:0,filter:"progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"},width:width+'px',height:height+'px',frameBorder:'0',src:QSI.global.imagePath+'/blank.html'};if(QSI.global.isHostedJS()&&!QSI.util.isIE(9)){iframeAttributes.sandbox='allow-scripts allow-same-origin allow-popups';}
var iframe=QSI.util.build('iframe',iframeAttributes);return iframe;},setPositionStyles:function(atts,opts){if(!opts.positionAnchors){opts.positionAnchors={positionX:'left',positionY:'top'};}
if(this.shouldAnchor){if(opts.positionAnchors.positionX==='left'){atts.style.left=opts.position.left+'px';}else if(opts.positionAnchors.positionX==='right'){atts.style.right=opts.position.right+'px';}else if(opts.positionAnchors.positionX==='center'){this.centerHorizontally(atts,opts);}
if(opts.positionAnchors.positionY==='top'){atts.style.top=opts.position.top+'px';}else if(opts.positionAnchors.positionY==='bottom'){atts.style.bottom=opts.position.bottom+'px';}else if(opts.positionAnchors.positionY==='center'){this.centerVertically(atts,opts);}}},centerHorizontally:function(atts,opts){this.centerDim(atts,opts.style.width,'width','left',opts.unitsOfMeasurement);},centerVertically:function(atts,opts){this.centerDim(atts,opts.style.height,'height','top',opts.unitsOfMeasurement);},centerDim:function(atts,dim,type,side,uom){var winSize=QSI.util.getPageSize();var upperSide=side.charAt(0).toUpperCase()+side.slice(1);if(uom[type]==='%'){dim=QSI.util.convertPercentToPixel(dim,winSize[type]);}
atts.style[side]='50%';atts.style['margin'+upperSide]='-'+Math.ceil(dim/2)+'px';},convertPercentStylesToPixels:function(style,uom){style=JSON.parse(JSON.stringify(style));style.width=parseInt(style.width,10);style.height=parseInt(style.height,10);var windowSize=QSI.util.getPageSize();if(uom.width==='%'&&style.width){style.width=QSI.util.convertPercentToPixel(style.width,windowSize.width);}
if(uom.height==='%'&&style.height){style.height=QSI.util.convertPercentToPixel(style.height,windowSize.height);}
return style;},getYPosition:function(position){return position.top*1;},getXPosition:function(position){return position.left*1;},getElementStyle:function(style,position,uom){return{position:'absolute',zIndex:style.zIndex,width:style.width+uom.width,height:style.height+uom.height,backgroundColor:style.backgroundColor,borderWidth:style.borderWidth+'px',borderColor:style.borderColor,borderStyle:'solid',borderRadius:style.borderRadius+'px',display:style.display};},initializeIframes:function(){var iframes=this.getEmbeddedTargets(),i,ilen,iframe,dataSrc;ilen=iframes.length;for(i=0;i<ilen;i++){iframe=iframes[i];dataSrc=iframe.getAttribute('data-src');if(dataSrc){iframe.src=dataSrc;}}},getEmbeddedTargets:function(){if(!this.embeddedTargets){this.embeddedTargets=[];}
return this.embeddedTargets;}};QSI.BuildResponsiveElementModule={HTML_ELEMENT_TYPES:{CONTAINER:'div',HEADLINE:'h1',TEXT:'p',BUTTON:'button',IMAGE:'img'},PARENT_CONTAINER_CLASS:'QSIWebResponsive',SHADOWBOX_CLASS:'QSIWebResponsiveShadowBox',ACTION_TYPES:{TARGET:'open-target',DISMISS:'dismiss-intercept'},buildParentContainer:function(content){return this.buildHTMLElement({elementType:this.HTML_ELEMENT_TYPES.CONTAINER,content:content,className:this.PARENT_CONTAINER_CLASS});},buildHTMLElement:function(buildOptions){var options=buildOptions||{};if(options.content&&!Array.isArray(options.content)){options.content=[options.content];}
if(!options.className){options.className='';}
var container=QSI.util.build(options.elementType,{className:options.className,style:options.elementStyle},options.content);if(options.tabbable){container.tabIndex=0;}
if(options.id){container.id=options.id;}
if(options.src){container.src=options.src;}
if(options.altText){container.alt=options.altText;}
return container;},buildShadowBox:function(){return this.buildHTMLElement({elementType:this.HTML_ELEMENT_TYPES.CONTAINER,className:this.SHADOWBOX_CLASS,elementStyle:{position:'fixed',backgroundColor:'#000000',left:'0',top:'0',width:'100%',height:'100%',opacity:'0',zIndex:QSI.global.currentZIndex}});},addButtonFunctionality:function(buttonAction,buttonComponent,creativeInstance){if(buttonAction===this.ACTION_TYPES.TARGET){this.addTargetElementFunctionality(buttonComponent,creativeInstance);}else if(buttonAction===this.ACTION_TYPES.DISMISS){this.addCloseButtonElementFunctionality(buttonComponent,creativeInstance);}},addTargetElementFunctionality:function(element,creativeInstance){element.style.cursor='pointer';element.setAttribute('data-type','target');var target=new QSI.Target(element,this.getTargetHelper(creativeInstance),creativeInstance.actionOptions,creativeInstance);target.complete().done(function(){if(creativeInstance.closeOnTargetClick){creativeInstance.closeOnTargetClick();}else{creativeInstance.close();}});},getTargetHelper:function(creativeInstance){var that=this;return function(){return that.getTargetURL(creativeInstance);};},getTargetURL:function(creativeInstance){var url=creativeInstance.options.targetURL;var embeddedDataQueryString=QSI.EmbeddedData.getEmbeddedDataAsQueryStringParam(creativeInstance.id);if(embeddedDataQueryString){embeddedDataQueryString=encodeURIComponent(embeddedDataQueryString);if(QSI.Browser.name==='Internet Explorer'&&QSI.Browser.version<9){embeddedDataQueryString=embeddedDataQueryString.substring(0,2050-url.length);}
url+=("&Q_ED="+embeddedDataQueryString);}
return url;},addCloseButtonElementFunctionality:function(element,creativeInstance){element.style.cursor='pointer';element.onclick=function(){creativeInstance.close();};},appendStylesToDocument:function(stylesheet){var styleToAppend=document.createElement('style');styleToAppend.type='text/css';styleToAppend.innerHTML=stylesheet;document.body.appendChild(styleToAppend);}};if(!QSI.Animation||window.QTest){QSI.Animation={supportedProperties:{'top':'px','left':'px','right':'px','bottom':'px','width':'px','height':'px','opacity':0},tweens:[],animateStyle:function(el,endProperties,duration,transition){duration=(duration===0)?1:duration;this.setUpAnimationFrames();var properties=this.getProperties(endProperties,el);return this.startAnimating(properties,(duration||1500),el,(transition||'easeto'));},getProperties:function(endProperties,el){var startProperties={};var that=this;if(endProperties.from){startProperties=endProperties.from;endProperties=endProperties.to;}
QSI.util.forOwn(endProperties,function(value,name){if(name in that.supportedProperties){endProperties[name]=endProperties[name];if(startProperties[name]!==undefined){el.style[name]=startProperties[name]+that.supportedProperties[name];}else{startProperties[name]=parseFloat(QSI.util.removePx(el.style[name]));}}});return{start:startProperties,end:endProperties};},startAnimating:function(properties,duration,el,transition){var that=this;var deferred=QSI.util.Deferred();var tween=new this.Tween(properties.start).to(properties.end,duration).onUpdate(function(){var self=this;QSI.util.forOwn(this,function(value,style){that.setElementStyle(el,style,self[style]);});}).onComplete(function(){deferred.resolve();});if(transition){transition=this.getTransitionFunction(transition);tween.transition(transition);}
tween.start();this.animating();return deferred.promise();},getTransitionFunction:function(transition){if(QSI.Animation.Transitions[transition]){return QSI.Animation.Transitions[transition];}
return transition;},setElementStyle:function(el,styleName,value){el.style[styleName]=value+this.supportedProperties[styleName];if(styleName==='opacity'){el.style.filter="alpha(opacity = "+(value)*100+")";}},animating:function(){try{if(QSI.Animation.tweens.length>0){QSI.Animation.update();window.qsiRequestAnimationFrame(QSI.Animation.animating);}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},setUpAnimationFrames:function(){if(window.qsiRequestAnimationFrame){return;}
var vendors=['ms','moz','webkit','o'];for(var x=0;x<vendors.length&&!window.qsiRequestAnimationFrame;++x){window.qsiRequestAnimationFrame=window[vendors[x]+'RequestAnimationFrame'];}
if(!window.qsiRequestAnimationFrame){window.qsiRequestAnimationFrame=this.animationFrameHelper();}},animationFrameHelper:function(){var lastTime=0;return function(callback){var currTime=QSI.util.getDateNow();var timeToCall=Math.max(0,20-(currTime-lastTime));var id=window.setTimeout(function(){try{callback(currTime+timeToCall);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},timeToCall);lastTime=currTime+timeToCall;return id;};},getAll:function(){return this.tweens;},removeAll:function(){this.tweens=[];},addTween:function(tween){this.tweens.push(tween);},update:function(time){var i=0;var numtweens=this.tweens.length;time=(time!==undefined)?time:QSI.util.getDateNow();while(i<numtweens){if(this.tweens[i].update(time)){i++;}else{this.tweens.splice(i,1);numtweens--;}}},Tween:function(object){var _object=object;var _valuesStart={};var _valuesEnd={};var _duration=1000;var _delayTime=0;var _startTime=null;var _transitionFunction=QSI.Animation.Transitions.easeto;var _onUpdateCallback=null;var _onCompleteCallback=null;this.to=function(properties,duration){if(duration!==null){_duration=duration;}
_valuesEnd=properties;return this;};this.start=function(time){QSI.Animation.addTween(this);if(Date){_startTime=time!==undefined?time:QSI.util.getDateNow();}
_startTime+=_delayTime;QSI.util.forOwn(_valuesEnd,function(value,property){if(_object[property]===null){return;}
if(_valuesEnd[property]instanceof Array){if(_valuesEnd[property].length===0){return;}
_valuesEnd[property]=[_object[property]].concat(_valuesEnd[property]);}
_valuesStart[property]=_object[property];});return this;};this.delay=function(amount){_delayTime=amount;return this;};this.transition=function(transition){_transitionFunction=transition;return this;};this.onUpdate=function(onUpdateCallback){_onUpdateCallback=onUpdateCallback;return this;};this.onComplete=function(onCompleteCallback){_onCompleteCallback=onCompleteCallback;return this;};this.update=function(time){if(time<_startTime){return true;}
var elapsed=(time-_startTime)/_duration;elapsed=elapsed>1?1:elapsed;var value=_transitionFunction(elapsed);for(var property in _valuesStart){if(Object.prototype.hasOwnProperty.call(_valuesStart,property)){var start=_valuesStart[property];var end=_valuesEnd[property];_object[property]=start+(end-start)*value;}}
if(_onUpdateCallback!==null){_onUpdateCallback.call(_object,value);}
if(elapsed===1){if(_onCompleteCallback!==null){_onCompleteCallback.call(_object);}
return false;}
return true;};}};QSI.Animation.Transitions={staticly:function(){return 1;},linear:function(k){return k;},inquad:function(k){return k*k;},easeto:function(k){if((k/=0.5)<1){return 0.5*Math.pow(k,4);}
return-0.5*((k-=2)*Math.pow(k,3)-2);},sinoidal:function(k){return(-Math.cos(k*Math.PI)/2)+0.5;},reverse:function(k){return 1-k;},bounce:function(k){if(k<(1/2.75)){return(7.5625*k*k);}else if(k<(2/2.75)){return(7.5625*(k-=(1.5/2.75))*k+0.75);}else if(k<(2.5/2.75)){return(7.5625*(k-=(2.25/2.75))*k+0.9375);}else{return(7.5625*(k-=(2.625/2.75))*k+0.984375);}},elastic:function(k){return-1*Math.pow(4,-8*k)*Math.sin((k*6-1)*(2*Math.PI)/2)+1;},swingFromTo:function(k){var s=1.70158;if((k/=0.5)<1){return 0.5*(k*k*(((s*=(1.525))+1)*k-s));}
return 0.5*((k-=2)*k*(((s*=(1.525))+1)*k+s)+2);},swingFrom:function(k){var s=1.70158;return k*k*((s+1)*k-s);},swingTo:function(k){var s=1.70158;return(k-=1)*k*((s+1)*k+s)+1;},bouncePast:function(k){if(k<(1/2.75)){return(7.5625*k*k);}else if(k<(2/2.75)){return 2-(7.5625*(k-=(1.5/2.75))*k+0.75);}else if(k<(2.5/2.75)){return 2-(7.5625*(k-=(2.25/2.75))*k+0.9375);}else{return 2-(7.5625*(k-=(2.625/2.75))*k+0.984375);}},easeFromTo:function(k){if((k/=0.5)<1){return 0.5*Math.pow(k,4);}
return-0.5*((k-=2)*Math.pow(k,3)-2);},easeFrom:function(k){return Math.pow(k,4);}};}
QSI.ResolveTimeZone={prepare:function(){var date=new Date();var TimeZone=-date.getTimezoneOffset()/60;return"&Q_TZ="+TimeZone;}};QSI.ResolveTimeOnSite={prepare:function(){var time=QSI.history.getTimeOnSite();return'&Q_TOS='+time;}};QSI.ResolveSiteCatalyst={prepare:function(vals){var retVal='&Q_ASC=';if(vals){if(QSI.util.isString(vals)){retVal+=encodeURIComponent(vals+'*|*'+this.getValue(vals));}else{var output=[];for(var i=0,ilen=vals.length;i<ilen;i++){var name=vals[i];output.push(name+'*|*'+this.getValue(name));}
retVal+=encodeURIComponent(output.join('*,*'));}}
return retVal;},getValue:function(name){var parts=name.split('.');this.adobeVar=this.rootName;var splitAdobeVar=this.adobeVar.split('.');var obj=window;for(var index=0;index<splitAdobeVar.length;index++){if(obj[splitAdobeVar[index]]){obj=obj[splitAdobeVar[index]];}else{return'';}}
for(var i=0,ilen=parts.length;i<ilen;i++){if(obj){obj=obj[parts[i]];}}
if(obj){return obj;}
return'';}};QSI.ResolveSearchTerm={prepare:function(){var search=QSI.history.getSearch();return"&Q_ST="+escape(search);}};QSI.ResolveResolution={prepare:function(){var dims=QSI.util.getPageSize();var retVal='&Q_VPDIMS=';retVal+=dims.width;retVal+='|';retVal+=dims.height;retVal+='&Q_SDIMS=';retVal+=screen.width;retVal+='|';retVal+=screen.height;return retVal;}};QSI.ResolveReferrer={prepare:function(){return"&Q_REFER="+encodeURIComponent(QSI.history.getPageReferrer())+"&Q_SREFER="+encodeURIComponent(QSI.history.getSiteReferrer());}};QSI.ResolveQualtricsSurvey={prepare:function(){}};QSI.ResolvePageCount={prepare:function(){var retVal='&Q_RPC=';var count=QSI.history.getPageCount();retVal+=count.total+"|"+count.unique;return retVal;}};QSI.ResolveJavaScript={prepare:function(vals){var retVal='&Q_RJS=';if(vals){var vars=vals;var co=[];QSI.util.forOwn(vars,function(value,id){var val=QSI.EmbeddedData.getJavaScriptValue(vars[id]);co.push(id+'*:*'+val);});retVal+=encodeURIComponent(co.join('*|*'));}
return retVal;}};QSI.ResolveIntercept={prepare:function(){var retVal='&Q_INTER=';var intercepts=null;try{intercepts=JSON.parse(QSI.localStorage.get("Q_INTER"));}catch(e){return retVal;}
var inter=[];var i=0;if(intercepts!==null){for(var id in intercepts){if(Object.prototype.hasOwnProperty.call(intercepts,id)){inter[i]=id+'*:*'+intercepts[id];i++;}}
retVal+=escape(inter.join('*|*'));}
return retVal;}};QSI.ResolveHTML={prepare:function(vals){var retVal='&Q_RHTML=';if(vals){var ids=vals;var co=[];for(var i=0,ilen=ids.length;i<ilen;i++){var val=QSI.EmbeddedData.getHTMLFromDOM(ids[i]);co[i]=ids[i]+'*:*'+escape(val);}
retVal+=escape(co.join('*|*'));}
return retVal;}};QSI.ResolveHistory={prepare:function(){var history=QSI.history.get();return'&Q_HIST='+escape(history);}};QSI.ResolveEventTracking={prepare:function(vals){var retVal='&Q_RET=';if(vals){var events=vals;var co=[];for(var i=0,ilen=events.length;i<ilen;i++){var val=QSI.EventTracker.get(events[i]);co[i]=events[i]+'*:*'+escape(val);}
retVal+=escape(co.join('*|*'));}
return retVal;}};QSI.ResolveCookie={prepare:function(vals){var retVal='&Q_COOK=';if(vals){var cookies=vals;var co=[];for(var i=0,ilen=cookies.length;i<ilen;i++){var val=QSI.cookie.get(cookies[i]);if(QSI.cookie.get(cookies[i])===null){val='';}
co[i]=cookies[i]+'*:*'+val;}
retVal+=escape(co.join('*|*'));}
return retVal;}};QSI.ResolveActionSet={prepare:function(vals){var retVal='&Q_RAS=';if(vals){var vars=vals;var co=[];QSI.util.forOwn(vars,function(value,id){var val=QSI.history.getActionSetHistory(id,!vars[id]);co.push(id+'|'+vars[id]+'*:*'+escape(val));});retVal+=escape(co.join('*|*'));}
return retVal;}};}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},"runPopOver":function(e){try{(void 0===window.QSI.PopOver||window.QTest)&&(QSI.PopOver=QSI.util.Creative(QSI.BuildElementModule,{initialize:function(t){if(this.globalInitialize(t),this.minTop=t.elements.MinTop,this.minLeft=t.elements.MinLeft,this.elements=t.elements.Elements||[],this.imageQueue=0,this.loaded=!1,this.timeout=!1,this.removed=!1,this.hasCreativeEmbeddedTarget=t.hasCreativeEmbeddedTarget,this.shouldShow()&&(this.addMessageListener(),QSI.util.processLocators(this.elements,this.options.displayOptions),this.container=this.build(),document.body.appendChild(this.container),this.display(),this.firstTabbableElement)){this.originalOutlineStyling=this.firstTabbableElement.style.outline,this.firstTabbableElement.style.outline="none",this.firstTabbableElement.focus();var i=this;this.addFocusHighlighting=function(t){try{9===t.which&&(i.firstTabbableElement.style.outline=i.originalOutlineStyling,QSI.util.stopObserving(i.firstTabbableElement,"keydown",i.addFocusHighlighting))}catch(t){"undefined"!=typeof QSI&&QSI.dbg&&QSI.dbg.e&&QSI.dbg.e(t)}},QSI.util.observe(this.firstTabbableElement,"keydown",this.addFocusHighlighting)}},addMessageListener:function(){var i=this;this.displayOptions.autoClose&&QSI.util.observe(window,"message",function(t){try{if(QSI.Orchestrator&&QSI.Orchestrator.isMessageEventOriginAllowed&&!QSI.Orchestrator.isMessageEventOriginAllowed(t.origin))
return;"closeQSIWindow"===t.data&&i.close()}catch(t){"undefined"!=typeof QSI&&QSI.dbg&&QSI.dbg.e&&QSI.dbg.e(t)}})},display:function(){var t=this;this.displayOptions.prebuild&&!this.displayOptions.auto?this.initializeIframes():!this.displayOptions.prebuild&&this.displayOptions.auto?QSI.util.when(QSI.util.getTimeout(this.displayOptions.delay)).done(function(){t.removed||(t.popup(),t.poppedUp=!0)}):this.displayOptions.prebuild&&this.displayOptions.auto&&(this.initializeIframes(),QSI.util.when(this.container.loadingDeferred,QSI.util.getTimeout(this.displayOptions.delay)).done(function(){t.removed||(t.popup(),t.poppedUp=!0)}))},close:function(){try{this.removed=!0,this.cleanupImpressElement(),this.refocus(),this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.displayOptions.shadowBox&&this.shadowBox&&this.shadowBox.parentNode&&(this.shadowBox.parentNode.removeChild(this.shadowBox),QSI.util.startScrolling()),QSI.util.stopObserving(window,"resize",this.resizeHandler),QSI.callbacks&&QSI.callbacks[this.id]&&QSI.callbacks[this.id].onClose&&QSI.callbacks[this.id].onClose()}catch(t){}},refocus:function(){try{if(this.hasIframe&&QSI.util.isIE8()){var t=document.body.scrollTop,i=document.body.scrollLeft,e=QSI.util.build("input",{type:"text"});document.body.appendChild(e),e.focus(),document.body.removeChild(e),window.scrollTo(i,t)}}catch(t){}},popup:function(){try{this.resetStyles();var t=1e3*this.displayOptions.close,i=this;if(0!==t&&this.displayed.done(function(){window.setTimeout(function(){try{i.close()}catch(t){"undefined"!=typeof QSI&&QSI.dbg&&QSI.dbg.e&&QSI.dbg.e(t)}},t)}),this.impress(),!this.displayOptions.prebuild){this.initializeIframes();var e=this.container.getElementsByClassName("scrollable")[0];if(e&&this.hasCreativeEmbeddedTarget){var s=parseInt(e.style.height,10),o=parseInt(e.style.width,10),a=s/2-37.5,n=o/2-37.5,l=new QSI.LoadingAnimationElement,d=l.buildAnimation(75,a,n);e.appendChild(d),l.startAnimation(100),QSI.util.when(this.container.loadingDeferred).done(function(){l.stopAnimation()})}}
this.displayOptions.shadowBox&&(this.shadowBox=this.buildShadowBox(),QSI.util.stopScrolling(),document.body.appendChild(this.shadowBox),this.displayOptions.shadowBoxFade&&QSI.Animation.animateStyle(this.shadowBox,{from:{opacity:0},to:{opacity:this.displayOptions.shadowBoxOpacity}},500,"linear")),this.container.style.zIndex=QSI.global.currentZIndex++;var h=this.getFinalPosition();if(this.displayOptions.animate){var r=this.getStartPosition();QSI.Animation.animateStyle(this.container,{from:{top:r.y,left:r.x},to:{top:h.y,left:h.x}},this.displayOptions.duration,this.displayOptions.transition).done(function(){i.target={x:h.x,y:h.y},i.finish()})}else
this.target={x:h.x,y:h.y},this.finish();this.resizeHandler=function(){try{i.resize()}catch(t){"undefined"!=typeof QSI&&QSI.dbg&&QSI.dbg.e&&QSI.dbg.e(t)}},QSI.util.observe(window,"resize",this.resizeHandler)}catch(t){QSI.dbg.e(t)}},getYPosition:function(t){return t.top-this.minTop},getXPosition:function(t){return t.left-this.minLeft},getElementStyle:function(t,i){return{top:this.getYPosition(i)+"px",left:this.getXPosition(i)+"px",position:"absolute",zIndex:t.zIndex,width:t.width+"px",height:t.height+"px",backgroundColor:t.backgroundColor,borderWidth:t.borderWidth+"px",borderColor:t.borderColor,borderStyle:"solid",borderRadius:t.borderRadius+"px",display:t.display}},buildShadowBox:function(){var t=this.displayOptions.shadowBoxOpacity,i=this.displayOptions.shadowBoxColor,e=QSI.util.getPageSize(),s=e.width,o=e.height,a=QSI.util.getScrollOffsets();return QSI.util.build("div",{className:"QSIPopOverShadowBox",style:{position:"absolute",backgroundColor:i,left:a.left+"px",top:a.top+"px",width:s+"px",height:o+"px",opacity:t,zIndex:QSI.global.currentZIndex++,filter:"alpha(opacity="+100*t+")"}})},updateShadowBox:function(){if(this.shadowBox){var t=QSI.util.getPageSize(),i=t.width,e=t.height;this.shadowBox.style.width=i+"px",this.shadowBox.style.height=e+"px"}},build:function(){for(var t=[],i=0,e=0,s=0,o=[],a=0,n=this.elements.length;a<n;a++){var l=this.buildElement(this.elements[a]);l&&(l.style&&l.style.borderWidth&&(s=2*parseInt(l.style.borderWidth,10)),l.bc&&l.bc.x+s>i&&(i=l.bc.x+s),l.bc&&l.bc.y+s>e&&(e=l.bc.y+s),t.push(l),o.push(l.loadingDeferred))}
this.width=i,this.height=e;var d=Math.floor(1.2*this.width),h=Math.floor(1.2*this.height),r="fixed";QSI.util.isFixed()||(r="absolute");var p=QSI.util.build("div",{className:"QSIPopOver "+this.id+"_PopOverContainer",style:{position:r,top:-h+"px",left:-d+"px"}},t);p.loadingDeferred=QSI.util.when.apply(this,o);var c=p.querySelectorAll("[tabindex]");if(c&&0<c.length){this.firstTabbableElement=c[0],this.lastTabbableElement=c[c.length-1];var u=this;QSI.util.observe(p,"keydown",function(t){try{9===t.which&&(t.target!==u.lastTabbableElement||t.shiftKey?t.target===u.firstTabbableElement&&t.shiftKey&&(t.preventDefault(),u.lastTabbableElement.focus()):(t.preventDefault(),u.firstTabbableElement.focus()))}catch(t){"undefined"!=typeof QSI&&QSI.dbg&&QSI.dbg.e&&QSI.dbg.e(t)}})}
return p},getFinalPosition:function(){var t=this.width,i=this.height,e=QSI.util.getScrollOffsets(),s=QSI.util.getPageSize(),o=s.width,a=s.height;o<t&&(t=o),a<i&&(i=a);var n=(o-t)/2,l=(a-i)/2;switch(this.displayOptions.targetPosition){default:case"MC":n=(o-t)/2,l=(a-i)/2;break;case"ML":n=20,l=(a-i)/2;break;case"TL":l=n=20;break;case"BL":l=a-i-(n=20);break;case"TC":n=(o-t)/2,l=20;break;case"TR":n=o-t-20,l=20;break;case"MR":n=o-t-20,l=(a-i)/2;break;case"BR":n=o-t-20,l=a-i-20;break;case"BC":n=(o-t)/2,l=a-i-20}
return QSI.util.isFixed()||(n+=e.left,l+=e.top),{x:n,y:l}},getStartPosition:function(){var t=this.width,i=this.height,e=QSI.util.getPageSize(),s=QSI.util.getScrollOffsets(),o=e.width,a=e.height,n=-t,l=(a-i)/2;switch(this.displayOptions.startPosition){default:case"OML":n=-t,l=(a-i)/2;break;case"OTL":n=-t,l=-i;break;case"OTLL":n=-t,l=20;break;case"OTLT":n=20,l=-i;break;case"OBL":n=-t,l=a;break;case"OBLL":n=-t,l=a-i-20;break;case"OBLB":n=20,l=a;break;case"OTC":n=(o-t)/2,l=-i;break;case"OTR":n=o,l=-i;break;case"OTRR":n=o,l=20;break;case"OTRT":n=o-t-20,l=-i;break;case"OMR":n=o,l=(a-i)/2;break;case"OBR":n=o,l=a;break;case"OBRR":n=o,l=a-i-20;break;case"OBRB":n=o-t-20,l=a;break;case"OBC":n=(o-t)/2,l=a}
return QSI.util.isFixed()||(n+=s.left,l+=s.top),{x:n,y:l}},finish:function(){if(!this.finished){this.displayed.resolve();try{this.container.style.left=this.target.x+"px",this.container.style.top=this.target.y+"px",this.finished=!0,QSI.callbacks&&QSI.callbacks[this.id].onPopup&&QSI.callbacks[this.id].onPopup(),QSI.util.isFixed()||QSI.util.positionFixed(this.container,this.container.style.top,"auto")}catch(t){QSI.dbg.e(t)}}},reposition:function(){var t=this.getFinalPosition();this.container.style.left=t.x+"px",this.container.style.top=t.y+"px"},resize:function(){this.reposition(),this.updateShadowBox()}}))}catch(t){"undefined"!=typeof QSI&&QSI.dbg&&QSI.dbg.e&&QSI.dbg.e(t)}},"runPopUp":function(e){try{if(window.QSI.PopUp===undefined||window.QTest){QSI.PopUp=QSI.util.Creative({initialize:function(options){this.globalInitialize(options);window.QSI_INTERNAL=false;if(this.shouldShow()){this.setupPopup();}},setupPopup:function(){var that=this;var f=function(){that.popup();};if(this.options.creativeOptions.showOnClick){var el=document.body;this.f=function(){try{that.popupOnClick();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};QSI.util.observe(el,'click',this.f);}else if(this.options.creativeOptions.showOnLoad){this.popup();}else if(this.options.creativeOptions.showOnExit){QSI.util.observe(window,'unload',f);}else if(this.options.creativeOptions.showOnSiteExit){var elements=this.getInternalSubmitButtons().concat(this.getInternalLinks());this.addListenerToElements(elements,'click',function(){try{window.QSI_INTERNAL=true;}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});QSI.util.observe(document,'keydown',function(evt){try{if(evt.keyCode===82||evt.keyCode===116){window.QSI_INTERNAL=true;}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});QSI.util.observe(window,'beforeunload',function(){try{if(!window.QSI_INTERNAL){f();}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});}},popupOnClick:function(){var el=document.body;QSI.util.stopObserving(el,'click',this.f);this.popup();},refreshKeyPressed:function(evt){return(evt.keyCode===82&&(evt.ctrlKey||evt.metaKey))||evt.keyCode===116;},popup:function(){this.impress();var url=this.getTarget();var width=parseInt(this.options.creativeOptions.width,10),height=parseInt(this.options.creativeOptions.height,10);this.win=QSI.util.openWin(url,this.id,{'width':width,'height':height,'scrollbars':'yes'});this.displayed.resolve();},addListenerToElements:function(elements,event,eventFunc){QSI.util.each(elements,function(el){QSI.util.observe(el,event,eventFunc);});},getInternalSubmitButtons:function(){var that=this;return QSI.util.filter(this.getElementsByTag('input',{type:'submit'}),function(element){var form=element.form;return that.isInternalLink(form.getAttribute('action'));});},getInternalLinks:function(){var that=this;var links=this.getElementsByTag('a');return QSI.util.filter(links,function(element){return that.isInternalLink(element.getAttribute('href'));});},getElementsByTag:function(tag,attributes,parent){parent=parent||document;var elements=parent.getElementsByTagName(tag);return QSI.util.filter(elements,function(element){for(var attr in attributes){if(Object.prototype.hasOwnProperty.call(attributes,attr)){if(!(element.getAttribute(attr)&&element.getAttribute(attr)===attributes[attr])){return false;}}}
return true;});},getCurrentDomain:function(){if(!this.currentDomain){this.currentDomain=this.getDomain(window.location.href);}
return this.currentDomain;},getDomain:function(link){var regex=/(https?:\/\/)?([a-z0-9\-]+\.)*([a-z]+)/,urlParts,fullDomain,topLevelDomain;if(this.isRelative(link)){return this.getCurrentDomain();}
urlParts=regex.exec(link);if(urlParts){var len=urlParts.length;topLevelDomain=urlParts[len-1];fullDomain='';if(urlParts[len-2]){fullDomain=urlParts[len-2];}
return fullDomain+topLevelDomain;}else{return this.getCurrentDomain();}},isRelative:function(link){return!(/https?\:\/\//).test(link);},isInternalLink:function(link){return this.getDomain(link)===this.getCurrentDomain();}});}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},"runPopUnder":function(e){try{if(window.QSI.PopUnderMixin===undefined||window.QTest){QSI.PopUnderMixin={openParentWatcher:function(id,targetURLOrigin){try{if(this.isPopUnderRunning()){return;}
this.trigger('start');var onloadtime=new Date();var stringDate=onloadtime.valueOf().toString();var popUnderWindowName=this.getName()+'_'+stringDate;this.name=popUnderWindowName;var openedFrom=this.getCurrentURL();var html=this.build();var width=this.getWidth();var height=this.getHeight();try{this.watcher=QSI.util.openWin('',popUnderWindowName,this.getWindowOptions());QSI.windowHandler.addWindowHandle(popUnderWindowName,this.watcher);var windowOrigin=QSI.windowHandler.getWindowOrigin(window);QSI.windowHandler.addOptInIDAndWindowName(id,popUnderWindowName,targetURLOrigin||windowOrigin);this.watcher.openerURL=openedFrom;var newDiv=this.watcher.document.createElement('div');var newContent=this.watcher.document.createTextNode('');newDiv.appendChild(newContent);newDiv=this.watcher.document.createElement('div');newContent=this.watcher.document.createTextNode('');newDiv.appendChild(newContent);}catch(e){QSI.dbg.e('Failed to load PopUnder');if(this.watcher){this.watcher.close();}
QSI.cookie.erase(this.name);return;}
this.validateWatcher(width,height);this.watcher.width=width;this.watcher.height=height;this.watcher.openerURL=openedFrom;this.watcher.openerOnLoadTime=onloadtime;this.writeHTMLToWatcher(width,height,html);this.initWatcher();this.trigger('show');QSI.util.moveToBackground();}catch(e){QSI.dbg.e(e);}},getWindowOptions:function(){var parentDims=this.getParentDims();return{width:this.getWidth(),height:this.getHeight(),scrollbars:'1',resizable:'1',top:parentDims.top,left:parentDims.left};},isPopUnderRunning:function(){QSI.dbg.e('You must implement isPopUnderRunning');},getName:function(){QSI.dbg.e('You must implement getName');},getWidth:function(){QSI.dbg.e('You must implement getWidth');},getHeight:function(){QSI.dbg.e('You must implement getHeight');},getCloseIfTab:function(){return false;},getCurrentURL:function(){return window.location.href;},getParentDims:function(){var parentTop=((window.screenTop)?window.screenTop:window.screenY)||0;var parentLeft=((window.screenLeft)?window.screenLeft:window.screenX)||0;parentTop+=20;parentLeft+=20;return{top:parentTop,left:parentLeft};},build:function(){QSI.dbg.e('You must implement build');},validateWatcher:function(width,height){var watcherSize=QSI.util.getWindowSize(this.watcher);if((watcherSize.height!==height&&watcherSize.width!==width)&&this.getCloseIfTab()){var parentSize=QSI.util.getWindowSize();if(parentSize.width===watcherSize.width){this.watcher.close();}}},getNonce:function(){var scripts=document.getElementsByTagName("script");var nonce=null;var index=0;while(nonce===null&&index<scripts.length){var el=scripts[index];nonce=el.getAttribute("nonce");index++;}
return nonce;},writeHTMLToWatcher:function(width,height,html){var white='rgb(255,255,255)';var backgroundColor=white;if(this.popunderOptions&&this.popunderOptions.baseElement&&this.popunderOptions.baseElement.style){backgroundColor=this.popunderOptions.baseElement.style.backgroundColor||white;}
var winDoc=this.watcher.document;var winHtml='<body  style="padding:0px;margin:0px;background-color:'+backgroundColor+';">';var nonce=this.getNonce();if(nonce){winHtml+='<script type="text/javascript" nonce="'+nonce+'">';}else{winHtml+='<script type="text/javascript">';}
winHtml+='var popunderWatcher = '+QSI.popunderWatcher.toString()+'; var w = new popunderWatcher(); ';winHtml+='w.oWidth='+width+';';winHtml+='w.oHeight='+height+';';if(QSI.Browser.name==='Chrome'){winHtml+='window.onload = function(){  '+
"var div = document.querySelector('body > div');"+
"div.style.display = 'none';"+
"setTimeout(function(){"+
"div.style.display = 'block';"+
"}, 100);"+
'};';}
winHtml+='</script>';winHtml+=html;winHtml+='</body>';winDoc.write(winHtml);winDoc.close();},initWatcher:function(){QSI.dbg.e('You must implement initWatcher');},hasWatcherLoaded:function(openedFrom){var success=false;for(var i=0;i<20000&&!success;i++){try{this.watcher.openerURL=openedFrom;success=true;}catch(e){}}
return success;},on:function(name,func){if(!this._evts){this._evts={};}
if(!this._evts[name]){this._evts[name]=[];}
this._evts[name].push(func);},trigger:function(name){if(this._evts&&this._evts[name]){var callbacks=this._evts[name];for(var i=0,ilen=callbacks.length;i<ilen;i++){callbacks[i]();}}}};}
if(window.QSI.PopUnder===undefined||window.QTest){QSI.PopUnder=QSI.util.Creative(QSI.BuildElementModule,QSI.PopUnderMixin,{initialize:function(options){try{this.globalInitialize(options);this.shouldAnchor=true;this.name='QSIPopUnder_'+this.id;if(typeof options.isPlaceholderWindow!=='undefined'&&options.isPlaceholderWindow){this.name=this.name+'_placeholderWindow';}
if(QSI.global.intercepts[this.id]){this.asid=QSI.global.intercepts[this.id].ASID;}
this.popunderOptions=this.options.popunderOptions||{};this.popunderHelperOptions=this.options.popunderHelperOptions||{};this.shouldPreloadImages=false;var that=this;this.on('start',function(){QSI.cookie.set(that.name.replace(/_placeholderWindow/,''),that.asid,false,false,{force:true});});this.on('show',function(){that.displayed.resolve();});if(this.shouldShow()){this.prepareParentWatcher();}}catch(e){QSI.dbg.e(e);}},prepareParentWatcher:function(){var that=this;this.setPreventRepeatedDisplayCookie();this.f=function(){try{that.startWatcher();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};QSI.util.observe(document,'click',this.f);var embedTags=document.getElementsByTagName('embed');for(var i=0;i<embedTags.length;i++){var node=embedTags[i];QSI.util.observe(node,'mouseup',this.f);}},startWatcher:function(){if(!this.clicked){this.clicked=true;this.openParentWatcher(this.id);}},isPopUnderRunning:function(){var cookieASID=QSI.cookie.get(this.name);if(cookieASID){if(cookieASID===this.asid){return true;}else{var previousWatcher=QSI.util.openWin('',this.name);previousWatcher.close();}}
return false;},getName:function(){return this.name;},getWidth:function(){return this.popunderOptions.width;},getHeight:function(){return this.popunderOptions.height;},getCloseIfTab:function(){return this.popunderOptions.closeIfTab;},build:function(){if(this.options.elements){this.elements=this.options.elements.Elements||[];QSI.util.processLocators(this.elements);this.html=this.buildHTML();}else{if(this.options.locators){QSI.PipedText.setLocators(this.options.locators);this.popunderOptions.html=QSI.PipedText.evaluateLocators(this.popunderOptions.html,this);}
this.html=this.popunderOptions.html;}
return this.html;},buildHTML:function(){var elements=[];var maxX=0;var maxY=0;var totalBorderWidth=0;for(var i=0,ilen=this.elements.length;i<ilen;i++){var el=this.buildElement(this.elements[i]);if(!el){continue;}
if(el.style&&el.style.borderWidth){totalBorderWidth=parseInt(el.style.borderWidth,10)*2;}
if(el.bc&&el.bc.x+totalBorderWidth>maxX){maxX=el.bc.x+totalBorderWidth;}
if(el.bc&&el.bc.y+totalBorderWidth>maxY){maxY=el.bc.y+totalBorderWidth;}
elements.push(el);}
this.width=maxX;this.height=maxY;var position='fixed';if(!QSI.util.isFixed()){position='absolute';}else if(this.insertIntoBody){position='relative';}
var height=this.height;var container=QSI.util.build('div',{className:'QSIPopUnder '+this.id+'_PopUnderContainer',style:{width:'100%',height:height+'px',overflow:'hidden',position:position}},elements);var els=[];els.push(container);var outer=QSI.util.build('div',{},els);return outer.innerHTML;},initWatcher:function(){this.popunderHelperOptions.targetURL=this.getTarget();this.popunderHelperOptions.parent=this;this.popunderHelperOptions.id=this.id;this.popunderHelperOptions.noshow=this.interceptDisplayOptions.noshow;this.popunderHelperOptions.cookieDomain=this.interceptDisplayOptions.cookieDomain;this.popunderHelperOptions.browser=QSI.Browser.name;this.popunderHelperOptions.domain=(QSI.CookieDomain)?QSI.CookieDomain:null;if(this.options.resetStyle){this.popunderHelperOptions.resetCSS=this.options.resetStyle;}
var w=this.watcher.w;w.initialize(this.popunderHelperOptions);QSI.util.observe(window,'unload',function(){try{if(w.imagesLoaded<w.imgCount){w.initializeImages();}}catch(e){}});this.watcher.blur();window.focus();setTimeout(function(){try{window.focus();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},1);this.watcher.w.startWatching();},killPopunder:function(e){if(this.watcher){e=e||window.event;if(e.stopPropagation){e.stopPropagation();}else{e.cancelBubble=true;}
this.watcher.w.killPopunder();}
return false;},buildCloseButtonElement:function(opts){var el=this.buildBaseElement(opts);this.fixTransparentWithOpacity(el);el.style.cursor='pointer';el.setAttribute('onclick','w.destroyPopunder()');return el;},buildEmbeddedTargetElement:function(opts){var ed=opts.embeddedData||[];var url=this.getTarget(ed);var iframeAttributes={id:'PopUnderTargetFrame','data-src':url,width:opts.style.width,height:opts.style.height,frameBorder:0};if(!QSI.util.isIE(9)){iframeAttributes.sandbox='allow-scripts allow-same-origin allow-popups';}
var iframe=QSI.util.build('iframe',iframeAttributes);opts.content=iframe;var el=this.buildBaseElement(opts);return el;}});}
if(window.QSI.PopUnderTarget===undefined){QSI.PopUnderTarget=QSI.util.Class(QSI.PopUnderMixin,{initialize:function(url,options,parent){this.options=options||{};this.url=url;this.width=options.targetFullScreen?screen.availWidth||screen.width:options.targetWidth;this.height=options.targetFullScreen?screen.availHeight||screen.height:options.targetHeight;var targetURLOrigin=parent.options.targetURLOrigin||'*';if(options.targetPopUnderDisplay&&options.targetPopUnderDisplay.creative){var creativeInfo=options.targetPopUnderDisplay.creative;var popunderTarget=new QSI.PopUnder({id:parent.id,type:'PopUnder',targetURL:url,impressionURL:'',interceptDisplayOptions:parent.options.interceptDisplayOptions,actionOptions:{},elements:creativeInfo.elements,resetStyle:'',locators:{},popunderOptions:creativeInfo.popunderOptions,isPlaceholderWindow:true,popunderHelperOptions:creativeInfo.popunderHelperOptions});popunderTarget.startWatcher();}else{this.openParentWatcher(parent.id,targetURLOrigin);}},getWindowOptions:function(){var parentDims=this.getParentDims();return{width:this.getWidth(),height:this.getHeight(),scrollbars:false,resizable:'1',top:parentDims.top,left:parentDims.left};},build:function(){return'<iframe id="PopUnderTargetFrame" width='+this.width+' height='+this.height+' frameborder=false border=false style="border:none;" scrolling=yes src="'+this.url+'"></iframe>';},getWidth:function(){return this.width;},getHeight:function(){return this.height;},isPopUnderRunning:function(){return false;},getName:function(){return'QSIPopUnderTargetWindow';},initWatcher:function(){if(this.watcher){var parentDims=this.getParentDims();if(QSI.Browser.name!=='Chrome'){this.watcher.blur();}
window.focus();setTimeout(function(){try{window.focus();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},1);this.watcher.w.initialize({showOnPageChange:false,showOnSiteExit:true,checkThreshold:3,watchInterval:1000,width:this.width,height:this.height,parentTop:parentDims.top,parentLeft:parentDims.left,domain:(QSI.CookieDomain)?QSI.CookieDomain:null});this.watcher.w.url=this.url;this.watcher.w.startWatching();}}});}
QSI.popunderWatcher=function(){this.initialize=function(options){var images=document.body.getElementsByTagName('img');this.imgCount=images.length;this.imagesLoaded=0;var that=this;this.options={};for(var id in options){if(Object.prototype.hasOwnProperty.call(options,id)){this.options[id]=options[id];}}
this.id=this.options.id;this.name='QSIPopUnder_'+this.id;this.popForwardDelayInMS=5000;var f=function(e){that.unload(e);that.eraseNameInOpenerSessionStorage(e);};window.onbeforeunload=f;window.onunload=f;var popUnderWindowReceiveMessageWrapper=function(event){try{var thisOrigin=window.location.origin;if(!thisOrigin){thisOrigin=window.location.protocol+"//"+window.location.hostname+(window.location.port?':'+window.location.port:'');}
if(event.origin!==thisOrigin){return;}
that.popUnderWindowReceiveMessage(event);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};window.addEventListener("message",popUnderWindowReceiveMessageWrapper,false);if(this.options.resetCSS){this.addCSSReset();}
this.initializeImages();this.onWindowFocus(options);this.initializeTargetLinks();};this.popUnderWindowReceiveMessage=function(event){if(typeof event==='undefined'||typeof event.data==='undefined'){return;}
var message;try{message=JSON.parse(event.data);}catch(e){return;}
if(typeof message!=='object'||typeof message.type!=='string'||typeof message.payload!=='string'){return;}
var embeddedData=message.payload;var url=this.options.targetURL;url=url.replace(/&Q_ED=.*/,'');if(embeddedData){embeddedData=encodeURIComponent(embeddedData);url+=("&Q_ED="+embeddedData);}
this.options.targetURL=url;};this.eraseNameInOpenerSessionStorage=function(){if(!window.opener||!window.opener.sessionStorage){return;}
var openerSS=window.opener.sessionStorage;var optInIDsAndNames=openerSS.getItem('QSI_OptInIDsAndWindowNames');if(!optInIDsAndNames){return;}
try{optInIDsAndNames=JSON.parse(optInIDsAndNames);}catch(error){return;}
for(var id in optInIDsAndNames){if(optInIDsAndNames[id]===window.name){delete optInIDsAndNames[id];}}
openerSS.setItem('QSI_OptInIDsAndWindowNames',JSON.stringify(optInIDsAndNames));};this.onWindowFocus=function(options){var that=this;var onFocusFunc=function(e){that.load(e);};if('onfocusin'in document){setTimeout(function(){try{document.onfocusin=onFocusFunc;}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},1);}else{if(options.browser==='Firefox'){window.onfocus=onFocusFunc;}else{window.onblur=function(){window.onfocus=onFocusFunc;};}}};this.initializeTargetLinks=function(doc){doc=doc||document;var divs=doc.getElementsByTagName('div');var that=this;var openTargetHandler=function(){try{that.openTarget(that.options.targetURL);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};for(var i=0,ilen=divs.length;i<ilen;i++){var div=divs[i];if(div.getAttribute('data-type')==='target'){this.observe(div,'click',openTargetHandler);}}};this.observe=function(el,e,f){if(el){if(el.addEventListener){el.addEventListener(e,f,false);}else if(el.attachEvent){el.attachEvent("on"+e,f);}else if(el['on'+this.capFirst(e)]){if(el['on'+this.capFirst(e)]){var temp=el['on'+this.capFirst(e)];var tempf=f;f=function(){temp();tempf();};}
el['on'+this.capFirst(e)]=f;}}};this.load=function(){if(!this.loaded){this.loaded=true;this.initializeIframes();this.impress(this.options.impressionURL);}};this.capFirst=function(str){return str.charAt(0).toUpperCase()+str.slice(1);};this.initializeIframes=function(doc){doc=doc||document;var iframes=doc.getElementsByTagName('iframe');for(var i=0,ilen=iframes.length;i<ilen;i++){var iframe=iframes[i];var dataSrc=iframe.getAttribute('data-src');if(dataSrc){iframe.src=dataSrc;}}};this.initializeImages=function(doc){var that=this;doc=doc||document;var images=doc.getElementsByTagName('img');var incrementLoadedImageCount=function(){that.imagesLoaded++;};for(var i=0,ilen=images.length;i<ilen;i++){var img=images[i];var src=img.getAttribute('data-src');img.onload=incrementLoadedImageCount;if(src){img.src=src;}}};this.unload=function(){try{if(!this.unloaded){this.cookie.erase(this.name,this.options.domain);this.markDisplayed();this.unloaded=true;}}catch(e){QSI.dbg.e(e);}
return true;};this.markDisplayed=function(){if(this.options.noshow!=0){this.cookie.set(this.id+'_intercept',true,this.options.noshow,this.options.cookieDomain);}};this.watch=function(){var that=this;this.lastLoc=window.opener.location;this.ival=setInterval(function(){try{that.intervalWatch();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},this.options.watchInterval);};this.addCSSReset=function(doc){try{doc=doc||document;var head=doc.getElementsByTagName('head')[0],style=doc.createElement('style');if(head&&head.appendChild){style.type='text/css';if(style.styleSheet){style.styleSheet.cssText=this.options.resetCSS;}else{style.appendChild(doc.createTextNode(this.options.resetCSS));}
head.appendChild(style);}}catch(e){}};this.intervalWatch=function(){try{if(this.popunderDead){this.killPopunder();return;}}catch(e){}
var loc=null;try{loc=''+window.opener.location;}catch(e){loc=null;}
if(!loc){this.onSiteExit();}else{if(this.lastLoc!==loc){this.onSiteChange();}
this.lastLoc=loc;}};this.clearWatcher=function(){if(this.ival){clearInterval(this.ival);}};this.destroyPopunder=function(){try{this.clearWatcher();this.cookie.erase(this.name,this.options.domain);window.opener=window.self;window.close();}catch(e){}};this.showPopunder=function(delayInMS){var that=this;this.clearWatcher();try{if(this.options.onPopForwardShowTarget&&this.options.targetURL){var loaded=false;setTimeout(function(){try{if(!loaded){that.redirectToURL(that.options.targetURL);loaded=true;}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},delayInMS);that.observe(window,'focus',function(){try{if(!loaded){loaded=true;that.redirectToURL(that.options.targetURL);}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});if(!loaded&&document.hasFocus()){loaded=true;that.redirectToURL(that.options.targetURL);}}else{window.focus();}}catch(e){}
this.cookie.erase(this.name,this.options.domain);};this.redirectToURL=function(url){var that=this;that.offsetWindowFromTopLeftCorner(100,100);if(!document.hasFocus()){that.bringWindowIntoFocus();}
that.redirectTo(url);that.resizeToFitInterceptTarget();};this.offsetWindowFromTopLeftCorner=function(x_offset,y_offset){window.moveBy(x_offset,y_offset);};this.bringWindowIntoFocus=function(){if(this.checkIfBrowserFocusesOnAlert()){alert('Your survey is ready.');}else{window.focus();}};this.checkIfBrowserFocusesOnAlert=function(){var browsersThatPermitAlertFocus=['Chrome'];var userAgent=window.navigator.userAgent;var browserFocusesOnAlert=false;for(var i=0;i<browsersThatPermitAlertFocus.length;i++){var currentBrowser=browsersThatPermitAlertFocus[i];if(userAgent.indexOf(currentBrowser)!==-1){browserFocusesOnAlert=true;break;}}
return browserFocusesOnAlert;};this.redirectTo=function(url){window.location=url;};this.resizeToFitInterceptTarget=function(){if(this.options.targetFullScreen){var size=this.getWindowSize();var width=screen.width||size[0];var height=screen.height||size[1];window.resizeTo(width,height);window.moveTo(0,0);}else if(this.options.targetWidth&&this.options.targetHeight){window.resizeTo(parseInt(this.options.targetWidth,10),parseInt(this.options.targetHeight,10));}};this.killPopunder=function(){try{this.destroyPopunder();}catch(e){}};this.startWatching=function(){this.watch();};this.onSiteChange=function(){if(this.popunderDead){this.killPopunder();}else if(this.options.showOnPageChange){this.showPopunder(this.popForwardDelayInMS);}};this.onSiteExit=function(){if(this.popunderDead){this.killPopunder();}else if(this.options.showOnSiteExit){this.showPopunder(this.popForwardDelayInMS);}};this.getWindowSize=function(){var myWidth=0,myHeight=0;if(typeof(window.innerWidth)!=='undefined'){myWidth=window.innerWidth;myHeight=window.innerHeight;}else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){myWidth=document.documentElement.clientWidth;myHeight=document.documentElement.clientHeight;}else if(document.body&&(document.body.clientWidth||document.body.clientHeight)){myWidth=document.body.clientWidth;myHeight=document.body.clientHeight;}
return([myWidth,myHeight]);};this.cookie={set:function(n,v,d,dm){var e="";if(d){var f=new Date();f.setTime(f.getTime()+(d*86400000));e="; expires="+f.toGMTString();}
var dmn='';if(dm){dmn="domain="+dm;}
document.cookie=n+"="+v+e+"; path=/; "+dmn;},get:function(n){var e=n+"=";var ca=document.cookie.split(';');for(var i=0,ilen=ca.length;i<ilen;i++){var c=ca[i];while(c.charAt(0)===' '){c=c.substring(1,c.length);}
if(c.indexOf(e)===0){return c.substring(e.length,c.length);}}
return null;},erase:function(n,dm){this.set(n,"",-1,dm);}};this.openTarget=function(url){try{this.markDisplayed();var size=this.getWindowSize();var width=this.options.targetFullScreen?screen.availWidth||screen.width||size[0]:this.options.targetWidth;var height=this.options.targetFullScreen?screen.availHeight||screen.height||size[1]:this.options.targetHeight;var win=window.open(url,'targetwindow','location=1,status=1,scrollbars=1,resizable=yes,width='+width+',height='+height);win.resizeTo(width,height);setTimeout(function(){try{win.moveTo(0,0);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},100);}catch(e){}
this.destroyPopunder();};this.impress=function(url){if(url){var i=document.createElement('img');i.style.display='none';i.src=url;i.alt='';document.body.appendChild(i);}};};}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},"runRelay":function(e){try{if(window.QSI.Relay===undefined||window.QTest){QSI.Relay=QSI.util.Creative(QSI.BuildElementModule,{initialize:function(options){this.globalInitialize(options);this.elements=options.elements.Elements||[];this.shouldAnchor=true;this.removed=false;var widgetOptions={close:parseInt(this.displayOptions.close,10),delay:parseInt(this.displayOptions.delay,10)};if(this.shouldShow()){QSI.util.processLocators(this.elements,widgetOptions);this.container=this.build();document.body.appendChild(this.container);this.initializeIframes();var that=this;QSI.util.when(this.container.loadDefers,QSI.util.getTimeout(this.displayOptions.delay))
.done(function(){if(!this.removed){that.display();}});}},display:function(){this.resetStyles();QSI.util.stopScrolling();QSI.util.setStyle(this.container,{display:'block'});this.impress();var autoClose=this.displayOptions.close;var that=this;if(autoClose&&autoClose>0){this.displayed.done(function(){setTimeout(function(){try{that.close();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},autoClose*1000);});}
this.resizeHandler=function(){try{that.resize();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};this.reposition();this.displayed.resolve();QSI.util.observe(window,'resize',this.resizeHandler);},build:function(){var elements=[];var elDefers=[];for(var i=0,ilen=this.elements.length;i<ilen;i++){var el=this.buildElement(this.elements[i]);if(!el){continue;}
elements.push(el);elDefers.push(el.loadingDeferred);}
var pageSize=QSI.util.getPageSize();var options=this.options.containerElement,backgroundColor=options.style.backgroundColor,backgroundImage=options.style.backgroundImage;var position='fixed';if(!QSI.util.isFixed()){position='absolute';}
var container=QSI.util.build('div',{className:'QSIRelay',style:{'backgroundColor':backgroundColor,'backgroundImage':(backgroundImage)?'url('+backgroundImage+')':'','zIndex':1999999000,'height':pageSize.height+'px','width':pageSize.width+'px','position':position,'left':0,'top':0,'display':'none'}},elements);container.loadDefers=QSI.util.when.apply(this,elDefers);return container;},reposition:function(){if(this.container&&!QSI.util.isFixed()){var scrollOffset=QSI.util.getScrollOffsets();QSI.util.setStyle(this.container,{'left':(scrollOffset.left)?scrollOffset.left+'px':0,'top':(scrollOffset.top)?scrollOffset.top+'px':0});}},close:function(){this.removed=true;this.cleanupImpressElement();if(this.container){document.body.removeChild(this.container);QSI.util.startScrolling();this.container=null;QSI.util.stopObserving(window,'resize',this.resizeHandler);}},refreshContainerSize:function(){var pageSize=QSI.util.getPageSize();QSI.util.setStyle(this.container,{'height':pageSize.height+'px','width':pageSize.width+'px'});},resize:function(){this.refreshContainerSize();}});}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},"runScreenCapture":function(e){try{if(window.QSI.ScreenCaptureRectangle===undefined||window.QTest){QSI.ScreenCaptureRectangle=QSI.util.Class({initialize:function(originalCanvas,drawInterval){this.isCanvasDirty=false;this.rectangles=[];this.canvas=QSI.util.build('canvas',{'data-qsi-sc-class':'qsi_sc_annotations_canvas',width:originalCanvas.width,height:originalCanvas.height},[]);this.context=this.canvas.getContext('2d');this.selectedRectangle=null;this.clickedObject=null;this.setupMouseListeners();setInterval(this.mainDraw.bind(this),drawInterval);},getCanvas:function(){return this.canvas;},getCleanedCanvas:function(){if(this.selectedRectangle){this.selectedRectangle.deselect();}
this.isCanvasDirty=true;this.mainDraw();return this.canvas;},addRectangle:function(x,y,w,h,color,opacity){if(!opacity){opacity=1;}
var rectangle=new this.Rectangle(this,x,y,w,h,color,opacity);this.rectangles.push(rectangle);rectangle.select();this.isCanvasDirty=true;},save:function(){this.savedRectangles=[];this.cloneRectangles(this.rectangles,this.savedRectangles);},cancel:function(){if(this.savedRectangles){this.cloneRectangles(this.savedRectangles,this.rectangles);}else{this.rectangles=[];}
this.isCanvasDirty=true;},cloneRectangles:function(fromRectangles,toRectangles){toRectangles.splice(0,toRectangles.length);for(var i=0;i<fromRectangles.length;i++){var fromRectangle=fromRectangles[i];toRectangles.push(new this.Rectangle(this,fromRectangle.x,fromRectangle.y,fromRectangle.w,fromRectangle.h,fromRectangle.color,fromRectangle.opacity));}},mainDraw:function(){try{if(!this.isCanvasDirty){return;}
this.clearContext(this.context);for(var i=0;i<this.rectangles.length;i++){this.rectangles[i].draw(this.context);}
this.isCanvasDirty=false;}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},setupMouseListeners:function(){this.mouseState={isMouseDown:false,mouseDownPosition:{x:0,y:0}};QSI.util.observe(this.canvas,'mousedown',this.mouseDownHandler.bind(this));QSI.util.observe(this.canvas,'mousemove',this.mouseMoveHandler.bind(this));QSI.util.observe(this.canvas,'mouseup',this.upHandler.bind(this));QSI.util.observe(this.canvas,'mouseout',this.upHandler.bind(this));QSI.util.observe(this.canvas,'touchstart',this.touchStartHandler.bind(this));QSI.util.observe(this.canvas,'touchmove',this.touchMoveHandler.bind(this));QSI.util.observe(this.canvas,'touchend',this.upHandler.bind(this));},mouseDownHandler:function(evt){try{var mouseLoc=this.getMouseLocationInCanvas(evt);if(!mouseLoc){return;}
this.downHandler(evt,mouseLoc.x,mouseLoc.y);evt.preventDefault();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},touchStartHandler:function(evt){try{var touchLoc=this.getTouchLocationInCanvas(evt);if(!touchLoc){return;}
this.downHandler(evt,touchLoc.x,touchLoc.y);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},downHandler:function(evt,x,y){evt.preventDefault();this.mouseState.isMouseDown=true;this.mouseState.mouseDownPosition.x=x;this.mouseState.mouseDownPosition.y=y;this.clickedObject=this.getObjectAtCoordinates(x,y);if(this.clickedObject){this.clickedObject.select();}
this.isCanvasDirty=true;if(this.clickedObject!==this.selectedRectangle&&!(this.clickedObject instanceof this.ResizePoint)&&!(this.clickedObject instanceof this.RemoveButton)){this.selectedRectangle.deselect();this.selectedRectangle=null;}
this.isCanvasDirty=true;},mouseMoveHandler:function(evt){try{var mouseLoc=this.getMouseLocationInCanvas(evt);this.moveHandler(evt,mouseLoc.x,mouseLoc.y);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},touchMoveHandler:function(evt){try{var touchLoc=this.getTouchLocationInCanvas(evt);if(touchLoc.x<0||touchLoc.x>this.canvas.width||touchLoc.y<0||touchLoc.y>this.canvas.height){this.upHandler(evt);return;}
this.moveHandler(evt,touchLoc.x,touchLoc.y);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},moveHandler:function(evt,x,y){evt.preventDefault();if(!this.mouseState.isMouseDown){var hoveredObject=this.getObjectAtCoordinates(x,y);if(hoveredObject){hoveredObject.hover(this.canvas);}else{this.canvas.style.cursor='auto';}
return;}
var deltaX=x-this.mouseState.mouseDownPosition.x;var deltaY=y-this.mouseState.mouseDownPosition.y;if(this.clickedObject){this.clickedObject.drag(deltaX,deltaY);}
this.mouseState.mouseDownPosition.x=x;this.mouseState.mouseDownPosition.y=y;this.isCanvasDirty=true;},upHandler:function(evt){try{this.mouseState.isMouseDown=false;evt.preventDefault();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},getTouchLocationInCanvas:function(evt){if(!evt||!evt.targetTouches||!evt.targetTouches[0]){return null;}
var touch=evt.targetTouches[0];return this.getLocationInCanvas(touch.clientX,touch.clientY);},getMouseLocationInCanvas:function(evt){if(!evt){return null;}
return this.getLocationInCanvas(evt.clientX,evt.clientY);},getLocationInCanvas:function(x,y){this.canvas.getBoundingClientRect();var canvasTopOffset=parseInt(this.canvas.parentElement.style.top,10);var canvasLeftOffset=parseInt(this.canvas.parentElement.style.left,10);x-=canvasLeftOffset;y-=canvasTopOffset;return{x:x,y:y};},getObjectAtCoordinates:function(x,y){var objectsToCheck=[];if(this.selectedRectangle){objectsToCheck.push(this.selectedRectangle.removeButton);var resizePoints=this.selectedRectangle.resizePoints;for(var i=0;i<resizePoints.length;i++){objectsToCheck.push(resizePoints[i]);}}
for(var j=this.rectangles.length-1;j>=0;j--){objectsToCheck.push(this.rectangles[j]);}
for(var k=0;k<objectsToCheck.length;k++){if(objectsToCheck[k].isAtLocation(x,y)){return objectsToCheck[k];}}
return null;},clearContext:function(context){context.clearRect(0,0,this.canvas.width,this.canvas.height);},RemoveButton:QSI.util.Class({initialize:function(rectangle,interactionSquareLength){this.rectangle=rectangle;this.xOffset=18;this.yOffset=-16;this.interactionSquareLength=interactionSquareLength;},getButtonLocation:function(){var x=this.rectangle.x+this.rectangle.w+this.xOffset;var y=this.rectangle.y+this.yOffset;return{x:x,y:y};},isAtLocation:function(x,y){var buttonLocation=this.getButtonLocation();var halfSquareLength=this.interactionSquareLength/2;return x>=(buttonLocation.x-halfSquareLength)&&x<=(buttonLocation.x+halfSquareLength)&&y>=(buttonLocation.y-halfSquareLength)&&y<=(buttonLocation.y+halfSquareLength);},select:function(){this.rectangle.destroy();},hover:function(canvas){canvas.style.cursor='pointer';},drag:function(){},draw:function(context){var buttonLocation=this.getButtonLocation();this.drawHelper(context,buttonLocation.x,buttonLocation.y,4,5,'white',0.5);this.drawHelper(context,buttonLocation.x,buttonLocation.y,2,4,'black',1);},drawHelper:function(context,x,y,lineWidth,radius,color,opacity){context.beginPath();context.lineWidth=lineWidth;context.strokeStyle=color;context.lineCap='round';context.globalAlpha=opacity;context.moveTo(x-radius,y-radius);context.lineTo(x+radius,y+radius);context.stroke();context.moveTo(x+radius,y-5);context.lineTo(x-radius,y+radius);context.stroke();}}),ResizePoint:QSI.util.Class({initialize:function(rectangleAnnotations,rectangle,direction,circleRadius,interactionSquareLength){this.rectangleAnnotations=rectangleAnnotations;this.rectangle=rectangle;this.direction=direction;this.circleRadius=circleRadius;this.interactionSquareLength=interactionSquareLength;},getPointLocation:function(){var x=0;var y=0;switch(this.direction){case'nw':x=this.rectangle.x;y=this.rectangle.y;break;case'ne':x=this.rectangle.x+this.rectangle.w;y=this.rectangle.y;break;case'se':x=this.rectangle.x+this.rectangle.w;y=this.rectangle.y+this.rectangle.h;break;case'sw':x=this.rectangle.x;y=this.rectangle.y+this.rectangle.h;break;}
return{x:x,y:y};},isAtLocation:function(x,y){var pointLocation=this.getPointLocation();var halfSquareLength=this.interactionSquareLength/2;return x>=(pointLocation.x-halfSquareLength)&&x<=(pointLocation.x+halfSquareLength)&&y>=(pointLocation.y-halfSquareLength)&&y<=(pointLocation.y+halfSquareLength);},draw:function(context){var pointLocation=this.getPointLocation();context.beginPath();context.arc(pointLocation.x,pointLocation.y,this.circleRadius,0,2*Math.PI,false);context.fillStyle='red';context.fill();context.lineWidth=1;context.strokeStyle='red';context.stroke();},select:function(){},drag:function(deltaX,deltaY){switch(this.direction){case'nw':this.transform(deltaX,deltaY,-deltaX,-deltaY);break;case'ne':this.transform(0,deltaY,deltaX,-deltaY);break;case'se':this.transform(0,0,deltaX,deltaY);break;case'sw':this.transform(deltaX,0,-deltaX,deltaY);break;}},transform:function(deltaX,deltaY,deltaW,deltaH){if(this.rectangle.x+deltaX<0){this.rectangle.x=0;}else if(this.rectangle.w+deltaW<0){this.rectangle.w=0;}else if(this.rectangle.x+deltaX+this.rectangle.w+deltaW>this.rectangleAnnotations.canvas.width){this.rectangle.w=this.rectangleAnnotations.canvas.width-this.rectangle.x;}else{this.rectangle.x+=deltaX;this.rectangle.w+=deltaW;}
if(this.rectangle.y+deltaY<0){this.rectangle.y=0;}else if(this.rectangle.h+deltaH<0){this.rectangle.h=0;}else if(this.rectangle.y+deltaY+this.rectangle.h+deltaH>this.rectangleAnnotations.canvas.height){this.rectangle.h=this.rectangleAnnotations.canvas.height-this.rectangle.y;}else{this.rectangle.y+=deltaY;this.rectangle.h+=deltaH;}},hover:function(canvas){switch(this.direction){case'nw':case'se':canvas.style.cursor='nwse-resize';break;case'ne':case'sw':canvas.style.cursor='nesw-resize';}}}),Rectangle:QSI.util.Class({initialize:function(rectangleAnnotations,x,y,w,h,color,opacity){this.rectangleAnnotations=rectangleAnnotations;this.x=x;this.y=y;this.w=w;this.h=h;this.color=color;this.opacity=opacity?opacity:1;this.resizePoints=[];this.removeButton=null;this.isSelected=false;},isAtLocation:function(x,y){return x>=this.x&&x<=(this.x+this.w)&&y>=this.y&&y<=(this.y+this.h);},select:function(){if(this.resizePoints.length===0){var resizeDirections=['nw','ne','se','sw'];for(var i=0;i<resizeDirections.length;i++){this.resizePoints.push(new this.rectangleAnnotations.ResizePoint(this.rectangleAnnotations,this,resizeDirections[i],3,24));}}
if(!this.removeButton){this.removeButton=new this.rectangleAnnotations.RemoveButton(this,26);}
if(this.rectangleAnnotations.selectedRectangle){this.rectangleAnnotations.selectedRectangle.deselect();}
this.rectangleAnnotations.selectedRectangle=this;this.isSelected=true;},deselect:function(){this.isSelected=false;},destroy:function(){this.rectangleAnnotations.selectedRectangle=null;var rectangles=this.rectangleAnnotations.rectangles;rectangles.splice(rectangles.indexOf(this),1);},draw:function(context){context.fillStyle=this.color;context.globalAlpha=this.opacity;context.fillRect(this.x,this.y,this.w,this.h);context.globalAlpha=1;if(this.isSelected){context.strokeStyle='red';context.lineWidth=1;context.strokeRect(this.x,this.y,this.w,this.h);for(var i=0;i<this.resizePoints.length;i++){this.resizePoints[i].draw(context);}
this.removeButton.draw(context);}},drag:function(deltaX,deltaY){this.x+=deltaX;this.y+=deltaY;if(this.x<0){this.x=0;}
if(this.y<0){this.y=0;}
if(this.x+this.w>this.rectangleAnnotations.canvas.width){this.x=this.rectangleAnnotations.canvas.width-this.w;}
if(this.y+this.h>this.rectangleAnnotations.canvas.height){this.y=this.rectangleAnnotations.canvas.height-this.h;}},hover:function(canvas){canvas.style.cursor='move';}})});}
if(window.QSI.ScreenCaptureHandler===undefined||window.QTest){QSI.ScreenCaptureHandler=QSI.util.Class({initialize:function(intercept,embeddedTarget,surveySessionId,translations,surveyOrigin){this.defaultScreenCaptureTimeout=10000;this.intercept=intercept;this.embeddedTarget=embeddedTarget;this.surveySessionId=surveySessionId;this.scZIndex=QSI.global.currentZIndex++;this.translations=translations||{};this.surveyOrigin=surveyOrigin;this.createCapturingScreen(this.translations);},createCapturingScreen:function(translations){var that=this;var scBackDrop=QSI.util.build('div',{'data-qsi-sc-class':'qsi_sc_backdrop',style:{width:'100%',height:'100%',backgroundColor:'black',opacity:'0.7',filter:'alpha(opacity=70)',position:'fixed',top:'0px',left:'0px',zIndex:this.scZIndex-1}},[]);var scLoadingIconWidth=100;var scLoadingIcon=QSI.util.build('img',{'data-qsi-sc-class':'qsi_sc_loading_icon',src:QSI.baseURL+'../WRQualtricsShared/Graphics/siteintercept/building_preview.gif',style:{width:scLoadingIconWidth+'px'},alt:''},[]);var scCancelCaptureButton=QSI.util.build('img',{'data-qsi-sc-class':'qsi_sc_cancel_capture_button',src:QSI.baseURL+'../WRQualtricsShared/Graphics/siteintercept/remove_screen_capture.png',title:'Cancel Capturing Screen',style:{'-webkit-filter':'brightness(0) invert(1)',filter:'brightness(0) invert(1)',display:'block',width:'15px',height:'15px',marginLeft:scLoadingIconWidth+'px',cursor:'pointer'},alt:'Cancel'},[]);this.isScreenCaptureCancelled=false;QSI.util.observe(scCancelCaptureButton,'click',function(){try{that.isScreenCaptureCancelled=true;that.hideCapturingScreen();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});var scBuildingPreviewText=QSI.util.build('div',{'data-qsi-sc-class':'qsi_sc_building_preview_text',style:{color:'white'}},[]);scBuildingPreviewText.innerText=translations.ScreenCaptureBuilding||'Building Preview ...';var viewportWidth=parseInt(window.innerWidth,10);var viewportHeight=parseInt(window.innerHeight,10);this.scCapturingScreen=QSI.util.build('div',{'data-qsi-sc-class':'qsi_sc_capturing_screen',style:{position:'fixed',top:(viewportHeight/2)+'px',left:(viewportWidth/2)+'px',marginTop:(scLoadingIconWidth/-2)+'px',marginLeft:(scLoadingIconWidth/-2)+'px',zIndex:this.scZIndex}},[scCancelCaptureButton,scLoadingIcon,scBuildingPreviewText]);this.scScreen=QSI.util.build('div',{className:'QSI_ScreenCapture',style:{visibility:'hidden'}},[scBackDrop,this.scCapturingScreen]);document.body.appendChild(this.scScreen);},showCapturingScreen:function(){this.setInterceptVisibilty('hidden');this.scScreen.style.visibility='visible';},hideCapturingScreen:function(){this.setInterceptVisibilty('visible');this.scScreen.style.visibility='hidden';},setInterceptVisibilty:function(visibility){if(this.intercept.container){this.intercept.container.style.visibility=visibility;}else if(this.intercept.link&&(this.intercept.type==='FeedbackLink')){this.intercept.link.style.visibility=visibility;}else if(this.intercept.bar){this.intercept.bar.style.visibility=visibility;}
if(this.intercept.embeddedWindows){for(var i=0;i<this.intercept.embeddedWindows.length;i++){this.intercept.embeddedWindows[i].container.style.visibility=visibility;}}},captureScreen:function(questionId){this.showCapturingScreen();var doc=this.getCleanedHTML();var html5Doctype='<!DOCTYPE html>';var html=html5Doctype+doc.documentElement.innerHTML;var that=this;var clientVersionQueryString='';if(QSI.Orchestrator&&QSI.Orchestrator.getClientVersionQueryString){clientVersionQueryString='?'+QSI.Orchestrator.getClientVersionQueryString();}
var payload={html:html,viewportData:this.getViewPortDimensions(),url:window.location.href,browserType:'CHROME'};QSI.util.sendHttpRequest({type:'POST',url:QSI.global.screenCaptureServiceBaseURL+'screencapture'+clientVersionQueryString,header:{'Content-type':'application/json'},data:JSON.stringify(payload),successCallback:function(http){var response;if(http.response){response=JSON.parse(http.response);}else{response=JSON.parse(http.responseText);}
var imageData='data:image/jpeg;base64,'+response.imageData;if(that.isScreenCaptureCancelled){that.isScreenCaptureCancelled=false;return;}
that.succeededScreenCapture(questionId,imageData,that.translations);},errorCallback:function(http){if(that.isScreenCaptureCancelled){that.isScreenCaptureCancelled=false;return;}
that.failedScreenCapture('ScreenCapture call POST request to '+QSI.global.screenCaptureServiceBaseURL+
'screencapture returned with readyState='+http.readyState+' and status='+http.status,that.translations);},timeout:QSI.overrides.screenCaptureTimeout?QSI.overrides.screenCaptureTimeout:this.defaultScreenCaptureTimeout,timeoutCallback:function(){QSI.dbg.e('ScreenCapture call POST request to '+QSI.global.screenCaptureServiceBaseURL+
'screencapture timed out');}});},editAnnotations:function(questionId){if(!this.screenCaptureAnnotationsMap||!this.screenCaptureAnnotationsMap[questionId]){return;}
this.screenCaptureAnnotationsMap[questionId].showAnnotationsArea();},succeededScreenCapture:function(questionId,imageData,translations){this.scScreen.style.visibility='hidden';if(!this.screenCaptureAnnotationsMap){this.screenCaptureAnnotationsMap={};}
this.screenCaptureAnnotationsMap[questionId]=new QSI.ScreenCaptureAnnotations(this,questionId,imageData,translations||{});},saveScreenCapture:function(questionId,imageData){this.setInterceptVisibilty('visible');var message={event:'saveScreenCapture',from:'SI',to:'JFE',sessionId:this.surveySessionId,questionId:questionId,imageData:imageData};this.sendMessageToSurvey(message);},failedScreenCapture:function(failureMessage,translations){QSI.dbg.e(failureMessage);this.scScreen.style.visibility='visible';this.scCapturingScreen.style.visibility='hidden';var scFailureMessage=QSI.util.build('p',{'data-qsi-sc-class':'qsi_sc_failure_message',style:{textAlign:'left',width:'150px',fontSize:'13px',lineHeight:'18px',marginTop:'5px',marginBottom:'10px'}},[]);scFailureMessage.innerText=translations.ScreenCaptureBuildingFailed||"Sorry, we couldn't create a screenshot. Please try again later.";var scFailureIcon=QSI.util.build('img',{'data-qsi-sc-class':'qsi_sc_failure_icon',src:QSI.baseURL+'../WRQualtricsShared/Graphics/siteintercept/error_icon.png',style:{display:'inline-block',verticalAlign:'top',height:'30px',width:'30px',marginTop:'7px'},alt:'Error'},[]);var scFailureConfirm=QSI.util.build('p',{'data-qsi-sc-class':'qsi_sc_failure_confirm',style:{display:'table-cell',verticalAlign:'middle',backgroundColor:'#1cb06f',color:'white',width:'100px',height:'30px',borderRadius:'5px',fontSize:'13px',cursor:'pointer'}},[]);scFailureConfirm.innerText=translations.ScreenCaptureOK||'OK';var scFailureMessageContainer=QSI.util.build('div',{'data-qsi-sc-class':'qsi_sc_failure_message_container',style:{display:'inline-block',marginLeft:'15px'}},[scFailureMessage,scFailureConfirm]);var scFailurePopOver=QSI.util.build('div',{'data-qsi-sc-class':'qsi_sc_failure_popover',style:{position:'fixed',top:'50%',left:'50%',marginTop:'-55px',marginLeft:'-110px',width:'220px',height:'110px',textAlign:'center',fontFamily:'Arial',borderRadius:'3px',background:'rgba(255, 255, 255, 0.95)',zIndex:this.scZIndex}},[scFailureIcon,scFailureMessageContainer]);var that=this;QSI.util.observe(scFailureConfirm,'click',function(){try{QSI.util.remove(scFailurePopOver);that.scCapturingScreen.style.visibility='inherit';that.hideCapturingScreen();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});this.scScreen.appendChild(scFailurePopOver);},removeScreenCapture:function(questionId){if(!this.screenCaptureAnnotationsMap||!this.screenCaptureAnnotationsMap[questionId]){return;}
this.screenCaptureAnnotationsMap[questionId].destroyAnnotationsArea();delete this.screenCaptureAnnotationsMap[questionId];},removeAllScreenCaptures:function(){if(!this.screenCaptureAnnotationsMap){return;}
for(var questionId in this.screenCaptureAnnotationsMap){if(Object.prototype.hasOwnProperty.call(this.screenCaptureAnnotationsMap,questionId)){this.removeScreenCapture(questionId);}}},getCleanedHTML:function(){var doc=document.cloneNode(true);var originalElements=document.body.getElementsByTagName('*');var copiedElements=doc.body.getElementsByTagName('*');var adsArray=[];for(var i=0;i<copiedElements.length;i++){if(window.getComputedStyle){var computedStyle=QSI.util.getComputedStyle(originalElements[i]);copiedElements[i].style.boxSizing=computedStyle.boxSizing;var beforeDisplay=window.getComputedStyle(originalElements[i],':before').display;var afterDisplay=window.getComputedStyle(originalElements[i],':after').display;if(beforeDisplay==='table'||beforeDisplay==='block'||afterDisplay==='table'||afterDisplay==='block'){copiedElements[i].style.height=computedStyle.height;}
copiedElements[i].style.display=computedStyle.display;if(parseInt(computedStyle.height,10)===0){copiedElements[i].style.height='0px';}
if(this.isElementAdvertisement(copiedElements[i])){var adReplacementText=QSI.util.build('span',{style:{color:'black',fontSize:'15px',lineHeight:'15px'}},[]);adReplacementText.innerText='ADVERTISEMENT';var adReplacement=QSI.util.build('div',{style:{width:computedStyle.width,height:computedStyle.height,backgroundColor:'white',border:'1px solid black',padding:'3px',textAlign:'center'}},[adReplacementText]);adsArray.push({originalElement:copiedElements[i],replacementElement:adReplacement});}}}
for(var j=0;j<adsArray.length;j++){adsArray[j].originalElement.parentNode.replaceChild(adsArray[j].replacementElement,adsArray[j].originalElement);}
if(!document.body.style.backgroundColor){doc.body.setAttribute('style',doc.body.getAttribute('style')+'; background-color:white;');}
QSI.util.removeAllByQuery(doc,'noscript');QSI.util.removeAllByQuery(doc,'[data-qsi-sc-class="qsi_sc_capturing_screen"]');QSI.util.removeAllByQuery(doc,'[data-qsi-sc-class="qsi_sc_backdrop"]');QSI.util.removeAllByQuery(doc.head,'iframe');return doc;},isElementAdvertisement:function(element){if(element.tagName.toLowerCase()==='div'&&element.id.indexOf('google_ads_iframe')!==-1){return true;}
return false;},getViewPortDimensions:function(){var scrollOffsets=QSI.util.getScrollOffsets();return{width:window.innerWidth,height:window.innerHeight,top:scrollOffsets.top,left:scrollOffsets.left};},sendMessageToSurvey:function(message){var string_message=JSON.stringify(message);this.embeddedTarget.postMessage(string_message,this.surveyOrigin);}});}
if(!QSI.screenCaptureListenerRegistered){QSI.screenCaptureListenerRegistered=true;window.addEventListener("message",function(event){try{if(QSI.Orchestrator&&QSI.Orchestrator.isMessageEventOriginAllowed&&!QSI.Orchestrator.isMessageEventOriginAllowed(event.origin)){return;}
var intercept=QSI.util.getOriginInterceptOfMessage(event.source);if(!intercept){return;}
var messageObject=event.data;if(typeof messageObject==='string'){try{messageObject=JSON.parse(messageObject);}catch(e){return;}}
if(!messageObject||messageObject.from!=='JFE'||messageObject.to!=='SI'){return;}
if(!QSI.screenCaptureHandlers){QSI.screenCaptureHandlers={};}
if(messageObject.event==='canScreenCapture'){var canScreenCaptureMessage={event:'canScreenCapture',from:'SI',to:'JFE',canScreenCapture:true};event.source.postMessage(JSON.stringify(canScreenCaptureMessage),event.origin);return;}
if(!QSI.screenCaptureHandlers[messageObject.sessionId]){QSI.screenCaptureHandlers[messageObject.sessionId]=new QSI.ScreenCaptureHandler(intercept,event.source,messageObject.sessionId,messageObject.translations);}
switch(messageObject.event){case'startScreenCapture':QSI.screenCaptureHandlers[messageObject.sessionId].captureScreen(messageObject.questionId);break;case'editScreenCapture':QSI.screenCaptureHandlers[messageObject.sessionId].editAnnotations(messageObject.questionId);break;case'removeScreenCapture':QSI.screenCaptureHandlers[messageObject.sessionId].removeScreenCapture(messageObject.questionId);break;case'sessionFinished':QSI.screenCaptureHandlers[messageObject.sessionId].removeAllScreenCaptures();break;default:return;}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});}
if(window.QSI.ScreenCaptureAnnotations===undefined||window.QTest){QSI.ScreenCaptureAnnotations=QSI.util.Class({initialize:function(screenCaptureHandler,questionId,imageData,translations){this.annotationsZIndex=QSI.global.currentZIndex++;this.isScreenCaptureSaved=false;this.createAnnotationsArea(screenCaptureHandler,questionId,imageData,translations);},createAnnotationsArea:function(screenCaptureHandler,questionId,imageData,translations){var actionsBarHeight=36;var actionsBarBottomMargin=8;var viewportWidth=parseInt(window.innerWidth,10);var viewportHeight=parseInt(window.innerHeight,10);var annotationsAreaPercentage=0.95;var annotationsAreaMargin=(viewportHeight*(1-0.95))/2;var annotationsAreaPadding=8;var canvasHeight=(viewportHeight*annotationsAreaPercentage)-
actionsBarHeight-actionsBarBottomMargin-(2*annotationsAreaPadding);var imageScale=canvasHeight/viewportHeight;var canvasWidth=imageScale*viewportWidth;var annotationsCanvas=this.createCanvas(imageData,canvasWidth,canvasHeight);var annotationsActionsBar=this.createActionsBar(screenCaptureHandler,questionId,annotationsCanvas,actionsBarHeight,actionsBarBottomMargin,translations);var screenCaptureRectangleCanvas=this.screenCaptureRectangle.getCanvas();QSI.util.setStyle(screenCaptureRectangleCanvas,{position:'absolute',top:annotationsAreaPadding+'px',left:annotationsAreaPadding+'px'});var borderRadiusSetting='6px';var annotationsArea=QSI.util.build('div',{'data-qsi-sc-class':'qsi_sc_captured_image_area',style:{position:'fixed',top:annotationsAreaMargin+'px',left:(viewportWidth/2-canvasWidth/2)+'px',width:canvasWidth+'px',zIndex:this.annotationsZIndex,backgroundColor:'white',boxSizing:'content-box',padding:annotationsAreaPadding+'px',borderRadius:borderRadiusSetting,mozBorderRadius:borderRadiusSetting,boxShadow:'0px 0px 16px 0px rgba(0,0,0,0.5)'}},[annotationsCanvas,screenCaptureRectangleCanvas,annotationsActionsBar]);this.annotationsScreen=QSI.util.build('div',{className:'QSI_ScreenCaptureAnnotations'},[this.createBackDrop(),annotationsArea]);document.body.appendChild(this.annotationsScreen);},createActionsBar:function(screenCaptureHandler,questionId,annotationsCanvas,actionsBarHeight,actionsBarCanvasMargin,translations){var saveActions=this.createSaveActions(screenCaptureHandler,questionId,annotationsCanvas,actionsBarHeight,translations);var annotationActions=this.createAnnotationActions(annotationsCanvas,actionsBarHeight);return QSI.util.build('div',{'data-qsi-sc-class':'qsi_sc_actions_bar',style:{width:'100%',height:actionsBarHeight+'px',marginTop:actionsBarCanvasMargin+'px'}},[annotationActions,saveActions]);},createAnnotationActions:function(annotationsCanvas,actionsBarHeight){this.screenCaptureRectangle=new QSI.ScreenCaptureRectangle(annotationsCanvas,5);var iconSize=23;var spriteSheetUrl=QSI.baseURL+'../WRQualtricsShared/Graphics/siteintercept/sc_annotations_sprites.png';var highlightButton=QSI.util.build('div',{'data-qsi-sc-class':'qsi_sc_highlight_button',title:'Highlight',style:{display:'inline-block',height:iconSize+'px',width:iconSize+'px',cursor:'pointer',background:'url('+spriteSheetUrl+') 139px 0px'}},[]);var blackOutButton=QSI.util.build('div',{'data-qsi-sc-class':'qsi_sc_blackout_button',title:'Blackout',style:{display:'inline-block',height:iconSize+'px',width:iconSize+'px',cursor:'pointer',marginLeft:'8px',background:'url('+spriteSheetUrl+') 110px 0px'}},[]);var canvasMidX=parseInt(annotationsCanvas.width,10)/2;var canvasMidY=parseInt(annotationsCanvas.height,10)/2;var rectWidth=100;var rectHeight=50;var that=this;QSI.util.observe(highlightButton,'click',function(){try{that.screenCaptureRectangle.addRectangle(canvasMidX-(rectWidth/2),canvasMidY-(rectHeight/2),rectWidth,rectHeight,'yellow',0.3);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});QSI.util.observe(blackOutButton,'click',function(){try{that.screenCaptureRectangle.addRectangle(canvasMidX-(rectWidth/2),canvasMidY-(rectHeight/2),rectWidth,rectHeight,'black',1);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});var actionsBarPadding=((actionsBarHeight-iconSize)/2);var annotationActions=QSI.util.build('div',{'data-qsi-sc-class':'qsi_sc_annotation_actions',style:{'float':'left',boxSizing:'border-box',height:actionsBarHeight+'px',padding:actionsBarPadding+'px',backgroundColor:'white'}},[highlightButton,blackOutButton]);return annotationActions;},createSaveActions:function(screenCaptureHandler,questionId,annotationsCanvas,actionsBarHeight,translations){translations=translations||{};var annotationsCancelButton=QSI.util.build('div',{'data-qsi-sc-class':'qsi_sc_annotations_cancel_button',style:{display:'inline-block',fontSize:'15px',color:'black',cursor:'pointer',lineHeight:'30px'}},[]);var that=this;var cancelActionSequence=function(){try{that.cancelButtonCallback(screenCaptureHandler,questionId);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};QSI.util.observe(annotationsCancelButton,'click',cancelActionSequence);annotationsCancelButton.innerText=translations.ScreenCaptureCancel||"Cancel";var annotationsSaveButton=QSI.util.build('div',{'data-qsi-sc-class':'qsi_sc_annotations_save_button',style:{display:'inline-block',fontSize:'15px',color:'white',backgroundColor:'#14a857',cursor:'pointer',lineHeight:'30px',borderRadius:'4px',padding:'0px 8px 0px 8px',marginLeft:'16px'}},[]);var saveActionSequence=function(){try{that.isScreenCaptureSaved=true;that.hideAnnotationsArea();that.screenCaptureRectangle.save();screenCaptureHandler.saveScreenCapture(questionId,that.getAnnotatedImageData(annotationsCanvas));}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};QSI.util.observe(annotationsSaveButton,'click',saveActionSequence);annotationsSaveButton.innerText=translations.ScreenCaptureSave||"Save";var saveActions=QSI.util.build('div',{'data-qsi-sc-class':'qsi_sc_save_actions',style:{'float':'right',lineHeight:actionsBarHeight+'px'}},[annotationsCancelButton,annotationsSaveButton]);this.escapeCallBack=function(e){try{if(e.keyCode===27){cancelActionSequence();}}catch(ex){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(ex);}}};QSI.util.observe(window,"keydown",this.escapeCallBack);this.returnKeyCallBack=function(e){try{if(e.keyCode===13){saveActionSequence();}}catch(ex){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(ex);}}};QSI.util.observe(window,"keydown",this.returnKeyCallBack);return saveActions;},getAnnotatedImageData:function(annotationsCanvas){var saveCanvas=QSI.util.build('canvas',{width:annotationsCanvas.width,height:annotationsCanvas.height},[]);var saveContext=saveCanvas.getContext('2d');saveContext.drawImage(annotationsCanvas,0,0);saveContext.drawImage(this.screenCaptureRectangle.getCleanedCanvas(),0,0);var imageData=saveCanvas.toDataURL('image/jpeg');return imageData;},cancelButtonCallback:function(screenCaptureHandler,questionId){this.screenCaptureRectangle.cancel();if(this.isScreenCaptureSaved){this.hideAnnotationsArea();}else{screenCaptureHandler.removeScreenCapture(questionId);}
screenCaptureHandler.hideCapturingScreen();},destroyAnnotationsArea:function(){QSI.util.stopObserving(window,"keydown",this.escapeCallBack);QSI.util.stopObserving(window,"keydown",this.returnKeyCallBack);QSI.util.remove(this.annotationsScreen);},hideAnnotationsArea:function(){QSI.util.stopObserving(window,"keydown",this.escapeCallBack);QSI.util.stopObserving(window,"keydown",this.returnKeyCallBack);this.annotationsScreen.style.visibility='hidden';},showAnnotationsArea:function(){QSI.util.observe(window,"keydown",this.escapeCallBack);QSI.util.observe(window,"keydown",this.returnKeyCallBack);this.annotationsScreen.style.visibility='visible';},createCanvas:function(imageData,canvasWidth,canvasHeight){var borderRadiusSetting='4px';var annotationsCanvas=QSI.util.build('canvas',{'data-qsi-sc-class':'qsi_sc_capturedimage_canvas',width:canvasWidth+'px',height:canvasHeight+'px',style:{boxSizing:'border-box',borderRadius:borderRadiusSetting,mozBorderRadius:borderRadiusSetting,boxShadow:'0px 0px 1px 2px rgba(0,0,0,0.1)'}},[]);var context=annotationsCanvas.getContext('2d');var image=new Image();image.onload=function(){context.drawImage(image,0,0,canvasWidth,canvasHeight);};image.src=imageData;return annotationsCanvas;},createBackDrop:function(){return QSI.util.build('div',{'data-qsi-sc-class':'qsi_sc_annotations_backdrop',style:{width:'100%',height:'100%',backgroundColor:'black',opacity:'0.5',filter:'alpha(opacity=70)',position:'fixed',top:'0px',left:'0px',zIndex:this.annotationsZIndex-1}},[]);}});}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},"runHtml":function(e){try{if(window.QSI.UserDefinedHTML===undefined||window.QTest){QSI.UserDefinedHTML=QSI.util.Creative(QSI.BuildElementModule,{initialize:function(options){this.globalInitialize(options);if(this.shouldShow()){this.display();}},display:function(){this.resetStyles();if(this.options.elements){this.elements=this.options.elements.Elements||[];this.minTop=this.options.elements.MinTop;this.minLeft=this.options.elements.MinLeft;QSI.util.processLocators(this.elements);this.node=this.build();if(this.width&&this.height){this.options.size={width:this.width,height:this.height};}}else if(this.options.html){if(this.options.locators){QSI.PipedText.setLocators(this.options.locators);this.options.html=QSI.PipedText.evaluateLocators(this.options.html);}
this.node=QSI.util.build('div',{style:{width:this.options.size.width+"px",height:this.options.size.height+"px",overflow:'hidden'}});if(QSI.global.enableJSSanitization&&typeof QSI.DOMPurify!=='undefined'){this.options.html=QSI.DOMPurify.sanitize(this.options.html);}
this.node.innerHTML=this.options.html;}
this.insert();},build:function(){var elements=[];var maxX=0;var maxY=0;for(var i=0,ilen=this.elements.length;i<ilen;i++){var el=this.buildElement(this.elements[i]);if(!el){continue;}
if(el.bc&&el.bc.x>maxX){maxX=el.bc.x;}
if(el.bc&&el.bc.y>maxY){maxY=el.bc.y;}
elements.push(el);}
this.width=maxX;this.height=maxY;var container=QSI.util.build('div',{className:'QSIUserDefinedHTML '+this.id+'_UserDefinedHTMLContainer',style:{width:maxX+'px',height:maxY+'px',overflow:'hidden',position:'relative'}},elements);return container;},getYPosition:function(position){return(position.top-this.minTop);},getXPosition:function(position){return(position.left-this.minLeft);},getElementStyle:function(style,position){return{top:this.getYPosition(position)+'px',left:this.getXPosition(position)+'px',position:'absolute',zIndex:style.zIndex,width:style.width+'px',height:style.height+'px',backgroundColor:style.backgroundColor,borderWidth:style.borderWidth+'px',borderColor:style.borderColor,borderStyle:'solid',borderRadius:style.borderRadius+'px',display:style.display};},insert:function(){if(this.options.insertionLocation){this.container=QSI.util.$(this.options.insertionLocation);if(!this.container){return;}
this.impress();if(this.displayOptions.replaceContents===undefined||this.displayOptions.replaceContents){this.container.textContent="";}
if(this.displayOptions.customPosition){this.position();}
if(this.displayOptions.insertContentsBefore){if(this.container.parentNode){this.container.parentNode.insertBefore(this.node,this.container);}}else if(this.displayOptions.insertContentsAfter){if(this.container.parentNode){this.container.parentNode.insertBefore(this.node,this.container.nextSibling);}}else{this.container.appendChild(this.node);}
if(this.displayOptions.fixToPage){if(this.displayOptions.minFixDist!==''){this.scrollFix();}else{this.fixPosition();}}
this.initializeIframes();this.displayed.resolve();}},position:function(){if(this.displayOptions.insertContentsBefore||this.displayOptions.insertContentsAfter){return;}
var position=this.displayOptions.position,xoff=(this.displayOptions.xOffset||0)*1,yoff=(this.displayOptions.yOffset||0)*1,cSize=QSI.util.getDimensions(this.container),nSize=this.options.size,vc=cSize.height/2-nSize.height/2,hc=cSize.width/2-nSize.width/2,cStyle={},style={},t,l,b,r;switch(position){default:case'TL':t=0+yoff;l=0+xoff;style={top:t+'px',left:l+'px'};break;case'ML':t=vc+yoff;l=0+xoff;style={top:t+'px',left:l+'px'};break;case'BL':b=0-yoff;l=0+xoff;style={bottom:b+'px',left:l+'px'};break;case'TC':t=0+yoff;l=hc+xoff;style={top:t+'px',left:l+'px'};break;case'MC':t=vc+yoff;l=hc+xoff;style={top:t+'px',left:l+'px'};break;case'BC':b=0-yoff;l=hc+xoff;style={bottom:b+'px',left:l+'px'};break;case'TR':t=0+yoff;r=0-xoff;style={top:t+'px',right:r+'px'};break;case'MR':t=vc+yoff;r=0-xoff;style={top:t+'px',right:r+'px'};break;case'BR':b=0-yoff;r=0-xoff;style={bottom:b+'px',right:r+'px'};break;case'OML':cStyle={overflow:'visible'};l=-nSize.width+xoff;t=vc+yoff;style={top:t+'px',left:l+'px'};break;case'OTLL':cStyle={overflow:'visible'};l=-nSize.width+xoff;t=0+yoff;style={top:t+'px',left:l+'px'};break;case'OTLT':cStyle={overflow:'visible'};l=0+xoff;t=-nSize.height+yoff;style={top:t+'px',left:l+'px'};break;case'OBLL':cStyle={overflow:'visible'};l=-nSize.width+xoff;b=0-yoff;style={bottom:b+'px',left:l+'px'};break;case'OBLB':cStyle={overflow:'visible'};l=0+xoff;b=-nSize.height-yoff;style={bottom:b+'px',left:l+'px'};break;case'OTC':cStyle={overflow:'visible'};l=hc+xoff;t=-nSize.height+yoff;style={top:t+'px',left:l+'px'};break;case'OTRT':cStyle={overflow:'visible'};r=0-xoff;t=-nSize.height+yoff;style={top:t+'px',right:r+'px'};break;case'OTRR':cStyle={overflow:'visible'};r=-nSize.width-xoff;t=0+yoff;style={top:t+'px',right:r+'px'};break;case'OMR':cStyle={overflow:'visible'};r=-nSize.width-xoff;t=vc+yoff;style={top:t+'px',right:r+'px'};break;case'OBRR':cStyle={overflow:'visible'};r=-nSize.width-xoff;b=0-yoff;style={bottom:b+'px',right:r+'px'};break;case'OBRB':cStyle={overflow:'visible'};r=0-xoff;b=-nSize.height-yoff;style={bottom:b+'px',right:r+'px'};break;case'OBC':cStyle={overflow:'visible'};l=hc+xoff;b=-nSize.height-yoff;style={bottom:b+'px',left:l+'px'};break;}
style.position='absolute';cStyle.position='relative';QSI.util.setStyle(this.container,cStyle);QSI.util.setStyle(this.node,style);},scrollFix:function(){var that=this;var minDist=this.displayOptions.minFixDist*1;var oPos=QSI.util.cumulativeOffset(this.node);var f=function(){try{var s=QSI.util.getScrollOffsets().top;if(oPos.top-s<minDist&&!that.fixed){var fix=Math.max(oPos.top-s,minDist);that.fixPosition(fix);}else if(oPos.top-s>minDist&&that.fixed){that.unfixPosition();}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};QSI.util.observe(window,'scroll',f);if(QSI.util.getScrollOffsets().top!==0){f();}},fixPosition:function(optTop){var pos=QSI.util.cumulativeOffset(this.node);var top=pos.top;if(optTop!==undefined){top=optTop;}
QSI.util.setStyle(this.node,{top:top+'px',left:pos.left+'px',position:'fixed'});this.fixed=true;var that=this;var currheight=0;var fr=function(){try{that.finishResize();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};if(!this.resizeW){this.resizeW=QSI.util.observe(window,'resize',function(){try{if(currheight!==QSI.util.getPageSize().height){if(!that.resizing){that.unfixPosition();that.resizing=true;that.resizeW=setTimeout(fr,500);}else{clearTimeout(that.resizeW);that.resizeW=setTimeout(fr,500);}
currheight=QSI.util.getPageSize().height;}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});}},finishResize:function(){this.resizing=false;clearTimeout(this.resizeW);this.fixPosition();},unfixPosition:function(){if(this.resizeW){clearTimeout(this.resizeW);}
QSI.util.setStyle(this.node,{top:'auto',left:'auto',position:'fixed'});this.position();this.fixed=false;},remove:function(){if(this.node){QSI.util.remove(this.node);}
this.cleanupImpressElement();}});}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},"runSlider":function(e){try{if(window.QSI.Slider===undefined||window.QTest){QSI.Slider=QSI.util.Creative(QSI.BuildElementModule,{pos:{B:'bottom',T:'top',L:'left',R:'right',BL:'bottomleft',TL:'topleft',BR:'bottomright',TR:'topright'},anchor:{T:'top',B:'bottom'},shadowPadding:20,initialize:function(options){this.globalInitialize(options);this.elements=options.elements.Elements||[];this.targetType=options.targetType;this.state='in';this.removed=false;this.minTop=options.elements.MinTop;this.minLeft=options.elements.MinLeft;this.hasCreativeEmbeddedTarget=options.hasCreativeEmbeddedTarget;var that=this;this.userOpened=false;this.userClosed=false;QSI.util.processLocators(this.elements);if(this.shouldShow()){this.auto=true;if(this.displayOptions.hasVisibleControl||this.displayOptions.displayOnScroll){this.auto=false;}
this.container=this.build();this.resetStyles();document.body.appendChild(this.container);if(this.displayOptions.hasVisibleControl&&QSI.global.featureFlags.deferredSliderLoadingFeatureEnabled&&this.hasCreativeEmbeddedTarget){this.targetLoaded=false;QSI.util.when(QSI.util.getTimeout(this.displayOptions.delay))
.done(function(){if(!that.removed){that.display();that.poppedUp=true;}});}else{this.initializeIframes();this.targetLoaded=true;QSI.util.when(this.container.loadingDeferred,QSI.util.getTimeout(this.displayOptions.delay))
.done(function(){that.display();that.poppedUp=true;});}}},display:function(){var finished;var that=this;this.resizeHandler=function(){try{that.resize();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};QSI.util.observe(window,'resize',this.resizeHandler);QSI.util.observe(window,'touchend',this.resizeHandler);var scrollY=window.pageYOffset;this.moveBack=false;this.positionHandler=function(){try{if(that.moveBack===true){window.scrollTo(0,scrollY);that.moveBack=false;}else{scrollY=window.pageYOffset;window.scrollTo(0,0);that.moveBack=true;}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};if(QSI.Browser.name==='Safari'&&QSI.Browser.isMobile&&this.displayOptions.hasVisibleControl){QSI.util.observe(this.container,'click',this.positionHandler);}
this.refreshAnimationPositions();if(this.auto){finished=this.slideOut();}else{if(this.displayOptions.hasVisibleControl){this.buildControl();var start=this.getAnimationPositions().start;var startX=start.x;var startY=start.y;start=this.animationPosition.start;finished=QSI.Animation.animateStyle(this.container,{from:{top:startY,left:startX},to:{top:start.y,left:start.x}},200,'easeto');}
if(this.displayOptions.displayOnScroll){QSI.util.observe(window,'scroll',function(){try{if(!that.handlingScroll){that.handlingScroll=true;that.handleScroll();}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});}}
var displayClose=function(){if(that.displayOptions.close&&parseInt(that.displayOptions.close,10)>0){QSI.util.getTimeout(that.displayOptions.close)
.done(function(){that.close(true);});}};if(!finished){displayClose();this.displayed.resolve();}else{finished.done(function(){that.displayed.resolve();});finished.done(displayClose);}},refreshAnimationPositions:function(){this.animationPosition=this.getAnimationPositions();if(this.displayOptions.hasVisibleControl){var start=this.animationPosition.start;var controlSize=parseInt(this.displayOptions.controlSize,10);var ctrlShadow=controlSize+this.shadowPadding;switch(this.animationPosition.curPos){case this.pos.B:start.y-=ctrlShadow;break;case this.pos.T:start.y+=ctrlShadow;break;case this.pos.L:start.x+=ctrlShadow;break;case this.pos.R:start.x-=ctrlShadow;break;case this.pos.TL:start.x+=ctrlShadow;start.y+=ctrlShadow;break;case this.pos.TR:start.x-=ctrlShadow;start.y+=ctrlShadow;break;case this.pos.BL:start.x+=ctrlShadow;start.y-=ctrlShadow;break;case this.pos.BR:start.x-=ctrlShadow;start.y-=ctrlShadow;break;}}},slideOut:function(){var that=this;if(this.state==='in'&&!this.sliding){if(!this.targetLoaded&&this.displayOptions.hasVisibleControl&&QSI.global.featureFlags.deferredSliderLoadingFeatureEnabled){var scrollDiv=this.container.getElementsByClassName('scrollable')[0];if(scrollDiv&&this.hasCreativeEmbeddedTarget){var loadingAnimationSize=75;var scrollDivHt=parseInt(scrollDiv.style.height,10);var scrollDivWt=parseInt(scrollDiv.style.width,10);var loadingDivTop=(scrollDivHt/2)-(loadingAnimationSize/2);var loadingDivLeft=(scrollDivWt/2)-(loadingAnimationSize/2);var sliderAnimationLoader=new QSI.LoadingAnimationElement();var sliderAnimationElement=sliderAnimationLoader.buildAnimation(loadingAnimationSize,loadingDivTop,loadingDivLeft);scrollDiv.appendChild(sliderAnimationElement);sliderAnimationLoader.startAnimation(100);this.initializeIframes();this.targetLoaded=true;QSI.util.when(this.container.loadingDeferred)
.done(function(){sliderAnimationLoader.stopAnimation();});}}
this.sliding=true;var start=this.animationPosition.start;var end=this.animationPosition.end;this.state='out';if(!this.impressed){this.impress();this.impressed=true;}
return QSI.Animation.animateStyle(this.container,{from:{top:start.y,left:start.x},to:{top:end.y,left:end.x}},400,'easeto')
.done(function(){that.sliding=false;});}},slideIn:function(){var that=this;if(this.state==='out'&&!this.sliding){this.sliding=true;var start=this.animationPosition.start;this.state='in';return QSI.Animation.animateStyle(this.container,{top:start.y,left:start.x},400,'easeto')
.done(function(){that.sliding=false;});}},buildControl:function(){var style={},controlSize=this.displayOptions.controlSize,that=this;switch(this.animationPosition.curPos){case this.pos.B:style={width:this.controlWidth+'px',height:controlSize+'px',left:this.controlLeft+'px',top:0+'px'};break;case this.pos.T:style={width:this.controlWidth+'px',height:controlSize+'px',left:this.controlLeft+'px',top:(this.height-controlSize)+'px'};break;case this.pos.L:style={height:this.controlHeight+'px',width:controlSize+'px',left:(this.width-controlSize)+'px',top:this.controlTop+'px'};break;case this.pos.R:style={height:this.controlHeight+'px',width:controlSize+'px',left:0+'px',top:this.controlTop+'px'};break;case this.pos.TL:style={height:controlSize+'px',width:controlSize+'px',left:(this.width-controlSize)+'px',top:(this.height-controlSize)+'px'};break;case this.pos.TR:style={height:controlSize+'px',width:controlSize+'px',left:0,top:(this.height-controlSize)+'px'};break;case this.pos.BL:style={height:controlSize+'px',width:controlSize+'px',left:(this.width-controlSize)+'px',top:0};break;case this.pos.BR:style={height:controlSize+'px',width:controlSize+'px',left:0,top:0};break;}
style.cursor='pointer';style.position='absolute';style.zIndex=2100000000;style.background='white';style.opacity=0;style.filter='alpha(opacity=0)';var controlId='slider-control-'+this.id;this.control=QSI.util.build('div',{id:controlId});QSI.util.observe(this.control,'click',function(){try{that.toggleControl();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});QSI.util.observe(this.control,'keydown',function(e){try{if(e.which===32||e.which===13){that.toggleControl();}}catch(ex){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(ex);}}});this.control.tabIndex=0;QSI.util.setStyle(this.control,style);this.container.insertBefore(this.control,this.container.firstChild);},toggleControl:function(){if(this.state==='in'){this.slideOut();this.userOpened=true;this.userClosed=false;}else if(this.state==='out'){this.slideIn();this.userOpened=false;this.userClosed=true;}},handleScroll:function(){var scrollOffsets=QSI.util.getScrollOffsets(),docHeight=QSI.util.getScroll().height-QSI.util.getPageSize().height,scrollY=scrollOffsets.top,pageScrollLength=this.displayOptions.pageScrollLength,pageScrollUnitOfMeasurement=this.displayOptions.pageScrollUnitOfMeasurement,pageScrollAnchor=this.displayOptions.pageScrollAnchor;if(scrollY>=0&&scrollY<=docHeight&&!(this.userOpened||this.userClosed)){if(pageScrollUnitOfMeasurement==='px'){if(pageScrollAnchor===this.anchor.B){pageScrollLength=docHeight-pageScrollLength;}}else{if(pageScrollAnchor===this.anchor.B){pageScrollLength=100-pageScrollLength;}
pageScrollLength=docHeight*(pageScrollLength/100);}
if(scrollY<pageScrollLength){this.slideIn();}else{this.slideOut();}}
this.handlingScroll=false;},build:function(){var elements=[],maxX=0,maxY=0,totalBorderSize=0,controlTop=20000000,controlBottom=0,controlLeft=20000000,controlRight=0,isElementWithinControlZone=false,isSliderHorizontal=false,isSliderVertical=false,elementLoadingDeferreds=[],el,dsw,dsh,position,i,ilen,elX,elY;this.animationPosition=this.getAnimationPositions();ilen=this.elements.length;for(i=0;i<ilen;i++){el=this.buildElement(this.elements[i]);if(!el||!el.style){continue;}
if(el.style.borderWidth){totalBorderSize=parseInt(el.style.borderWidth,10)*2;}
elX=parseInt(el.style.left,10)+parseInt(el.style.width,10)+totalBorderSize;elY=parseInt(el.style.top,10)+parseInt(el.style.height,10)+totalBorderSize;if(!isNaN(elX)){maxX=Math.max(maxX,elX);}
if(!isNaN(elY)){maxY=Math.max(maxY,elY);}
elements.push(el);elementLoadingDeferreds.push(el.loadingDeferred);}
this.width=maxX;this.height=maxY;ilen=elements.length;for(i=0;i<ilen;i++){el=elements[i];if(!el||!el.style){continue;}
if(el.style.borderWidth){totalBorderSize=parseInt(el.style.borderWidth,10)*2;}
isElementWithinControlZone=false;isSliderHorizontal=false;isSliderVertical=false;switch(this.animationPosition.curPos){case this.pos.B:isSliderVertical=true;isElementWithinControlZone=parseInt(el.style.top,10)<this.displayOptions.controlSize;break;case this.pos.T:isSliderVertical=true;isElementWithinControlZone=parseInt(el.style.top,10)+parseInt(el.style.height,10)+totalBorderSize>this.height-this.displayOptions.controlSize;break;case this.pos.L:isSliderHorizontal=true;isElementWithinControlZone=parseInt(el.style.left,10)+parseInt(el.style.width,10)+totalBorderSize>this.width-this.displayOptions.controlSize;break;case this.pos.R:isSliderHorizontal=true;isElementWithinControlZone=parseInt(el.style.left,10)<this.displayOptions.controlSize;break;}
if(isElementWithinControlZone&&isSliderHorizontal){var elBottom=parseInt(el.style.top,10)+parseInt(el.style.height,10)+totalBorderSize;controlBottom=Math.max(controlBottom,elBottom);controlTop=Math.min(controlTop,parseInt(el.style.top,10));}else if(isElementWithinControlZone&&isSliderVertical){var elRight=parseInt(el.style.left,10)+parseInt(el.style.width,10)+totalBorderSize;controlRight=Math.max(controlRight,elRight);controlLeft=Math.min(controlLeft,parseInt(el.style.left,10));}}
this.controlWidth=controlRight-controlLeft;this.controlHeight=controlBottom-controlTop;this.controlTop=controlTop;this.controlBottom=controlBottom;this.controlLeft=controlLeft;this.controlRight=controlRight;dsw=Math.floor(this.width*1.2);dsh=Math.floor(this.height*1.2);position='fixed';if(!QSI.util.isFixed()){position='absolute';}
el=QSI.util.build('div',{className:'QSISlider '+this.id+'_SliderContainer',style:{position:position,top:-dsh+'px',left:-dsw+'px',zIndex:'2000000000'}},elements);el.loadingDeferred=QSI.util.when.apply(this,elementLoadingDeferreds);this.elementNodes=elements;return el;},getAnimationPositions:function(){var width=this.width,height=this.height,docSize=QSI.util.getPageSize(),scrollOffsets=QSI.util.getScrollOffsets(),docHeight=QSI.util.getBrowserViewHeight(),startPos=this.displayOptions.startPosition,startX=-width,startY=(docHeight-height)/2,endX=-width,endY=(docHeight-height)/2,position=this.pos.L,xOffset=parseInt(this.displayOptions.xOffset,10),yOffset=parseInt(this.displayOptions.yOffset,10),docWidth=docSize.width;if(QSI.Browser.name==='Internet Explorer'&&QSI.Browser.version<9){docWidth=docSize.width;}
switch(startPos){default:case'OML':startX=-width-this.shadowPadding;startY=(docHeight-height)/2;endX=0;endY=startY;position=this.pos.L;break;case'OTLL':startX=-width-this.shadowPadding;startY=0;endX=0;endY=startY;position=this.pos.L;break;case'OTL':startX=-width-this.shadowPadding;startY=-height-this.shadowPadding;endX=0;endY=0;position=this.pos.TL;break;case'OTLT':startX=0;startY=-height-this.shadowPadding;endX=startX;endY=0;position=this.pos.T;break;case'OBLL':startX=-width-this.shadowPadding;startY=docHeight-height;endX=0;endY=startY;position=this.pos.L;break;case'OBLB':startX=0;startY=docHeight+this.shadowPadding;endY=docHeight-height;endX=startX;position=this.pos.B;break;case'OTC':startX=(docWidth-width)/2;startY=-height-this.shadowPadding;endX=startX;endY=0;position=this.pos.T;break;case'OTRR':startX=docWidth+this.shadowPadding;startY=0;endX=docWidth-width;endY=startY;position=this.pos.R;break;case'OTR':startX=docWidth+this.shadowPadding;startY=-height-this.shadowPadding;endX=docWidth-width;endY=0;position=this.pos.TR;break;case'OTRT':startX=docWidth-width;startY=-height-this.shadowPadding;endX=startX;endY=0;position=this.pos.T;break;case'OMR':startX=docWidth+this.shadowPadding;startY=(docHeight-height)/2;endX=docWidth-width;endY=startY;position=this.pos.R;break;case'OBRR':startX=docWidth+this.shadowPadding;startY=docHeight-height;endX=docWidth-width;endY=startY;position=this.pos.R;break;case'OBR':startX=docWidth+this.shadowPadding;startY=docHeight+this.shadowPadding;endX=docWidth-width;endY=docHeight-height;position=this.pos.BR;break;case'OBRB':startX=docWidth-width;startY=docHeight+this.shadowPadding;endY=docHeight-height;endX=startX;position=this.pos.B;break;case'OBC':startX=(docWidth-width)/2;startY=docHeight+this.shadowPadding;endY=docHeight-height;endX=startX;position=this.pos.B;break;case'OBL':startX=-width-this.shadowPadding;startY=docHeight+this.shadowPadding;endX=0;endY=docHeight-height;position=this.pos.BL;break;}
switch(position){case this.pos.B:case this.pos.T:endX=startX+=xOffset;break;case this.pos.R:case this.pos.L:endY=startY+=yOffset;break;case this.pos.TL:case this.pos.TR:case this.pos.BL:case this.pos.BR:endX+=xOffset;endY+=yOffset;}
if(!QSI.util.isFixed()){startX+=scrollOffsets.left;startY+=scrollOffsets.top;}
return{start:{x:startX,y:startY},end:{x:endX,y:endY},curPos:position};},getYPosition:function(position){return(position.top-this.minTop);},getXPosition:function(position){return(position.left-this.minLeft);},reposition:function(){this.refreshAnimationPositions();var start=this.animationPosition.start;var end=this.animationPosition.end;if(this.state==='in'){this.container.style.left=start.x+'px';this.container.style.top=start.y+'px';}else if(this.state==='out'){this.container.style.left=end.x+'px';this.container.style.top=end.y+'px';}},resize:function(){this.resizeElements();var dims=this.getContainerDimensions();this.width=dims.width;this.height=dims.height;dims.width='0px';dims.height='0px';QSI.util.setStyle(this.container,dims);this.reposition();},resizeElements:function(){var that=this;QSI.util.each(this.elements,function(el,index){var style=that.convertPercentStylesToPixels(el.style,el.unitsOfMeasurement),element=that.elementNodes[index];if(element){that.resizeElement(element,el,style);}});},getContainerDimensions:function(){var width=0,height=0,that=this;QSI.util.each(this.elements,function(el){var style=that.convertPercentStylesToPixels(el.style,el.unitsOfMeasurement);var totalBorderSize=0;if(style&&style.borderWidth){totalBorderSize=parseInt(style.borderWidth,10)*2;}
var newWidth=style.width+parseInt(that.getXPosition(el.position),10)+totalBorderSize;var newHeight=style.height+parseInt(that.getYPosition(el.position),10)+totalBorderSize;if(newWidth>width){width=newWidth;}
if(newHeight>height){height=newHeight;}});return{width:width,height:height};},resizeElement:function(element,options,style){var borderWidth=parseInt(style.borderWidth,10),width=style.width,height=style.height;QSI.util.setStyle(element,{width:width+'px',height:height+'px'});if(options.dropShadow){if(isNaN(borderWidth)){borderWidth=0;}
element.removeChild(element.firstChild);var totalBorderSize=borderWidth*2;element.insertBefore(this.buildDropShadow(width+totalBorderSize,height+totalBorderSize,borderWidth),element.children[0]);}},getElementStyle:function(style,position,uom){style=this.convertPercentStylesToPixels(style,uom);return{top:this.getYPosition(position)+'px',left:this.getXPosition(position)+'px',position:'absolute',zIndex:style.zIndex,width:style.width+'px',height:style.height+'px',backgroundColor:style.backgroundColor,borderWidth:style.borderWidth+'px',borderColor:style.borderColor,borderStyle:'solid',borderRadius:style.borderRadius+'px',display:style.display};},closeOnTargetClick:function(){if(this.displayOptions.removeOnTargetClick){this.container.parentNode.removeChild(this.container);}else if(this.displayOptions.hasVisibleControl){this.slideIn();}},remove:function(){this.removed=true;if(this.container){QSI.util.remove(this.container);}},close:function(auto){try{this.cleanupImpressElement();if(this.displayOptions.removeOnClose){if(this.container.parentNode){this.container.parentNode.removeChild(this.container);}}else{this.slideIn();}
if(!auto){this.userOpened=false;this.userClosed=true;}}catch(error){}}});}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},"runEmbededTarget":function(e){try{if(window.QSI.EmbeddedTarget===undefined||window.QTest){QSI.EmbeddedTarget=QSI.util.Class({initialize:function(url,options,parentIntercept){this.parent=parentIntercept;this.options=options||{};this.url=url;this.width=this.options.targetWidth;this.height=this.options.targetHeight;var docSize=QSI.util.getPageSize();var docWidth=docSize.width;var docHeight=docSize.height;if(this.width>docWidth){this.width=docWidth-30;}
if(this.height>docHeight){this.height=docHeight-30;}
this.popup();if(QSI.reg[this.parent.id].embeddedWindows===undefined){QSI.reg[this.parent.id].embeddedWindows=[];}
QSI.reg[this.parent.id].embeddedWindows.push({targetIframe:this.targetIframe,container:this.container});if(this.targetIframe){this.targetIframe.focus();}
var that=this;if(this.options.autoCloseTarget){QSI.util.observe(window,'message',function(e){try{if(QSI.Orchestrator&&QSI.Orchestrator.isMessageEventOriginAllowed&&!QSI.Orchestrator.isMessageEventOriginAllowed(e.origin)){return;}
if(e.data==='closeQSIWindow'){that.close();}}catch(ex){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(ex);}}});}
if(QSI.util.isAndroid()){this.formatForAndroid();}},formatForAndroid:function(){document.body.style.overflow='visible';var iframeContainer=document.querySelector('.QSIEmbeddedTarget');iframeContainer.style.position='absolute';this.scrollElementIntoMidViewport(iframeContainer);var previousHeight=window.innerHeight;var initialWidth=window.innerWidth;var self=this;window.addEventListener('resize',function(){try{var currentHeight=window.innerHeight;if(currentHeight>previousHeight&&currentHeight!==initialWidth){self.scrollElementIntoMidViewport(iframeContainer);}
previousHeight=currentHeight;}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});},scrollElementIntoMidViewport:function(el){var distFromViewportLeft=el.getBoundingClientRect().left;var halfViewportWidth=window.innerWidth/2;var halfElementWidth=el.offsetWidth/2;var horizontalDist=distFromViewportLeft-halfViewportWidth+halfElementWidth;var distFromViewportTop=el.getBoundingClientRect().top;var halfViewportHeight=window.innerHeight/2;var halfElementHeight=el.offsetHeight/2;var verticalDist=distFromViewportTop-halfViewportHeight+halfElementHeight;window.scrollBy(horizontalDist,verticalDist);},clipPageToFitWithinViewport:function(){var initialHTMLElementPositionVal=document.documentElement.style.position;var initialHTMLElementWidthVal=document.documentElement.style.width;document.documentElement.style.position='fixed';document.documentElement.style.width='100%';this.unclipPageFromViewport=function(){document.documentElement.style.position=initialHTMLElementPositionVal;document.documentElement.style.width=initialHTMLElementWidthVal;};},resetStyles:function(){var style=this.options.resetStyle;var styleElement=QSI.util.build('style',{type:'text/css'},style);document.body.appendChild(styleElement);QSI.util.addToStyleElements(styleElement);},close:function(){try{QSI.util.remove(this.container);QSI.util.remove(this.shadowBox);QSI.util.startScrolling();if(QSI.OS.name==='iOS'){this.unclipPageFromViewport();}}catch(e){QSI.dbg.e(e);}},popup:function(){try{this.container=this.build();document.body.appendChild(this.container);this.shadowBox=this.buildShadowBox();QSI.util.stopScrolling();if(QSI.OS.name==='iOS'){this.clipPageToFitWithinViewport();}
document.body.appendChild(this.shadowBox);this.container.style.zIndex=QSI.global.currentZIndex++;var width=this.width;var height=this.height;var scrollOffsets=QSI.util.getScrollOffsets();var docSize=QSI.util.getPageSize();var docWidth=docSize.width;var docHeight=docSize.height;var targetX=(docWidth-width)/2;var targetY=(docHeight-height)/2;if(!QSI.util.isFixed()){targetX+=scrollOffsets.left;targetY+=scrollOffsets.top;}
this.container.style.zoom=1;this.container.style.left=targetX+'px';this.container.style.top=targetY+'px';}catch(e){QSI.dbg.e(e);}},build:function(){var elements=[this.buildContainer()];var position='fixed';if(!QSI.util.isFixed()){position='absolute';}
return QSI.util.build('div',{className:'QSIEmbeddedTarget',style:{position:position}},elements);},buildCloseButtonElement:function(){var img=QSI.util.build('img',{src:QSI.global.imagePath+'/siteintercept/bwc_close.png',style:{cursor:'pointer',position:'absolute',top:'-15px',right:'-15px',height:'29px',width:'29px',zIndex:QSI.global.currentZIndex++},tabindex:'0',alt:'Close'});var that=this;img.onclick=function(){that.onCloseClick();};return img;},buildContainer:function(){var atts={};atts.style={};var top=0;var left=0;var borderSize=3;atts.style={top:top+'px',left:left+'px',position:'absolute',zIndex:QSI.global.currentZIndex++,width:this.width+'px',height:this.height+'px',backgroundColor:'#ffffff',border:borderSize+'px solid #333333',borderRadius:borderSize+'px',mozBorderRadius:borderSize+'px',boxShadow:'0px 0px 10px 0px rgba(0,0,0,0.7)'};var el=QSI.util.build('div',atts);this.closeButton=this.buildCloseButtonElement();el.appendChild(this.closeButton);this.targetIframe=this.buildTargetIframe();this.targetIframe.style.display='none';var waiter=this.buildWaiter();var that=this;var load=function(){try{that.targetIframe.style.display='block';waiter.style.display='none';}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}};QSI.util.observe(this.targetIframe,'load',load);this.targetIframe.src=this.url;el.appendChild(waiter);el.appendChild(QSI.util.build('div',{style:{width:(this.width)+'px',height:(this.height)+'px',overflow:'auto','-webkit-overflow-scrolling':'touch'}},[this.targetIframe]));this.hidden=QSI.util.build('div',{tabindex:'0'});QSI.util.observe(this.hidden,'focus',function(){try{that.closeButton.focus();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});el.appendChild(this.hidden);var dims=QSI.util.getDimensions(el);el.bc={x:left+dims.width,y:top+dims.height};that=this;QSI.util.observe(el,'keydown',function(e){try{if(e.which===32||e.which===13){e.target.click();}else if(e.which===9&&e.shiftKey&&e.target===that.closeButton){e.preventDefault();that.targetIframe.focus();}}catch(ex){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(ex);}}});return el;},buildWaiter:function(){return QSI.util.build('img',{src:QSI.global.imagePath+'/ajax-loading.gif',style:{position:'absolute',top:((this.height/2)-10)+'px',left:((this.width/2)-110)+'px',width:'220px',height:'19px'},alt:''});},onCloseClick:function(){this.close();},buildIFrame:function(width,height){var iframeAttributes={style:{border:'none',position:'absolute',top:0,left:0,filter:"progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"},width:width+'px',height:height+'px',frameBorder:'0',src:QSI.global.imagePath+'/blank.html'};if(!QSI.util.isIE(9)){iframeAttributes.sandbox='allow-scripts allow-same-origin allow-popups';}
var iframe=QSI.util.build('iframe',iframeAttributes);return iframe;},buildTargetIframe:function(){var iframeAttributes={width:'100%',height:'100%',frameBorder:'0',tabindex:'0'};if(!QSI.util.isIE(9)){iframeAttributes.sandbox='allow-scripts allow-same-origin allow-popups';}
var iframe=QSI.util.build('iframe',iframeAttributes);return iframe;},buildShadowBox:function(){var opacity=1;var color='transparent';var dim=QSI.util.getPageSize();var width=dim.width;var height=dim.height;var scrollOffsets=QSI.util.getScrollOffsets();return QSI.util.build('div',{className:'QSIEmbeddedWindowShadowBox',style:{position:'absolute',backgroundColor:color,left:scrollOffsets.left+'px',top:scrollOffsets.top+'px',width:width+'px',height:height+'px',opacity:opacity,zIndex:QSI.global.currentZIndex++,filter:"alpha(opacity="+(opacity*100)+")"}});}});}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},"runNoCreative":function(e){try{if(window.QSI.NoCreative===undefined||window.QTest){QSI.NoCreative=QSI.util.Creative({initialize:function(options){this.globalInitialize(options);if(this.shouldShow()){this.displayed.resolve();}}});}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},"runLink":function(e){try{QSI.Link=QSI.util.Creative({initialize:function(options){this.globalInitialize(options);if(this.options.locators){QSI.PipedText.setLocators(this.options.locators);this.options.text=QSI.PipedText.evaluateLocators(this.options.text);}
if(this.shouldShow()){this.insertLink();}},insertLink:function(){if(this.options.insertionLocation&&this.options.targetURL){var text=this.options.text||this.options.targetURL;this.link=QSI.util.build('a',{className:'QSILink '+this.id+'_Link',href:'javascript:void(0);'},text);new QSI.Target(this.link,this.getTargetHelper(),this.actionOptions,this);QSI.util.$(this.options.insertionLocation).appendChild(this.link);this.impress();this.displayed.resolve();}},remove:function(){if(this.link){QSI.util.remove(this.link);}}});}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},"runInfoBar":function(e){try{if(window.QSI.InfoBar===undefined||window.QTest){QSI.InfoBar=QSI.util.Creative(QSI.BuildElementModule,{initialize:function(options){this.globalInitialize(options);this.shouldAnchor=true;this.removed=false;this.infoBarOptions=this.options.infoBarOptions||{};this.position='top';this.insertIntoBody=this.options.displayOptions.insertIntoBody;this.animate=(this.options.displayOptions.animate===undefined||this.options.displayOptions.animate===true);if(this.shouldShow()){this.display();}},display:function(){if(this.options.elements){this.elements=this.options.elements.Elements||[];QSI.util.processLocators(this.elements,this.displayOptions);this.bar=this.build();if(this.width&&this.height){this.options.size={width:this.width,height:this.height};}}else if(this.infoBarOptions){if(this.options.locators){QSI.PipedText.setLocators(this.options.locators);this.infoBarOptions.content=QSI.PipedText.evaluateLocators(this.infoBarOptions.content,this.displayOptions);}
this.bar=this.buildLegacy();}
var that=this;QSI.util.when(QSI.util.getTimeout(this.displayOptions.delay))
.done(function(){if(!that.removed){that.popup();that.poppedUp=true;}});},popup:function(){try{var that=this;this.resetStyles();var close=this.displayOptions.close*1000;if(close!==0){this.displayed.done(function(){window.setTimeout(function(){try{that.close();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},close);});}
document.body.appendChild(this.bar);var target={x:0,y:0};var height=(QSI.util.getDimensions(this.bar)).height;this.bar.style.zIndex=QSI.global.currentZIndex++;if(!this.options.elements){var cHeight=this.infoBarClose.offsetHeight;QSI.util.$(this.infoBarClose).style.top=(height/2-cHeight/2)+'px';this.position=this.infoBarOptions.position;}else{if(this.animate&&this.insertIntoBody){this.bar.style.height=0;}}
var start=-height;if(!this.insertIntoPage){start=-this.height;}
if(this.position==='bottom'){this.bar.style.bottom=start+'px';this.bar.style.top='auto';}else{this.bar.style.top=start+'px';}
this.bar.style.left=target.x;this.target=target;if(this.insertIntoBody){if(this.position==='top'){this.bar.style.top='auto';var first=document.body.firstChild;document.body.insertBefore(this.bar,first);}else{this.bar.style.bottom='auto';document.body.appendChild(this.bar);}}
this.initializeIframes();var duration;if(this.animate){duration=1500;}else{duration=0;}
this.bar.loadingDeferred.done(function(){that.slide(duration);});}catch(e){QSI.dbg.e(e);}},getYPosition:function(position){if(this.position==='bottom'){return parseInt(position.bottom,10);}
return position.top*1;},buildLegacy:function(){this.infoBarInner=QSI.util.build('div',{className:'InfoBarInner',style:{margin:'10px'}});if(QSI.global.enableJSSanitization&&typeof QSI.DOMPurify!=='undefined'){this.infoBarOptions.content=QSI.DOMPurify.sanitize(this.infoBarOptions.content);}
this.infoBarInner.innerHTML=this.infoBarOptions.content;this.infoBarClose=QSI.util.build('img',{className:'InfoBarClose',src:QSI.global.imagePath+'/siteintercept/square_x.png',style:{right:'12px',position:'absolute',top:'5px',cursor:'pointer'},alt:'Close'});var position='fixed';if(!QSI.util.isFixed()){position='absolute';}
var width='100%';this.infoBarOuter=QSI.util.build('div',{className:'QSIInfoBar InfoBarOuter',style:{backgroundColor:this.infoBarOptions.color,position:position,top:'0px',left:'0px',width:width,cursor:'pointer',zIndex:QSI.global.currentZIndex++}},[this.infoBarInner,this.infoBarClose]);var that=this;this.infoBarOuter.onclick=function(){that.onTargetClick();};this.infoBarClose.onclick=function(e){e=e||window.event;e.cancelBubble=true;if(e.stopPropagation){e.stopPropagation();}
that.onCloseClick();};return this.infoBarOuter;},build:function(){var elements=[];var maxX=0;var maxY=0;var totalBorderWidth=0;var elementLoadingDeferreds=[];this.position=this.getAnchorPosition(this.elements);for(var i=0,ilen=this.elements.length;i<ilen;i++){var el=this.buildElement(this.elements[i]);if(!el){continue;}
if(el.style&&el.style.borderWidth){totalBorderWidth=parseInt(el.style.borderWidth,10)*2;}
if(el.bc&&el.bc.x+totalBorderWidth>maxX){maxX=el.bc.x+totalBorderWidth;}
if(el.bc&&el.bc.y+totalBorderWidth>maxY){maxY=el.bc.y+totalBorderWidth;}
elements.push(el);elementLoadingDeferreds.push(el.loadingDeferred);}
this.width=maxX;this.height=maxY;var position='fixed';if(!QSI.util.isFixed()){position='absolute';}else if(this.insertIntoBody){position='relative';}
var height=this.height;var container=QSI.util.build('div',{className:'QSIInfoBar '+this.id+'_InfoBarContainer',style:{width:'100%',height:height+'px',overflow:'hidden',position:position}},elements);container.loadingDeferred=QSI.util.when.apply(this,elementLoadingDeferreds);return container;},getAnchorPosition:function(elementsList){if(!elementsList){return'top';}
for(var i=0;i<elementsList.length;i++){if(elementsList[i]&&elementsList[i].type==='Span'&&elementsList[i].positionAnchors&&elementsList[i].positionAnchors.positionY){return elementsList[i].positionAnchors.positionY;}}
return'top';},close:function(){try{this.removed=true;QSI.util.remove(this.bar);this.cleanupImpressElement();if(QSI.callbacks[this.id].onClose){QSI.callbacks[this.id].onClose();}}catch(e){}},onCloseClick:function(){this.close();},slide:function(duration){var that=this,properties={},animation;if(this.insertIntoBody){properties.height=this.height;}else{properties[this.position]=0;}
animation=QSI.Animation.animateStyle(this.bar,properties,duration,'inquad');animation.done(function(){that.finish();});},finish:function(){this.impress();this.displayed.resolve();if(!QSI.util.isFixed()){QSI.util.positionFixed(this.bar,0,'auto');}},inquad:function(x){return x*x;}});}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},"runFeedbackLink":function(e){try{if(window.QSI.FeedbackLink===undefined||window.QTest){QSI.FeedbackLink=QSI.util.Creative({initialize:function(options){this.link=null;this.globalInitialize(options);this.options=options;this.id=this.options.id;this.interceptDisplayOptions=options.interceptDisplayOptions||{};this.displayOptions=options.displayOptions||{};if(this.shouldShow()){this.insertLink();}},insertLink:function(){this.img=this.buildImage();this.link=this.buildLink();document.body.appendChild(this.link);this.impress();this.displayed.resolve();},buildLink:function(){var verticalpos=this.displayOptions.verticalPosition,docSize=QSI.util.getPageSize(),docHeight=docSize.height,linkHeight=this.img.height||100,top,bottom;if(verticalpos==='middle'){top=((docHeight/2)-(linkHeight/2))+'px';bottom='auto';}else if(verticalpos==='setfromtop'){top=this.displayOptions.posFromTop+'px';bottom='auto';}else if(verticalpos==='setfrombottom'){bottom=this.displayOptions.posFromBottom+'px';top='auto';}
var link=QSI.util.build('div',{className:'QSIFeedBackLink '+this.id+'_FeedBackLinkContainer',style:{fontSize:'0px',cursor:'pointer',position:'fixed',top:top,bottom:bottom,display:'block',backgroundColor:'transparent',border:'none',zIndex:QSI.global.currentZIndex++},tabindex:'0'},[this.img]);QSI.util.observe(link,'keydown',QSI.util.clickOnKeyDown);new QSI.Target(link,this.getTargetHelper(),this.actionOptions,this);var position=this.displayOptions.position;link.style[position]=0;if(!QSI.util.isFixed()){QSI.util.positionFixed(link,top,bottom);}
return link;},buildImage:function(){var src='';if(this.displayOptions.image==='UserDefined'){src=QSI.global.graphicPath+this.displayOptions.gid;}else{src=QSI.global.imagePath+"/siteintercept/"+this.displayOptions.image+"-"+this.displayOptions.position+".png";}
var img=QSI.util.build('img',{src:src,style:{border:'none',textDecoration:'none',padding:'0px',margin:'0px'},alt:"Feedback Link"});return img;},remove:function(){if(this.link){QSI.util.remove(this.link);}
this.cleanupImpressElement();}});}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},"runClientLog":function(e){try{if(window.QSI.ClientLog===undefined||window.QTest){QSI.ClientLog={send:function(message,includeStackTrace,levelName){try{if(includeStackTrace===undefined){includeStackTrace=true;}
if(levelName===undefined){levelName='error';}
var loggingEndpointUrl=QSI.baseURL+'Ajax.php?action=ClientLog';if(typeof QSI.Orchestrator!=='undefined'&&typeof QSI.Orchestrator.getClientVersionQueryString!=='undefined'){loggingEndpointUrl=loggingEndpointUrl+'&'+QSI.Orchestrator.getClientVersionQueryString();}
var requestIds='';for(var p in QSI.reqID){if(Object.prototype.hasOwnProperty.call(QSI.reqID,p)){requestIds+=p+' ';}}
var userAgent=navigator.userAgent;if(includeStackTrace&&message.stack){message=message.stack;}
var requestParams={'LevelName':levelName,'Message':"requestId: "+requestIds+"\n currentURL: "+QSI.currentURL+"\n userAgent: "+userAgent+"\n message: "+message};QSI.util.sendHttpRequest({type:'POST',url:loggingEndpointUrl,header:{'Content-type':'application/x-www-form-urlencoded'},includeCookies:false,data:QSI.util.buildQueryString(requestParams)});}catch(e){if(QSI.isDebug){console.log(e);}}},sampledSend:function(message,includeStackTrace,levelName,samplingPercentage){if((Math.random()<=samplingPercentage/100)===true){QSI.ClientLog.send(message,includeStackTrace,levelName);}}};}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},"runDebug":function(e){try{if(window.QSI.DebugHandler===undefined||window.QTest){QSI.DebugHandler=QSI.util.Class({initialize:function(options){this.options=options||{};if(!(this.options.debugInfo&&this.options.debugInfo.Intercepts)||this.options.debugInfo.Intercepts.length===0){return;}
this.debug=new QSI.debug(options.debugInfo);this.display();},display:function(){this.bm=this.build();var b=QSI.util.$('QSI_Debug');if(b){QSI.util.remove(b);}
document.body.appendChild(this.bm);QSI.util.showTrialIcon();},close:function(){this.bm.parentNode.removeChild(this.bm);},build:function(){return this.debug.showDebugInfo(this.options);}});}
QSI.debug=QSI.util.Class({initialize:function(debugInfo){this.debugInfo=debugInfo;},buildEl:function(type,options,content){if(options.id){options.id='QSI_'+options.id;}
if(options.className){var classes=options.className.split(' ');var newClassName='';for(var i=0,ilen=classes.length;i<ilen;i++){newClassName+='QSI_'+classes[i];if(i<ilen-1){newClassName+=' ';}}
options.className=newClassName;}
return QSI.util.build(type,options,content);},showDebugInfo:function(){this.expanded=true;this.intercepts=[];var data=this.debugInfo;var that=this;this.addStyles(data.CSS);QSI.util.forOwn(this.debugInfo.Intercepts,function(value,id){if(!that.activeIntercept){that.activeIntercept=id;}
that.debugInfo.Intercepts[id]=new QSI.debug.Intercept(that.debugInfo.Intercepts[id],id,that);that.intercepts.push(that.debugInfo.Intercepts[id]);});this.content=this.buildEl('div',{id:'Debug'},[this.buildHeader(),this.buildContent()]);return this.content;},buildHeader:function(){return this.buildEl('div',{id:'Header'},[this.buildTitle(),this.buildTabs()]);},buildContent:function(){var intercepts=this.buildIntercepts();return this.buildEl('div',{id:'Body'},[intercepts]);},buildIntercepts:function(){return this.buildEl('div',{id:'InterceptContainer'},[this.buildIntercept(this.activeIntercept)]);},buildIntercept:function(id){var intercept=this.debugInfo.Intercepts[id];var contents=intercept.build();return contents;},refreshInterceptContainer:function(){var container=QSI.util.$('QSI_InterceptContainer');container.textContent='';container.appendChild(this.buildIntercept(this.activeIntercept));},buildTitle:function(){return this.buildEl('div',{className:'Title'},['Site Intercept Info - '+this.debugInfo.Type+' Code',this.buildMinimizeButton(),this.buildCloseButton()]);},buildCloseButton:function(){var button=this.buildEl('span',{className:'CloseButton'},'x');var that=this;QSI.util.observe(button,'click',function(){try{that.close();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});return button;},buildMinimizeButton:function(){var button=this.buildEl('span',{className:'MinimizeButton'},'-');var that=this;QSI.util.observe(button,'click',function(){try{that.toggleMinimize();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});return button;},toggleMinimize:function(){var body=QSI.util.$('QSI_Body');var tabs=QSI.util.$('QSI_TabContainer');if(this.expanded){QSI.util.setStyle(body,{display:'none'});QSI.util.setStyle(tabs,{display:'none'});this.expanded=false;}else{QSI.util.setStyle(body,{display:'block'});QSI.util.setStyle(tabs,{display:'block'});this.expanded=true;}},close:function(){QSI.util.remove(this.content);},buildTabs:function(){var tabs=[];var index=0;var that=this;QSI.util.forOwn(this.debugInfo.Intercepts,function(value,id){var intercept=that.debugInfo.Intercepts[id];if(index++<3){tabs.push(that.buildTab(intercept,that.activeIntercept===id));}});if(this.intercepts.length===4){tabs.push(this.buildTab(this.intercepts[3],this.activeIntercept===this.intercepts[3].id));}else if(this.intercepts.length>4){tabs.push(this.buildMenuTab());}
this.addClass(tabs[0],'First');this.addClass(tabs[tabs.length-1],'Last');return this.buildEl('div',{className:'TabContainer',id:'TabContainer'},tabs);},buildTab:function(intercept,active){var tab=this.buildEl('div',{className:'Tab'+((active)?' Active':'')},[this.buildEl('div',{className:'Status'+((intercept.isShown())?' Displayed':'')}),this.buildEl('span',{className:'Name',title:intercept.name},QSI.util.truncateString(intercept.name,13)),this.buildEl('div',{className:'Overlay'})]);if(active){this.activeTab=tab;}
var that=this;QSI.util.observe(tab,'click',function(){try{that.switchTab(intercept.id,tab);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});return tab;},buildMenuTab:function(){var tab=this.buildEl('div',{className:'Tab MenuTab'},[this.buildEl('span',{className:'Name'},'All...'),this.buildEl('div',{className:'Overlay'})]);var that=this;QSI.util.observe(tab,'click',function(){try{that.showMenu(tab);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});return tab;},showMenu:function(){if(this.menu){this.destroyMenu();}else{this.menu=this.buildMenu();QSI.util.$('QSI_Header').appendChild(this.menu);}},buildMenu:function(){var items=[];var that=this;QSI.util.each(this.intercepts,function(intercept){items.push(that.buildMenuItem(intercept));});return this.buildEl('div',{className:'Menu'},[this.buildEl('ul',{},items)]);},buildMenuItem:function(intercept){var item=this.buildEl('li',{className:'MenuItem',title:intercept.name},[this.buildEl('div',{className:'Status'+((intercept.isShown())?' Displayed':'')}),QSI.util.truncateString(intercept.name,30)]);var that=this;QSI.util.observe(item,'click',function(){try{that.destroyMenu();that.selectMenuItem(intercept.id);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});return item;},destroyMenu:function(){if(this.menu){QSI.util.remove(this.menu);this.menu=null;}},selectMenuItem:function(id){this.activeIntercept=id;var oldTab=this.activeTab;var newTab=this.buildTab(this.debugInfo.Intercepts[id],true);newTab.className=oldTab.className;oldTab.parentNode.replaceChild(newTab,oldTab);this.activeTab=newTab;this.refreshInterceptContainer();},switchTab:function(interceptID,el){this.destroyMenu();this.activeIntercept=interceptID;this.addClass(el,'Active');this.removeClass(this.activeTab,'Active');this.activeTab=el;this.refreshInterceptContainer();},addStyles:function(cssString){var style=QSI.util.build('style',{type:'text/css'});if(style.styleSheet){var head=document.getElementsByTagName('head')[0];head.appendChild(style);style.styleSheet.cssText=cssString;}else{document.body.appendChild(style);var resetText=document.createTextNode(cssString);style.appendChild(resetText);}},addClass:function(el,className){var classes=el.className.split(' ');for(var i=0,ilen=classes.length;i<ilen;i++){if(classes[i]==='QSI_'+className){return;}}
el.className=classes.join(' ')+' QSI_'+className;},removeClass:function(el,className){var classes=el.className.split(' ');var index=null;for(var i=0,ilen=classes.length;i<ilen;i++){if(classes[i]==='QSI_'+className){index=i;break;}}
if(index!==null){classes.splice(i,1);}
el.className=classes.join(' ');}});QSI.debug.DataContainer={buildSampleRate:function(){var sampleText='Sample '+this.sampleRate+'%';return this.buildLine({lineText:sampleText,failed:!this.sampled});},buildLogicContainer:function(type){var logicLine=this.buildLine({lineText:type+' Logic',failed:!this.valid});var that=this;QSI.util.observe(logicLine,'click',function(){try{that.toggleLogicContainer();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});this.logicToggle=this.parent.buildEl('div',{className:'Toggle'},'+');QSI.util.observe(this.logicToggle,'click',function(){try{that.toggleLogicContainer();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});return this.parent.buildEl('div',{className:'LogicContainer'},[this.logicToggle,logicLine,this.buildLogicExpressionsContainer()]);},toggleLogicContainer:function(){if(this.logicExpanded){QSI.util.setStyle(this.logicContainer,{display:'none'});this.logicExpanded=false;this.logicToggle.textContent='+';this.logicToggle.setAttribute('class','QSI_Toggle');}else{QSI.util.setStyle(this.logicContainer,{display:'block'});this.logicExpanded=true;this.logicToggle.textContent='-';this.logicToggle.setAttribute('class','QSI_Toggle QSI_Expanded');}},buildLogicExpressionsContainer:function(){var logicExpressions=this.logicExpressions;var expressions=[];if(logicExpressions.length===0){expressions.push(this.buildLine({lineText:'No Logic',failed:false}));}
for(var i=0,ilen=logicExpressions.length;i<ilen;i++){var expression=logicExpressions[i];var line=this.buildLine({lineText:QSI.util.truncateString(expression.Description,40),failed:!expression.Result,title:expression.Description});expressions.push(line);}
var className='LogicExpressionContainer';this.logicContainer=this.parent.buildEl('div',{className:className},expressions);return this.logicContainer;},buildLine:function(options){var passedText='Passed';if(options.failed){passedText='Failed';}
return this.parent.buildEl('div',{className:passedText+' Line'},[this.parent.buildEl('span',{className:'LineText',title:options.title},options.lineText),this.parent.buildEl('span',{className:'PassedText'},passedText)]);}};QSI.debug.Intercept=QSI.util.Class(QSI.debug.DataContainer,{initialize:function(def,id,parent){this.def=def;this.sampleRate=def.SampleRate;this.sampled=def.Sampled;this.state=def.State;this.valid=def.Valid;this.name=def.Name||'Unpublished';this.logicExpressions=def.Expressions;this.active=def.Active;this.actionSets={};this.hasActiveActionSet=false;this.id=id;this.interceptObj=QSI.reg[id];this.willShow=true;this.cookiesEnabled=true;this.localStorageEnabled=true;this.preventRepeatedDisplay=false;this.parent=parent;var that=this;if(this.interceptObj){this.interceptObj.willShow.fail(function(){that.willShow=false;});if(this.interceptObj.interceptDisplayOptions){if(this.interceptObj.interceptDisplayOptions.hideOnCookiesDisabled){this.interceptObj.cookiesEnabled.fail(function(){that.cookiesEnabled=false;});}
if(this.interceptObj.interceptDisplayOptions.hideOnLocalStorageDisabled){this.interceptObj.localStorageEnabled.fail(function(){that.localStorageEnabled=false;});}}
this.interceptObj.preventRepeatedDisplay.done(function(){that.preventRepeatedDisplay=true;});}
var index=0;QSI.util.forOwn(def.ActionSets,function(value,actionSetID){that.actionSets[actionSetID]=new QSI.debug.ActionSet(def.ActionSets[actionSetID],that,++index);if(that.actionSets[actionSetID].isShown()){that.hasActiveActionSet=true;that.activeActionSet=actionSetID;}});},isShown:function(){return this.sampled&&this.valid&&this.hasActiveActionSet&&this.willShow;},build:function(){return this.parent.buildEl('div',{className:'Intercept'},[this.buildDataSection(),this.buildActionSets()]);},buildDataSection:function(){if(this.state==='Published'){var lines=[this.buildSampleRate(),this.buildBrowserSupported(),this.buildPreventRepeatedDisplay(),this.buildInterceptActive(),this.buildLogicContainer('Intercept')];if(this.interceptObj){if(this.interceptObj.interceptDisplayOptions){if(this.interceptObj.interceptDisplayOptions.hideOnCookiesDisabled){lines.push(this.buildCookiesEnabled());}
if(this.interceptObj.interceptDisplayOptions.hideOnLocalStorageDisabled){lines.push(this.buildLocalStorageEnabled());}}}
return this.parent.buildEl('div',{className:'DataSection'},lines);}else{return this.buildLine({lineText:'Intercept Published',failed:true});}},buildBrowserSupported:function(){return this.buildLine({lineText:'Browser Supported',failed:!QSI.Browser.isBrowserSupported});},buildCookiesEnabled:function(){return this.buildLine({lineText:'Cookies Enabled',failed:!this.cookiesEnabled});},buildLocalStorageEnabled:function(){return this.buildLine({lineText:'Local Storage Enabled',failed:!this.localStorageEnabled});},buildPreventRepeatedDisplay:function(){return this.buildLine({lineText:'Prevent Repeated Display',failed:this.preventRepeatedDisplay});},buildInterceptActive:function(){if(QSI.debug.debugInfo.Type==='Editing'){return'';}
return this.buildLine({lineText:'Intercept Active',failed:!this.active});},buildActionSets:function(){if(!this.sampled||!this.valid||!this.willShow){return'';}else{var that=this;var actionSetsContent=[];QSI.util.forOwn(this.actionSets,function(value,id){actionSetsContent.push(that.actionSets[id].build());});return this.parent.buildEl('div',{id:'ActionSetContainer'},actionSetsContent);}},buildEl:function(type,options,content){return this.parent.buildEl(type,options,content);}});QSI.debug.ActionSet=QSI.util.Class(QSI.debug.DataContainer,{initialize:function(def,parent,index){this.def=def;this.evaluated=def.Evaluated;this.logicExpressions=def.Expressions;this.sampleRate=def.SampleRate;this.sampled=def.Sampled;this.valid=def.Valid;this.platformValid=def.PlatformValid;this.displayed=def.Displayed;this.expanded=false;this.label=def.Label;if(def.Creative){this.creativeName=def.Creative.Name;this.creativeState=def.Creative.State;}
this.index=index;this.parent=parent;},isShown:function(){return this.evaluated&&this.sampled&&this.valid&&this.platformValid&&this.isPublishedState();},isPublishedState:function(){return!(this.parent.state==='Published'&&this.creativeState==='Unpublished');},isValid:function(){return this.sampled&&this.valid&&this.isPublishedState()&&this.platformValid;},build:function(){this.content=this.buildCollapsedContent();return this.content;},buildExpandedContent:function(){var output='';output=this.parent.buildEl('div',{className:'DataSection'},[this.buildSampleRate(),this.buildPlatformValid(),this.buildLogicContainer('Action Set')]);var metaData='';if(this.isShown()){metaData=this.buildMetaData();}
return this.parent.buildEl('div',{className:'ActionSet Expanded'},[this.getTitle(),output,metaData]);},buildCollapsedContent:function(){return this.parent.buildEl('div',{className:'ActionSet '+this.getDisplayClass()},[this.getTitle()]);},getLabel:function(){return this.label||'Action Set '+this.index;},getTitle:function(){var evaluated=(this.evaluated&&(this.isPublishedState()||QSI.debug.debugInfo.Type==='Editing'));this.toggleEl=(evaluated)?this.parent.buildEl('div',{className:'Toggle'},'+'):'';var label=this.getLabel();var title=this.parent.buildEl('div',{className:'Title'},[this.toggleEl,label+' - '+this.getDisplayText()]);if(evaluated){var that=this;QSI.util.observe(title,'click',function(){try{that.toggle();}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}});}
return title;},toggle:function(){var content='';if(this.expanded){content=this.buildCollapsedContent();this.toggleEl.textContent='+';this.expanded=false;}else{content=this.buildExpandedContent();this.toggleEl.textContent='-';this.expanded=true;}
this.content.parentNode.replaceChild(content,this.content);this.content=content;},getDisplayText:function(){if(!this.isPublishedState()){return'Creative Unpublished';}
return(this.evaluated)?((this.isValid()&&this.displayed)?'Displayed':'Not Displayed'):'Not Evaluated';},getDisplayClass:function(){return(this.evaluated)?((this.isValid())?'Passed':'Failed'):'Notice';},buildPlatformValid:function(){return this.buildLine({lineText:'Platform / Browser',failed:!this.platformValid});},buildMetaData:function(){return this.parent.buildEl('div',{className:'MetaData'},[this.buildCreativeMetaData()]);},buildCreativeMetaData:function(){var creativeName='',creativeLabel='';if(this.creativeState==='Unpublished'){creativeName=this.buildMetaDataLine('Creative Unpublished',null,'Warning');}else{creativeLabel=(this.creativeName)?'Creative Name':'No Creative';creativeName=this.buildMetaDataLine(creativeLabel,this.creativeName);}
return creativeName;},buildMetaDataLine:function(name,val,className){if(!className){className='';}else{className=' '+className;}
return this.parent.buildEl('div',{className:'MetaDataLine'+className},[this.parent.buildEl('span',{className:'Name'},name),(val)?': ':'',(val)?this.parent.buildEl('span',{className:'Value'},val):'']);}});}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},"runDependencyResolver":function(e){try{if(window.QSI.DependencyResolver===undefined){QSI.DependencyResolver=QSI.util.Creative({initialize:function(options){this.options=options||{};this.resolve();},resolve:function(){QSI.global.latency.legacyDPR={latencyStartTime:undefined,requestURL:undefined,metricID:'1'};var src=this.options.baseURL;var requestData='Q_VSI='+encodeURIComponent(this.options.validIntercepts);if(this.options.dependencyValues){var that=this;QSI.util.forOwn(this.options.dependencyValues,function(value,type){if(type==='SiteCatalyst'){QSI['Resolve'+type].rootName=that.options.adobeSCVariable;}
requestData+=QSI['Resolve'+type].prepare(that.options.dependencyValues[type]);});}
src+='&Q_DPR=true';src+='&t='+(new Date()).getTime();if(typeof QSI.Orchestrator!=='undefined'&&typeof QSI.Orchestrator.getClientVersionQueryString!=='undefined'){src+='&'+QSI.Orchestrator.getClientVersionQueryString();}
if(this.options.debug){src+='&Q_DEBUG';}
QSI.global.latency.legacyDPR.latencyStartTime=Date.now();this.sendResolverPostRequest(src,requestData);},sendResolverPostRequest:function(url,requestData){QSI.util.sendHttpRequest({type:'POST',url:url,includeCookies:true,header:{'Content-type':'application/x-www-form-urlencoded'},data:requestData,successCallback:function(http){if(QSI.global.featureFlags.isLatencyLoggingEnabled){QSI.global.latency.legacyDPR.requestURL=url;var latencyTime=Date.now()-QSI.global.latency.legacyDPR.latencyStartTime;var samplingPercentage=0.02;QSI.LatencyLog.sampledSend(latencyTime,QSI.global.latency.legacyDPR.metricID,QSI.global.latency.legacyDPR.requestURL,samplingPercentage);}
var response;if(http.response){response=http.response;}else{response=http.responseText;}
var script=QSI.util.build('script',{type:'text/javascript'},response);document.body.appendChild(script);},errorCallback:function(http){QSI.dbg.e('DependencyResolver POST request to '+url+
' returned with readyState='+http.readyState+' and status='+http.status);},timeout:10000,timeoutCallback:function(){QSI.dbg.e('DependencyResolver POST request to '+url+'timed out');}});}});}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}},"runWebResponsiveDialog":function(e){try{if(window.QSI.WebResponsiveDialog===undefined){QSI.WebResponsiveDialog={CREATIVE_CONTAINER_CLASS:QSI.BuildResponsiveElementModule.PARENT_CONTAINER_CLASS+'-creative-container',smallViewportBreakpoint:768,Animation:{TYPES:{FADE:"fade",SLIDE_IN:"slide-in"},"fade":{setInitialCreativeStyles:function(creative){creative.style.opacity=0;creative.style.transform="translateY(40px)";},setCreativeAnimationStyles:function(creative){creative.style.opacity=1;creative.style.transition="transform 1s, opacity 0.5s";creative.style.transform="";},addCreativeTransitionEndListener:function(creative,creativeInstance){creative.addEventListener("transitionend",function(event){if(event.propertyName==="transform"){creativeInstance.displayed.resolve();}});}},"slide-in":{TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",setInitialCreativeStyles:function(creative,animationOptions){creative.style.position="fixed";if(QSI.WebResponsiveDialog.isMobileViewport()){creative.style.top="50%";if(animationOptions.Position===this.TOP_LEFT||animationOptions.Position===this.BOTTOM_LEFT){creative.style.transform="translate(-50%, -50%)";creative.style.left="-100%";}else if(animationOptions.Position===this.TOP_RIGHT||animationOptions.Position===this.BOTTOM_RIGHT){creative.style.transform="translate(50%, -50%)";creative.style.right="-100%";}}else{if(animationOptions.Position===this.TOP_LEFT){creative.style.top="24px";creative.style.left="-100%";}else if(animationOptions.Position===this.TOP_RIGHT){creative.style.top="24px";creative.style.right="-100%";}else if(animationOptions.Position===this.BOTTOM_LEFT){creative.style.bottom="24px";creative.style.left="-100%";}else if(animationOptions.Position===this.BOTTOM_RIGHT){creative.style.bottom="24px";creative.style.right="-100%";}}},setCreativeAnimationStyles:function(creative,animationOptions){if(QSI.WebResponsiveDialog.isMobileViewport()){if(animationOptions.Position===this.TOP_LEFT||animationOptions.Position===this.BOTTOM_LEFT){creative.style.left="50%";creative.style.transition="left 1s";}else if(animationOptions.Position===this.TOP_RIGHT||animationOptions.Position===this.BOTTOM_RIGHT){creative.style.right="50%";creative.style.transition="right 1s";}}else{if(animationOptions.Position===this.TOP_LEFT){creative.style.left="24px";creative.style.transition="left 1s";}else if(animationOptions.Position===this.TOP_RIGHT){creative.style.right="24px";creative.style.transition="right 1s";}else if(animationOptions.Position===this.BOTTOM_LEFT){creative.style.left="24px";creative.style.transition="left 1s";}else if(animationOptions.Position===this.BOTTOM_RIGHT){creative.style.right="24px";creative.style.transition="right 1s";}}},addCreativeTransitionEndListener:function(creative,creativeInstance){creative.addEventListener("transitionend",function(){creativeInstance.displayed.resolve();});}}},getStaticClassNames:function(classMap,options){return{MODAL_CONTENT:classMap.DIALOG_CONTENT+' '+
classMap.DIALOG_CONTENT+'-'+options.SizeAndStyle.ContentSpacing+' '+
classMap.BORDER_RADIUS+'-'+options.SizeAndStyle.BorderRadius+' '+
classMap.DROP_SHADOW+'-'+options.SizeAndStyle.DropShadow,LOGO_CONTAINER:classMap.LOGO_CONTAINER+' '+
classMap.LOGO_CONTAINER+'-'+options.SizeAndStyle.ContentSpacing,CLOSE_BUTTON_CONTAINER:classMap.CLOSE_BUTTON_CONTAINER+' '+
classMap.CLOSE_BUTTON_CONTAINER+'-'+options.SizeAndStyle.ContentSpacing,CLOSE_BUTTON:classMap.CLOSE_BUTTON,LOGO:classMap.LOGO,HEADLINE:classMap.HEADLINE+' '+
classMap.HEADLINE+'-'+options.SizeAndStyle.ContentSpacing+' '+
classMap.FONT_WEIGHT+'-'+options.Message.Headline.FontWeight,DESCRIPTION:classMap.DESCRIPTION+' '+
classMap.FONT_WEIGHT+'-'+options.Message.Description.FontWeight,TEXT_CONTAINER:classMap.TEXT_CONTAINER+'-'+options.SizeAndStyle.ContentSpacing,BUTTON_CONTAINER:classMap.BUTTON_CONTAINER};},getButtonClassName:function(classMap,buttonAction,borderRadius,contentSpacing){return classMap.BUTTON+' '+
classMap.BUTTON+'-'+contentSpacing+' '+
classMap.BUTTON_BORDER_RADIUS+'-'+borderRadius;},display:function(creative,animationOptions){var displayDelay=0;if(QSI.global.featureFlags["SI.ResponsiveDialog.EnableDisplayOptions"]&&"DisplayAfter"in animationOptions&&animationOptions.DisplayAfter>0){displayDelay=animationOptions.DisplayAfter*1000;}
setTimeout(this._display.bind(this,creative,animationOptions),displayDelay);},_display:function(creative,animationOptions){this.container=QSI.BuildResponsiveElementModule.buildParentContainer();var creativeContainer=this.buildCreativeContainer(creative,animationOptions);creativeContainer.appendChild(creative);this.Animation[animationOptions.Type].setInitialCreativeStyles(creative,animationOptions);if(animationOptions.Type===this.Animation.TYPES.FADE){this.shadowBox=QSI.BuildResponsiveElementModule.buildShadowBox();this.container.appendChild(this.shadowBox);this.setInitialShadowBoxStyles(this.shadowBox);}
this.container.appendChild(creativeContainer);document.body.appendChild(this.container);this.addAccessibilityFunctionality(creativeContainer,animationOptions);if(animationOptions.Type===this.Animation.TYPES.FADE){this.setShadowBoxAnimationStyles(this.shadowBox,animationOptions);}
this.Animation[animationOptions.Type].addCreativeTransitionEndListener(creative,this);this.Animation[animationOptions.Type].setCreativeAnimationStyles(creative,animationOptions);QSI.global.currentZIndex++;if(animationOptions.ShouldAutoClose&&QSI.global.featureFlags["SI.ResponsiveDialog.EnableDisplayOptions"]){if(animationOptions.CloseAfter>0){var closeAfterDelay=animationOptions.CloseAfter*1000;setTimeout(this.close.bind(this),closeAfterDelay);}else{this.close();}}},buildCreativeContainer:function(creative,animationOptions){var creativeContainerClass=this.CREATIVE_CONTAINER_CLASS+'-'+animationOptions.Type;var creativeContainer=QSI.BuildResponsiveElementModule.buildHTMLElement({elementType:QSI.BuildResponsiveElementModule.HTML_ELEMENT_TYPES.CONTAINER,content:creative,className:creativeContainerClass});return creativeContainer;},setInitialShadowBoxStyles:function(shadowBox){shadowBox.style.opacity=0;},setShadowBoxAnimationStyles:function(shadowBox,animationOptions){if(animationOptions.BackgroundScreen==="none"){shadowBox.style.opacity=0;}else if(animationOptions.BackgroundScreen==="light"){shadowBox.style.opacity=0.1;}else if(animationOptions.BackgroundScreen==="medium"){shadowBox.style.opacity=0.25;}else if(animationOptions.BackgroundScreen==="dark"){shadowBox.style.opacity=0.5;}
shadowBox.style.transition="transform 0.5s, opacity 0.5s";},shouldDisplayCloseButton:function(creativeDefinition){if(creativeDefinition.Buttons.UseCloseButton){return true;}
return false;},shouldDisplayLogo:function(creativeDefinition){if(creativeDefinition.Logos===undefined||creativeDefinition.Logos.Desktop===undefined||creativeDefinition.Logos.Mobile===undefined){return false;}
if(!creativeDefinition.Logos.Desktop.ImageId&&!creativeDefinition.Logos.Mobile.ImageId){return false;}
if(!creativeDefinition.Logos.Mobile.ImageId&&this.isMobileViewport()){return false;}
return true;},isMobileViewport:function(){if(window.innerWidth<=QSI.WebResponsiveDialog.smallViewportBreakpoint){return true;}
return false;},buildModalContentStyle:function(backgroundColor){var modalContentStyle={};modalContentStyle['background-color']=backgroundColor;return modalContentStyle;},buildTextStyle:function(fontSize,fontColor){var textStyle={'font-size':fontSize,'color':fontColor};return textStyle;},buildButtonStyle:function(fontSize){var buttonStyle={'font-size':fontSize};return buttonStyle;},addStandardButtonStyle:function(buttonDefinition,buttonElement){buttonElement.style.color=buttonDefinition.LabelColor;buttonElement.style['background-color']=buttonDefinition.BackgroundColor;buttonElement.style['border-color']=buttonDefinition.BorderColor;},addAccessibilityFunctionality:function(creativeContainer,animationOptions){if(animationOptions.Type===this.Animation.TYPES.FADE){creativeContainer.tabIndex=0;}
var tabbableElements=creativeContainer.querySelectorAll('[tabindex]');if(tabbableElements&&tabbableElements.length>0){this.firstTabbableElement=tabbableElements[0];this.lastTabbableElement=tabbableElements[tabbableElements.length-1];var that=this;var keyfocus=function(e){try{if(animationOptions.Type===that.Animation.TYPES.FADE){if(e.which===9){if(e.target===that.lastTabbableElement&&!e.shiftKey){e.preventDefault();that.firstTabbableElement.focus();}else if(e.target===that.firstTabbableElement&&e.shiftKey){e.preventDefault();that.lastTabbableElement.focus();}else if(e.target===creativeContainer&&!e.shiftKey){e.preventDefault();that.firstTabbableElement.focus();}else if(e.target===creativeContainer&&e.shiftKey){e.preventDefault();that.lastTabbableElement.focus();}}}}catch(ex){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(ex);}}};var keyEsc=function(e){try{if(e.which===27){e.preventDefault();that.close();}}catch(ex){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(ex);}}};QSI.util.observe(creativeContainer,'keydown',keyfocus);QSI.util.observe(document,'keyup',keyEsc);if(this.firstTabbableElement){this.firstTabbableElement.focus();}}},getCreativeContainerStylesheetString:function(){var stylesheetString='\
																																													.'+this.CREATIVE_CONTAINER_CLASS+'-fade {\
																																													  outline: none;\
																																													  position: fixed;\
																																													  z-index: '+QSI.global.currentZIndex+';\
																																													  left: 0;\
																																													  top: 0;\
																																													  width: 100%;\
																																													  height: 100%;\
																																													  padding: 0px;\
																																													  margin: 0px;\
																																													  display: -ms-flexbox;\
																																													  display: flex;\
																																													  -ms-flex-pack: center;\
																																													  justify-content: center;\
																																													  -ms-flex-align: center;\
																																													  align-items: center;\
																																													  -webkit-text-size-adjust: 100%;\
																																													  -moz-text-size-adjust: 100%;\
																																													  -ms-text-size-adjust: 100%\
																																													}\
																																													.'+this.CREATIVE_CONTAINER_CLASS+'-slide-in {\
																																													  outline: none;\
																																													  z-index:'+QSI.global.currentZIndex+';\
																																													  position: relative;\
																																													}\
																																												  ';return stylesheetString;}};}
if(window.QSI.WebResponsive===undefined){QSI.WebResponsive={};}
if(window.QSI.WebResponsive.WebResponsiveDialog===undefined){QSI.WebResponsive.WebResponsiveDialog={};}
if(window.QSI.WebResponsive.WebResponsiveDialog.Layout1===undefined){QSI.WebResponsive.WebResponsiveDialog.Layout1=QSI.util.Creative(QSI.WebResponsiveDialog,{LAYOUT_CLASS_NAME:'QSIWebResponsiveDialog-Layout1',initialize:function(options){this.globalInitialize(options);this.elements=options.elements||{};this.animationOptions=this.elements.Animation||this.getDefaultAnimation();this.LAYOUT_CLASS_NAME=this.LAYOUT_CLASS_NAME+'-'+this.id;this.CLASS_NAME_MAPPING=this.getClassNameMapping();this.ID_MAPPING=this.getIdMapping();this.CLASS_NAMES=this.getStaticClassNames(this.CLASS_NAME_MAPPING,this.elements);if(this.shouldShow()){this.resetStyles();this.preloadLogoAndDisplay();}},preloadLogoAndDisplay:function(){if(!this.shouldDisplayLogo(this.elements)){this.buildAndDisplay();return;}
var logoImage=new Image();if(this.isMobileViewport()||(!this.isMobileViewport()&&this.elements.Logos.Mobile.ImageId&&!this.elements.Logos.Desktop.ImageId)){logoImage.src=QSI.global.graphicPath+this.elements.Logos.Mobile.ImageId;}else{logoImage.src=QSI.global.graphicPath+this.elements.Logos.Desktop.ImageId;}
var that=this;logoImage.onload=function(){that.buildAndDisplay();};logoImage.onerror=function(){that.buildAndDisplay();};},buildAndDisplay:function(){QSI.BuildResponsiveElementModule.appendStylesToDocument(this.getStylesheet());var creative=this.buildCreative();this.display(creative,this.animationOptions);this.impress();},getClassNameMapping:function(){return{CLOSE_BUTTON_CONTAINER:this.LAYOUT_CLASS_NAME+'_close-btn-container',CLOSE_BUTTON:this.LAYOUT_CLASS_NAME+'_close-btn',LOGO_CONTAINER:this.LAYOUT_CLASS_NAME+'_logo-container',TEXT_CONTAINER:this.LAYOUT_CLASS_NAME+'_text-container',DIALOG_CONTENT:this.LAYOUT_CLASS_NAME+'_content',LOGO:this.LAYOUT_CLASS_NAME+'_logo',HEADLINE:this.LAYOUT_CLASS_NAME+'_headline',FONT_WEIGHT:this.LAYOUT_CLASS_NAME+'_font-weight',DESCRIPTION:this.LAYOUT_CLASS_NAME+'_description',BUTTON_CONTAINER:this.LAYOUT_CLASS_NAME+'_button-container',BUTTON:this.LAYOUT_CLASS_NAME+'_button',BUTTON_BORDER_RADIUS:this.LAYOUT_CLASS_NAME+'_button-border-radius',BORDER_RADIUS:this.LAYOUT_CLASS_NAME+'_border-radius',DROP_SHADOW:this.LAYOUT_CLASS_NAME+'_drop-shadow'};},getIdMapping:function(){return{TEXT_CONTAINER:this.LAYOUT_CLASS_NAME+'-text-container'};},getDefaultAnimation:function(){return{"Type":"fade","BackgroundScreen":"light"};},buildCreative:function(){var contentElements=[];if(this.shouldDisplayCloseButton(this.elements)){contentElements.push(this.buildCloseButton());}
if(this.shouldDisplayLogo(this.elements)){contentElements.push(this.buildLogo());}
contentElements.push(this.buildText());contentElements.push(this.buildButtons());var modalContent=QSI.BuildResponsiveElementModule.buildHTMLElement({elementType:QSI.BuildResponsiveElementModule.HTML_ELEMENT_TYPES.CONTAINER,content:contentElements,className:this.CLASS_NAMES.MODAL_CONTENT,elementStyle:this.buildModalContentStyle(this.elements.SizeAndStyle.InterceptColor)});this.addAccessibilityAttributes(modalContent);return modalContent;},buildCloseButton:function(){var closeButtonUrl=QSI.global.baseURL;if(this.elements.Buttons.CloseButtonColor==="#FFFFFF"){closeButtonUrl+="/WRSiteInterceptEngine/../WRQualtricsShared/Graphics"+
"/siteintercept/wr-dialog-close-btn-white.png";}else{closeButtonUrl+="/WRSiteInterceptEngine/../WRQualtricsShared/Graphics/"+
"siteintercept/wr-dialog-close-btn-black.png";}
var closeButtonImageElement=QSI.BuildResponsiveElementModule.buildHTMLElement({elementType:QSI.BuildResponsiveElementModule.HTML_ELEMENT_TYPES.IMAGE,src:closeButtonUrl,altText:"Close Button",elementStyle:{height:"17px",width:"17px"}});var closeButtonElement=QSI.BuildResponsiveElementModule.buildHTMLElement({elementType:QSI.BuildResponsiveElementModule.HTML_ELEMENT_TYPES.BUTTON,content:closeButtonImageElement,elementStyle:{},className:this.CLASS_NAMES.CLOSE_BUTTON,tabbable:true});QSI.BuildResponsiveElementModule.addButtonFunctionality(QSI.BuildResponsiveElementModule.ACTION_TYPES.DISMISS,closeButtonElement,this);var closeButtonContainer=QSI.BuildResponsiveElementModule.buildHTMLElement({elementType:QSI.BuildResponsiveElementModule.HTML_ELEMENT_TYPES.CONTAINER,content:closeButtonElement,className:this.CLASS_NAMES.CLOSE_BUTTON_CONTAINER});return closeButtonContainer;},buildLogo:function(){var logoGraphicId="";if(!this.isMobileViewport()&&this.elements.Logos.Desktop.ImageId){logoGraphicId=this.elements.Logos.Desktop.ImageId;}else{logoGraphicId=this.elements.Logos.Mobile.ImageId;}
var logoGraphicUrl=QSI.global.graphicPath+logoGraphicId;var logoAltText=this.elements.Logos.AltText;var logoElement=QSI.BuildResponsiveElementModule.buildHTMLElement({elementType:QSI.BuildResponsiveElementModule.HTML_ELEMENT_TYPES.IMAGE,className:this.CLASS_NAMES.LOGO,src:logoGraphicUrl,altText:logoAltText});var logoContainer=QSI.BuildResponsiveElementModule.buildHTMLElement({elementType:QSI.BuildResponsiveElementModule.HTML_ELEMENT_TYPES.CONTAINER,content:logoElement,className:this.CLASS_NAMES.LOGO_CONTAINER});return logoContainer;},buildText:function(){var textElements=[];var textColor=this.elements.Message.Color;var headlineOptions=this.elements.Message.Headline;var headlineElement=QSI.BuildResponsiveElementModule.buildHTMLElement({elementType:QSI.BuildResponsiveElementModule.HTML_ELEMENT_TYPES.HEADLINE,content:headlineOptions.Text,className:this.CLASS_NAMES.HEADLINE,elementStyle:this.buildTextStyle(headlineOptions.FontSize,textColor)});var descripOptions=this.elements.Message.Description;var descripElement=QSI.BuildResponsiveElementModule.buildHTMLElement({elementType:QSI.BuildResponsiveElementModule.HTML_ELEMENT_TYPES.TEXT,content:descripOptions.Text,className:this.CLASS_NAMES.DESCRIPTION,elementStyle:this.buildTextStyle(descripOptions.FontSize,textColor)});textElements.push(headlineElement);textElements.push(descripElement);var textContainer=QSI.BuildResponsiveElementModule.buildHTMLElement({elementType:QSI.BuildResponsiveElementModule.HTML_ELEMENT_TYPES.CONTAINER,content:textElements,className:this.CLASS_NAMES.TEXT_CONTAINER,id:this.ID_MAPPING.TEXT_CONTAINER});return textContainer;},buildButtons:function(){var buttonOptions=this.elements.Buttons;var sizeAndStyle=this.elements.SizeAndStyle;var buttonElements=[];var buttonOneDef=buttonOptions.ButtonOne;if(buttonOneDef){var buttonOne=this.buildButton(buttonOneDef,sizeAndStyle);buttonElements.push(buttonOne);}
if(buttonOptions.Number===2&&buttonOptions.ButtonTwo){var buttonTwoDef=buttonOptions.ButtonTwo;var buttonTwo=this.buildButton(buttonTwoDef,sizeAndStyle);buttonElements.push(buttonTwo);}
var buttonContainer=QSI.BuildResponsiveElementModule.buildHTMLElement({elementType:QSI.BuildResponsiveElementModule.HTML_ELEMENT_TYPES.CONTAINER,content:buttonElements,className:this.CLASS_NAMES.BUTTON_CONTAINER});return buttonContainer;},buildButton:function(buttonDefinition,sizeAndStyle){var button=QSI.BuildResponsiveElementModule.buildHTMLElement({elementType:QSI.BuildResponsiveElementModule.HTML_ELEMENT_TYPES.BUTTON,content:buttonDefinition.Text,elementStyle:this.buildButtonStyle(this.elements.Buttons.FontSize),className:this.getButtonClassName(this.CLASS_NAME_MAPPING,buttonDefinition.Action,this.elements.Buttons.BorderRadius,sizeAndStyle.ContentSpacing),tabbable:true});this.addStandardButtonStyle(buttonDefinition,button);QSI.BuildResponsiveElementModule.addButtonFunctionality(buttonDefinition.Action,button,this);return button;},close:function(){try{this.cleanupImpressElement();if(this.container&&this.container.parentNode){this.container.style.opacity="0";this.container.style.transition="opacity 0.5s";var that=this;this.container.addEventListener("transitionend",function(){that.container.parentNode.removeChild(that.container);});}}catch(error){}},addAccessibilityAttributes:function(element){element.setAttribute('role',"dialog");element.setAttribute('aria-modal',true);element.setAttribute('aria-labelledby',this.ID_MAPPING.TEXT_CONTAINER);},getStylesheet:function(){function createDescendantSelectorFromClassName(className){var parentContainerClass=QSI.BuildResponsiveElementModule.PARENT_CONTAINER_CLASS;return'.'+parentContainerClass+' .'+className;}
var STYLESHEET='\
																													  @media only screen and (max-width: 520px) {\
																														  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DIALOG_CONTENT)+'-compact {\
																															  width: 70%;\
																														  }\
																														  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DIALOG_CONTENT)+'-medium {\
																															  width: 80%;\
																														  }\
																														  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DIALOG_CONTENT)+'-spacious {\
																															  width: 90%;\
																														  }\
																													  }\
																													  @media only screen and (min-width: 521px) and (max-width: 768px) {\
																														  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DIALOG_CONTENT)+'-compact {\
																															  width: 40%;\
																														  }\
																														  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DIALOG_CONTENT)+'-medium {\
																															  width: 50%;\
																														  }\
																														  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DIALOG_CONTENT)+'-spacious {\
																															  width: 60%;\
																														  }\
																													  }\
																													  @media only screen and (min-width: 769px) and (max-width: 992px) {\
																														  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DIALOG_CONTENT)+'-compact {\
																															  width: 30%;\
																														  }\
																														  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DIALOG_CONTENT)+'-medium {\
																															  width: 35%;\
																														  }\
																														  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DIALOG_CONTENT)+'-spacious {\
																															  width: 40%;\
																														  }\
																													  }\
																													  @media only screen and (min-width: 993px) {\
																														  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DIALOG_CONTENT)+'-compact {\
																															  width: 25%;\
																															  max-width: 480px;\
																														  }\
																														  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DIALOG_CONTENT)+'-medium {\
																															  width: 28%;\
																															  max-width: 480px;\
																														  }\
																														  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DIALOG_CONTENT)+'-spacious {\
																															  width: 30%;\
																															  max-width: 480px;\
																														  }\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DIALOG_CONTENT)+'{\
																														  box-sizing: border-box; \
																														  background-color: #fefefe;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DIALOG_CONTENT)+'-compact'+'{\
																														  padding-top: 8px;\
																														  padding-bottom: 16px;\
																														  padding-left: 16px;\
																														  padding-right: 16px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DIALOG_CONTENT)+'-medium'+'{\
																														  padding-top: 12px;\
																														  padding-bottom: 20px;\
																														  padding-left: 20px;\
																														  padding-right: 20px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DIALOG_CONTENT)+'-spacious'+'{\
																														  padding-top: 16px;\
																														  padding-bottom: 24px;\
																														  padding-left: 24px;\
																														  padding-right: 24px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DROP_SHADOW)+'-none {\
																														  box-shadow: none;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DROP_SHADOW)+'-light {\
																														  box-shadow: 0 2px 4px 0 rgba(0,0,0,0.2);\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DROP_SHADOW)+'-medium {\
																														  box-shadow: 0 2px 8px 0 rgba(0,0,0,0.3);\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DROP_SHADOW)+'-heavy {\
																														  box-shadow: 0 2px 16px 0 rgba(0,0,0,0.4);\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.TEXT_CONTAINER)+'-compact'+'{\
																														  margin-bottom: 16px;\
																														  word-wrap: break-word;\
																														  overflow-wrap: break-word;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.TEXT_CONTAINER)+'-medium'+'{\
																														  margin-bottom: 20px;\
																														  word-wrap: break-word;\
																														  overflow-wrap: break-word;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.TEXT_CONTAINER)+'-spacious'+'{\
																														  margin-bottom: 24px;\
																														  word-wrap: break-word;\
																														  overflow-wrap: break-word;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.CLOSE_BUTTON)+'{\
																														  background-color: transparent;\
																														  border: 0;\
																														  padding: 0;\
																														  height: 17px;\
																														  width: 17px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.CLOSE_BUTTON_CONTAINER)+'{\
																														  width: 100%;\
																														  display: -ms-flexbox;\
																														  display: flex;\
																														  flex-direction: row-reverse;\
																														  -ms-flex-direction: row-reverse;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.CLOSE_BUTTON_CONTAINER)+'-compact'+'{\
																														  margin-top: 4px;\
																														  margin-bottom: 4px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.CLOSE_BUTTON_CONTAINER)+'-medium'+'{\
																														  margin-top: 6px;\
																														  margin-bottom: 6px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.CLOSE_BUTTON_CONTAINER)+'-spacious'+'{\
																														  margin-top: 8px;\
																														  margin-bottom: 8px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.LOGO_CONTAINER)+'{\
																														  width: 100%;\
																														  display: -ms-flexbox;\
																														  display: flex;\
																														  -ms-flex-pack: center;\
																														  justify-content: center;\
																														  -ms-flex-align: center;\
																														  align-items: center;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.LOGO_CONTAINER)+'-compact'+'{\
																														  margin-bottom: 8px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.LOGO_CONTAINER)+'-medium'+'{\
																														  margin-bottom: 12px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.LOGO_CONTAINER)+'-spacious'+'{\
																														  margin-bottom: 16px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.LOGO)+'{\
																														  max-height: 48px;\
																														  max-width: 192px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.HEADLINE)+'{\
																														  text-align: center;\
																														  white-space: pre-wrap;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.HEADLINE)+'-compact'+'{\
																														  margin-bottom: 8px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.HEADLINE)+'-medium'+'{\
																														  margin-bottom: 12px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.HEADLINE)+'-spacious'+'{\
																														  margin-bottom: 16px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.FONT_WEIGHT)+'-light {\
																														  font-weight: 300;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.FONT_WEIGHT)+'-regular {\
																														  font-weight: 400;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.FONT_WEIGHT)+'-semibold {\
																														  font-weight: 600;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.FONT_WEIGHT)+'-bold {\
																														  font-weight: 700;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.DESCRIPTION)+'{\
																														  text-align: center;\
																														  white-space: pre-wrap;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.BUTTON_CONTAINER)+'{\
																														  text-align: center;\
																														  display: block;\
																														  word-wrap: break-word;\
																														  overflow-wrap: break-word;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.BUTTON)+'{\
																														  box-sizing: border-box;\
																														  font-weight: 600;\
																														  padding: 10px 25px;\
																														  cursor: pointer;\
																														  width: 100%;\
																														  border-width: 2px;\
																														  max-width: 240px;\
																														  border-style: solid;\
																													  }\
																													  .'+this.CLASS_NAME_MAPPING.BUTTON+'-compact'+
' + .'+this.CLASS_NAME_MAPPING.BUTTON+'-compact'+'{\
																														  margin-top: 8px;\
																													  }\
																													  .'+this.CLASS_NAME_MAPPING.BUTTON+'-medium'+
' + .'+this.CLASS_NAME_MAPPING.BUTTON+'-medium'+'{\
																														  margin-top: 12px;\
																													  }\
																													  .'+this.CLASS_NAME_MAPPING.BUTTON+'-spacious'+
' + .'+this.CLASS_NAME_MAPPING.BUTTON+'-spacious'+'{\
																														  margin-top: 16px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.BORDER_RADIUS)+'-none {\
																														  border-radius: 0px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.BORDER_RADIUS)+'-slightly-rounded {\
																														  border-radius: 4px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.BORDER_RADIUS)+'-moderately-rounded {\
																														  border-radius: 10px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.BORDER_RADIUS)+'-very-rounded {\
																														  border-radius: 16px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.BUTTON_BORDER_RADIUS)+'-none {\
																														  border-radius: 0px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.BUTTON_BORDER_RADIUS)+'-slightly-rounded {\
																														  border-radius: 4px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.BUTTON_BORDER_RADIUS)+'-moderately-rounded {\
																														  border-radius: 12px;\
																													  }\
																													  '+createDescendantSelectorFromClassName(this.CLASS_NAME_MAPPING.BUTTON_BORDER_RADIUS)+'-completely-rounded {\
																														  border-radius: 20px;\
																													  }\
																													';STYLESHEET+=this.getCreativeContainerStylesheetString();return STYLESHEET;}});}}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}}}};utag.DB("send:1836:COMPLETE");}};utag.o[loader].loader.LOAD(id);}
("1836","hsbc.uk-rbwm"));}catch(error){utag.DB(error);}
